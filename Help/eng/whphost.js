var gaProj=new Array();var gnChecked=0;var gsProjName="";var gbReady=false;var goMan=null;var gbXML=false;var gsFirstPane="";var gServerEnabled=false;var gsPath="";var gbWhPHost=false;var goDiv=null;var gsHTML="";if(navigator.currentNavPen){gsFirstPane=navigator.currentNavPen}function delayLoad(){if(goDiv&&gsHTML){goDiv.innerHTML=gsHTML;goDiv=null;gsHTML=""}}function whCom(a,b){this.msName=a;this.msDivId=a+"Div";this.msIFrameId=a+"IFrame";this.msComFile=b;this.mbloaded=false;this.mbShow=false;this.show=function(d){if(this.mbShow!=d){if(d&&!this.mbloaded){this.load()}var c=getElement(this.msDivId);if(c){if(gbIE55||(gbIE5&&gbMac)){var e=getElement(this.msIFrameId);if(e){if(d){c.style.zIndex=3;if(e!=null){e.style.zIndex=3;if(!gbIE55){e.style.visibility="visible"}}}else{c.style.zIndex=2;if(e!=null){e.style.zIndex=2;if(!gbIE55){e.style.visibility="hidden"}}}}}if(!gbIE55){c.style.visibility=(d==true)?"visible":"hidden"}this.mbShow=d}}};this.load=function(){if(!this.mbloaded){if(this.msComFile.length>0){var g=_getFullPath(getPath(),this.msComFile);var e=getElement(this.msDivId);if(e){if(gbIE4||gbOpera7){var d=e.style.pixelHeight;var c=e.style.pixelWidth;var f="<IFRAME ID="+this.msIFrameId+' title="'+this.msName+'" SRC="'+g+'" BORDER=0 FRAMEBORDER=no STYLE="width:';if(gbMac){f+=c+"px;height:"+d+'px;"></IFRAME>'}else{f+='100%; height:100%;"></IFRAME>'}e.innerHTML=f}else{if(gbNav6||gbSafari){gsHTML="<IFRAME ID="+this.msIFrameId+' title="'+this.msName+'" SRC="'+g+'" BORDER=0 FRAMEBORDER=no STYLE="width:100%;border:0;height:100%;"></IFRAME>';goDiv=e;setTimeout("delayLoad()",100)}}this.mbloaded=true}}}};this.unload=function(){var c=getElement(this.msDivId);if(c){c.innerHTML=""}};this.getDivHTML=function(){var c="";if(gbMac&&gbIE4){c+="<DIV ID="+this.msDivId+' ALIGN=left STYLE="position:absolute;z-index:1;left:0;top:0;width:100%;height:100%;margin:0;padding:0;border:0;">'}else{if(gbIE5){c+="<DIV ID="+this.msDivId+' ALIGN=left STYLE="position:absolute;z-index:1;left:0;top:0;width:100%;height:100%;">'}else{if(gbIE4||gbWindows){c+="<DIV ID="+this.msDivId+' ALIGN=left STYLE="position:absolute;z-index:1;left:0;top:0;width:100%;height:100%;visibility:hidden">'}else{if(gbMac&&gbNav6){c+="<DIV ID="+this.msDivId+' ALIGN=left STYLE="position:absolute;z-index:1;left:0;top:0;width:100%;height:100%;visibility:hidden">'}else{if(gbUnixOS){c+="<DIV ID="+this.msDivId+' ALIGN=left STYLE="position:absolute;z-index:1;left:0;top:0;width:100%;height:100%;visibility:hidden">'}else{c+="<DIV ID="+this.msDivId+' ALIGN=left STYLE="position:absolute;z-index:1;left:0;top:0;width:100%;height:'+parent.height+';visibility:hidden">'}}}}}c+="</DIV>";return c}}function whComMan(){this.sName="";this.maCom=new Array();this.addCom=function(b,c){var a=new whCom(b,c);this.maCom[this.maCom.length]=a};this.init=function(){var d="";for(var c=0;c<this.maCom.length;c++){d+=this.maCom[c].getDivHTML()}if(gbSafari&&!gbSafari3){var a=document.createRange();a.setStartBefore(document.body.lastChild);var b=a.createContextualFragment(d);document.body.appendChild(b)}else{document.body.insertAdjacentHTML("beforeEnd",d)}};this.showById=function(a){for(var b=0;b<this.maCom.length;b++){if(b!==a){this.maCom[b].show(false)}}this.maCom[a].show(true)};this.show=function(c){navigator.currentNavPen=c;var b=false;for(var a=0;a<this.maCom.length;a++){if(c==this.maCom[a].msName){b=true;break}}if(b){this.showById(a);this.sName=c}};this.unload=function(){for(var a=0;a<this.maCom.length;a++){this.maCom[a].unload()}};this.getCurrent=function(){return this.sName}}function getPath(){if(gsPath==""){gsPath=location.href;gsPath=_replaceSlash(gsPath);var a=gsPath.lastIndexOf("/");gsPath=gsPath.substring(0,a+1)}return gsPath}goMan=new whComMan();function addPane(c,d){var b=new Object();b.sName=c;var a=new whMessage(WH_MSG_GETPANE,this,1,b);if(SendMessage(a)){if(a.oParam.bEnable){goMan.addCom(c,d)}}else{goMan.addCom(c,d)}}function setShowPane(c,b){if((gsFirstPane=="")||b){var a=new whMessage(WH_MSG_GETDEFPANE,this,1,null);if(SendMessage(a)){if(a.oParam){gsFirstPane=a.oParam}else{gsFirstPane=c}}else{gsFirstPane=c}}}function window_OnLoad(){var b=new whMessage(WH_MSG_GETCMD,this,1,null);var a=false;if(SendMessage(b)){if(b.oParam>0){if(b.oParam==1){gsFirstPane="toc"}else{if(b.oParam==2){gsFirstPane="idx"}else{if(b.oParam==3){gsFirstPane="fts"}else{if(b.oParam==4){gsFirstPane="glo"}}}}}else{if(b.oParam==0){a=true}}}goMan.init();if(gsProjName!=""){loadData2(gsProjName)}if(a){gsFirstPane="";var c=new whMessage(WH_MSG_HIDEPANE,this,1,null);SendMessage(c)}else{if(gsFirstPane!=""){goMan.show(gsFirstPane)}else{goMan.showById(0)}}}function setServerEnabled(){gServerEnabled=true}function loadData2(a){if(gbXML){loadDataXML(a)}else{loadData(a)}}function addProject(b,a,c){var d=b;if(!gbIE4&&!gbNav6&&!gbOpera7&&!gbSafari3){return}if(gbIE4&&!gbIE5){d=false}if(gbIE5&&!gbMac){d=true}if(gbIE55||gbNav6||gbSafari3){d=true}if(gbOpera7){d=false}if(d){addProjectXML(a)}else{addProjectHTML(c)}}function addProjectHTML(a){gbXML=false;gsProjName=a}function mrAlterProjUrl(b){if(mrIsOnEngine()==true){var a=mrGetProjName();if(a!=""){b=mrGetEngineUrl()+"?mgr=sys&cmd=prjinf&prj="+a}}return b}function addProjectXML(a){mrInitialize();gbXML=true;gsProjName=mrAlterProjUrl(a)}function window_MyBunload(){goMan.unload();window_BUnload()}function putDataXML(k,f){if(k!=null){var b=k.getElementsByTagName("project")[0];if(b){var d=new Array();d[0]=new Object();d[0].sPPath=_getPath(f);if(mrIsOnEngine()==true){d[0].sPPath=""}var c=b.getAttribute("langid");if(c){d[0].sLangId=c}var j=b.getAttribute("datapath");if(j){if(j.lastIndexOf("/")!=j.length-1){j+="/"}d[0].sDPath=j}else{d[0].sDPath=""}d[0].sToc=b.getAttribute("toc");d[0].sIdx=b.getAttribute("index");d[0].sFts=b.getAttribute("fts");d[0].sGlo=b.getAttribute("glossary");var g=b.getElementsByTagName("remote");var a=1;for(var e=0;e<g.length;e++){var h=g[e].getAttribute("url");if(h){if(h.lastIndexOf("/")!=h.length-1){h+="/"}d[a]=new Object();d[a++].sPPath=_getFullPath(d[0].sPPath,h)}}putProjectInfo(d)}else{if(gnChecked==0){setTimeout("redirectToList();",100)}else{gnChecked++;setTimeout("checkRemoteProject();",1)}}}}function onLoadXMLError(){gnChecked++;setTimeout("checkRemoteProject();",1)}function redirectToList(){if(gbReDirectThis){document.location=gsNavReDirect}else{parent.document.location=gsNavReDirect}}function putProjectInfo(b){if(gnChecked==0||isSamePath(gaProj[gnChecked].sPPath,b[0].sPPath)){if(gnChecked!=0){if(b[0].sLangId!=gaProj[0].sLangId){alert("Hệ thống Trợ giúp hợp nhất "+b[0].sPPath+" đang sử dụng một ngôn ngữ khác với hệ thống Trợ giúp chính, là nguyên nhân làm vô hiệu hóa chức năng tìm kiếm chỉ mục và văn bản đầy đủ trong hệ thống Trợ giúp hợp nhất.")}}gaProj[gnChecked]=b[0];for(var c=1;c<b.length;c++){var d=false;for(var a=0;a<gaProj.length;a++){if(isSamePath(gaProj[a].sPPath,b[c].sPPath)){d=true;break}}if(!d){gaProj[gaProj.length]=b[c]}}gnChecked++;setTimeout("checkRemoteProject();",1)}else{alert("Không thể nạp một cách thích hợp, vui lòng nhấp vào Nạp lại.")}}function isSamePath(b,a){return(b.toLowerCase()==a.toLowerCase())}function checkRemoteProject(){if(gaProj.length>gnChecked){setTimeout("cancelProj("+gnChecked+");",10000);loadData2(gaProj[gnChecked].sPPath+gsProjName)}else{var a=new whMessage(WH_MSG_PROJECTREADY,this,1,null);gbReady=true;SendMessage(a)}}function cancelProj(a){if(a==gnChecked){gnChecked++;setTimeout("checkRemoteProject();",1)}}function window_resize(){for(var a=0;a<goMan.maCom.length;a++){var b=getElement(goMan.maCom[a].msIFrameId);if(b){b.style.height=document.body.clientHeight;b.style.width=document.body.clientWidth}}window_resize2()}function window_resize2(){if(document.body){if(document.body.clientWidth>1&&document.body.clientHeight>1){var a=new whMessage(WH_MSG_RESIZEPANE,this,1,null);SendMessage(a)}}}function window_unload(){UnRegisterListener2(this,WH_MSG_GETPROJINFO);UnRegisterListener2(this,WH_MSG_SHOWTOC);UnRegisterListener2(this,WH_MSG_SHOWIDX);UnRegisterListener2(this,WH_MSG_SHOWFTS);UnRegisterListener2(this,WH_MSG_SHOWGLO);UnRegisterListener2(this,WH_MSG_GETPANEINFO);UnRegisterListener2(this,WH_MSG_GETSEARCHSTR);UnRegisterListener2(this,WH_MSG_HILITESEARCH);UnRegisterListener2(this,WH_MSG_GETNUMRSLT)}function onSendMessage(b){if(b){var c=b.nMessageId;if(c==WH_MSG_GETPROJINFO){if(gbReady){var f=new Object();f.aProj=gaProj;f.bXML=gbXML;b.oParam=f}else{return false}}else{if(c==WH_MSG_SHOWTOC){if(goMan){goMan.show("toc")}var a=new whMessage(WH_MSG_PANEINFO,this,1,"toc");SendMessage(a);a=new whMessage(WH_MSG_SHOWPANE,this,1,null);SendMessage(a)}else{if(c==WH_MSG_SHOWIDX){if(goMan){goMan.show("idx")}var a=new whMessage(WH_MSG_PANEINFO,this,1,"idx");SendMessage(a);a=new whMessage(WH_MSG_SHOWPANE,this,1,null);SendMessage(a)}else{if(c==WH_MSG_SHOWFTS){if(goMan){goMan.show("fts")}var a=new whMessage(WH_MSG_PANEINFO,this,1,"fts");SendMessage(a);a=new whMessage(WH_MSG_SHOWPANE,this,1,null);SendMessage(a)}else{if(c==WH_MSG_SHOWGLO){if(goMan){goMan.show("glo")}var a=new whMessage(WH_MSG_PANEINFO,this,1,"glo");SendMessage(a);a=new whMessage(WH_MSG_SHOWPANE,this,1,null);SendMessage(a)}else{if(c==WH_MSG_GETPANEINFO){b.oParam=goMan.getCurrent();return false}else{if(c==WH_MSG_HILITESEARCH){b.oParam=true;return true}else{if(c==WH_MSG_GETSEARCHSTR){var g=getElement("ftsIFrame");if(g){if(typeof(g.contentWindow.document.forms[0])!="undefined"){var d=g.contentWindow.document.forms[0].quesn.value;b.oParam=d}}return true}else{if(c==WH_MSG_GETNUMRSLT){var g=getElement("ftsIFrame");if(g){var e=g.contentWindow.document.getElementById("FtsRslt");if(e){b.oParam=e.rows.length}else{b.oParam=0}}else{b.oParam=0}return true}}}}}}}}}}return true}if(window.gbWhUtil&&window.gbWhMsg&&window.gbWhVer&&window.gbWhProxy){RegisterListener2(this,WH_MSG_GETPROJINFO);RegisterListener2(this,WH_MSG_SHOWTOC);RegisterListener2(this,WH_MSG_SHOWIDX);RegisterListener2(this,WH_MSG_SHOWFTS);RegisterListener2(this,WH_MSG_SHOWGLO);RegisterListener2(this,WH_MSG_GETPANEINFO);RegisterListener2(this,WH_MSG_GETSEARCHSTR);RegisterListener2(this,WH_MSG_HILITESEARCH);RegisterListener2(this,WH_MSG_GETNUMRSLT);if((gbMac&&gbIE4)||(gbSunOS&&gbIE5)||gbOpera7){window.onresize=window_resize}else{if(gbIE4){window.onresize=window_resize2}}window.onload=window_OnLoad;window.onbeforeunload=window_MyBunload;window.onunload=window_unload;gbWhPHost=true}else{document.location.reload()};if(typeof(Sys)!=="undefined"){Sys.Application.notifyScriptLoaded()};