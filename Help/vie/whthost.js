var gaHSLoad=new Array();var gnMinIdx=0;var gnInsIdx=-1;var gsLoadingDivID="LoadingDiv";var gsLoadingMsg="Đang nạp, nhấp vào đây để hủy...";var gaProj=null;var gaTocs=new Array();var goChunk=null;var gbReady=false;var gbToc=false;var gbXML=false;var gaRoot=new Array();var gnCC=-1;var gsTP="";var gaBTPs="";var gsCTPath="";var gnLT=-1;var gsPathSplit="\n";var gsBgColor="#ffffff";var gsBgImage="";var goFont=null;var goHFont=null;var gsMargin="0pt";var gsIndent="15pt";var gsABgColor="#cccccc";var giBookClose="";var giBookOpen="";var giBookItem="";var giURLItem="";var giNewBookClose="";var giNewBookOpen="";var giNewBookItem="";var giNewURLItem="";var gnImages=0;var gnLoadedImages=0;var gaImgs=new Array();var gbLoadData=false;var gobj=null;var gaTocsNs61Fix=null;var gbWhTHost=false;var gBookItems=new Array();var gInSync=false;var gbLData=false;var gbNeedFillStub=false;var gbLoadToc=false;function chunkInfoQueue(){this.aContent=new Array();this.inQueue=function(a){this.aContent[this.aContent.length]=a};this.deQueue=function(){var b=null;if(this.aContent.length>0){b=this.aContent[0];for(var a=1;a<this.aContent.length;a++){this.aContent[a-1]=this.aContent[a]}this.aContent.length--}return b};this.length=function(){return this.aContent.length}}var gchunkRequestQueue=new chunkInfoQueue();function chunkInfo(b,a){this.nIdx=b;this.bLocal=a}function setBackground(a){gsBgImage=a}function setBackgroundcolor(a){gsBgColor=a}function setFont(h,d,f,a,c,g,e){var b=new whFont(d,f,a,c,g,e);if(h=="Normal"){goFont=b}else{if(h=="Hover"){goHFont=b}}}function setActiveBgColor(a){gsABgColor=a}function setMargin(a){gsMargin=a}function setIndent(a){gsIndent=a}function setIcon(b,a){if(b=="BookOpen"){giBookOpen=a}else{if(b=="BookClose"){giBookClose=a}else{if(b=="Item"){giBookItem=a}else{if(b=="RemoteItem"){giURLItem=a}else{if(b=="NewBookClose"){giNewBookClose=a}else{if(b=="NewBookOpen"){giNewBookOpen=a}else{if(b=="NewItem"){giNewBookItem=a}else{if(b=="NewRemoteItem"){giNewURLItem=a}}}}}}}}}function bookItem(a,b){if(a){this.sTarget=a}else{this.sTarget="bsscright"}this.sURL=b}function addBookItem(b,a,c){gBookItems[b]=new bookItem(a,c)}function tocChunk(b,a){this.sPPath=b;this.sDPath=a;this.nMI=-1;this.aTocs=null}function addTocChunk(b,a){var c=new tocChunk(b,a);gaTocs[gaTocs.length]=c;return c}function isHSLoad(b){for(var a=0;a<gaHSLoad.length;a++){if(gaHSLoad[a]==b){return true}}return false}function setHSLoad(c){if(!isHSLoad(c)){var a=gaHSLoad.length;for(var b=0;b<a;b++){if(gaHSLoad[b]==-1){gaHSLoad[b]=c;return}}gaHSLoad[a]=c}}function setHSUnLoad(b){if(isHSLoad(b)){for(var a=0;a<gaHSLoad.length;a++){if(gaHSLoad[a]==b){gaHSLoad[a]=-1;return}}}}function removeLoadingDiv(){var a=getElement(gsLoadingDivID);if(a){removeThis(a)}}function checkBookItem(b){if(!gInSync){var a=getBookId(b);if(gBookItems[a]){window.open(gBookItems[a].sURL,gBookItems[a].sTarget)}}}function insertBookItems(d,b){checkBookItem(d);var a=getCBId(d);var e=getElement(a);if(e){if((e.childNodes&&e.childNodes.length==0)||(e.all&&e.all.length==0)){var c=writeBookItems(d,b);e.innerHTML=c;setTimeout("syncInit()",1)}}ExpandIt(d)}function isBookEmpty(g){var d=getItemContentsNum(g);if(d>0){var f=0;do{f++;var e=g+f;var a=getItemType(e);if(a==1){if(!isBookEmpty(e)){return false}}else{if(a==4){var b=getRefURL(e);var c=getProject(b);if(c!=-1){b=gaRoot[c].sToc;if(b){return false}}}else{if(a==2||a==16||a==8){return false}}}}while(f<d)}return true}function writeBook(b){var a=getBookImage(b,true);var e=_textToHtml(getItemName(b));a=_textToHtml_nonbsp(a);var f=getItemType(b);var g=(f==1);var c=(f!=4);var d='<div id="'+getPBId(b)+'" class=';if(g){if(!isBookEmpty(b)){var h=_textToHtml_nonbsp(getItemURL(b));var i="javascript:void()";if(h!=""){i=h}d+='parent><p><nobr><a id="'+getBookId(b)+'" href="'+i+'" onfocus="markBook('+b+');" onclick="';if(gbSafari3){d+="markBook("+b+");insertBookItems("+b+", "+getItemContentsNum(b)}else{d+="insertBookItems("+b+", "+getItemContentsNum(b)}d+=');return false;" title="'+e+'"><img alt="Sách" name="'+getBId(b)+'" src="'+a+'" border=0 align="absmiddle">';d+="&nbsp;"+e+"</a></nobr></p></div>";if(h!=""){addBookItem(getBookId(b),_textToHtml_nonbsp(getTopicTarget(b)),h)}d+='<div id="'+getCBId(b)+'" class=child></div>'}else{d=""}}else{d+="stub></div>";gbNeedFillStub=true;setTimeout("fillStub("+b+","+c+");",100)}return d}function checkFillStub(){if(!gbLData){if(gchunkRequestQueue.length()>0){var a=gchunkRequestQueue.deQueue();if(a){fillStub(a.nIdx,a.bLocal);return}}}if(gbNeedFillStub){gbNeedFillStub=false;setTimeout("syncInit()",1)}}function fillStub(c,b){if(!gbLData){gbLData=true;var a=getElement(getPBId(c));if(a!=null){tocExpandHelpSet(c,b);gbNeedFillStub=false;setTimeout("syncInit()",1)}else{setTimeout("fillStub("+c+","+b+");",100)}}else{gchunkRequestQueue.inQueue(new chunkInfo(c,b))}}function getBookId(a){return"B_"+a}function getItemId(a){return"I_"+a}function markBook(a){var b=getElement(getItemId(a));if(b==null){b=getElement(getBookId(a))}if(gbNav6){gobj=b;setTimeout("delayMarkObj();",1)}else{markObj(b)}}function delayMarkObj(){if(gobj){markObj(gobj);gobj=null}}function markObj(b){if(b!=null){HighLightElement(b,gsABgColor,"transparent");var a=calTocPath(b);if(gsCTPath!=a){gsCTPath=a}}}function markItem(a){var b=getElement(getItemId(a));if(gbNav6){gobj=b;setTimeout("delayMarkObj();",1)}else{markObj(getElement(getItemId(a)))}}function calTocPath(f){var c=getInnerText2(f);var h=getParentNode(f);do{while(h!=null&&!isCBId(h.id)){h=getParentNode(h)}if(h!=null){var b=getIdByCBId(h.id);var a=getElement(getPBId(b));if(a!=null){var g=getItemsByBook(a);for(var e=0;e<g.length;e++){var d=getInnerText2(g[e]);if(d.length!=0){c=d+gsPathSplit+c;break}}}h=getParentNode(h)}}while(h!=null);return c}function writeAnItem(d){var b=_textToHtml_nonbsp(getTopicTarget(d));var g=getItemIcon(d,0);if(g==""){var a=getItemType(d);if(a&2){g=getItemImage(d,false)}else{g=getItemImage(d,true)}}g=_textToHtml_nonbsp(g);var f=_textToHtml(getItemName(d));var c='<p><nobr><a id="'+getItemId(d)+'" onfocus ="markItem('+d+');" onclick="markItem('+d+');"';var e="";if(a&2){e="Trang"}else{e="Trang Từ xa"}if(b!=""){c+='target="'+b+'" '}c+='href="'+_textToHtml_nonbsp(getItemURL(d))+'" title="'+f+'"><img alt="'+e+'" src="'+g+'" border=0 align="absmiddle">&nbsp;'+f+"</a></nobr></p>";return c}function writeBookItems(f,b){var e="";if(b>0){var d=0;do{d++;var c=f+d;var a=getItemType(c);if(a==1||a==4||a==8){e+=writeBook(c);d+=getItemContentsNum(c)}else{if(a==2||a==16){e+=writeAnItem(c)}}}while(d<b)}return e}function tocExpandHelpSet(d,c){checkBookItem(d);removeLoadingDiv();if(!isHSLoad(d)){setHSLoad(d);var a="";if(c){var e=getChunk(d);if(e){goChunk=addTocChunk(e.sPPath,e.sDPath);a=e.aTocs[d-e.nMI].sRefURL}}else{a=getRefURL(d);var b=getProject(a);if(b!=-1){a=gaRoot[b].sToc;if(a){goChunk=addTocChunk(gaProj[b].sPPath,gaProj[b].sDPath)}else{goChunk=null}}else{goChunk=null}}if(goChunk){PrepareLoading(d);gbToc=false;loadData2(goChunk.sPPath+goChunk.sDPath+a)}else{gbLData=false;checkFillStub()}}}function getProject(a){for(var b=0;b<gaProj.length;b++){if(isSamePath(getPath(a),gaProj[b].sPPath)){return b}}return -1}function getPath(a){if(a!=""){a=_replaceSlash(a);var b=a.lastIndexOf("/");a=a.substring(0,b+1)}return a}function isSamePath(b,a){return(b.toLowerCase()==a.toLowerCase())}function PrepareLoading(b){gnInsIdx=b;if(!gsTP){var a=getElement(getPBId(gnInsIdx));if(a){a.insertAdjacentHTML("afterEnd",writeLoadingDiv(b))}}}function writeLoadingDiv(a){return'<div id="'+gsLoadingDivID+'" class=parent onclick="removeLoadingDiv();" style="padding-left:4px;background-color:ivory;border-width:1;border-style:solid;border-color:black;width:150px;">'+gsLoadingMsg+"</div>"}function getItemName(a){var b=getChunk(a);if(b){return b.aTocs[a-b.nMI].sItemName}else{return null}}function getItemContentsNum(a){var b=getChunk(a);if(b){return b.aTocs[a-b.nMI].nContents}else{return null}}function getItemType(a){var b=getChunk(a);if(b){return b.aTocs[a-b.nMI].nType}else{return 0}}function getItemURL(b){var c=getChunk(b);if(c){var a=c.aTocs[b-c.nMI].sItemURL;if(!(a==null||a=="")){return _getFullPath(c.sPPath,a)}}return""}function getRefURL(b){var c=getChunk(b);if(c){var a=c.aTocs[b-c.nMI].sRefURL;if(!(a==null||a=="")){return _getFullPath(c.sPPath,a)}}return""}function getTopicTarget(a){var b=getChunk(a);if(b){if(typeof(b.aTocs[a-b.nMI].sTarget)!="undefined"){return b.aTocs[a-b.nMI].sTarget}}return""}function getItemIcon(d,b){var e=getChunk(d);if(e){if(typeof(e.aTocs[d-e.nMI].sIconRef)!="undefined"){var c=e.aTocs[d-e.nMI].sIconRef;var a=c.indexOf(";");while(b-->0&&a!=-1){c=c.substring(a+1);a=c.indexOf(";")}if(b<0){if(a!=-1){c=c.substring(0,a)}return _getFullPath(e.sPPath,c)}}}return""}function TocWriteClassStyle(){var a="<STYLE TYPE='text/css'>\n";if(gsBgImage){a+="body {border-top:"+gsBgColor+" 1px solid;}\n"}else{a+="body {border-top:black 1px solid;}\n"}a+="P {"+getFontStyle(goFont)+"margin-top:"+gsMargin+";margin-bottom:"+gsMargin+";}\n";a+="DIV {margin-top:"+gsMargin+";margin-bottom:"+gsMargin+";}\n";a+=".parent {margin-left:0pt;}\n";a+=".stub {margin-left:0pt;display:none}\n";a+=".child {display:none;margin-left:"+gsIndent+";}\n";a+="A:link {"+getFontStyle(goFont)+"}\n";a+="A:visited {"+getFontStyle(goFont)+"}\n";a+="A:active {background-color:"+gsABgColor+";}\n";a+="A:hover {"+getFontStyle(goHFont)+"}\n";a+="</STYLE>";document.write(a)}function TocWriteFixedWidth(b,a){if((gbIE4)&&(gbMac)&&(!gbIE5)){if(b){document.write("<table width="+a+" border=0><tr><td>")}else{document.write("</td></tr></table>")}}}function TocInitPage(){var a=getItemsByBook(document.body);if(a.length>0){a[0].focus()}}function getItemsFromObj(e){var c=new Array();var a=getChildrenByTag(e,"P");if(a&&a.length>0){var k=new Array();for(var f=0;f<a.length;f++){var g=getChildrenByTag(a[f],"NOBR");if(g&&g.length>0){for(var d=0;d<g.length;d++){k[k.length]=g[d]}}}for(var l=0;l<k.length;l++){var b=getChildrenByTag(k[l],"A");if(b&&b.length>0){for(var h=0;h<b.length;h++){c[c.length]=b[h]}}}}return c}function getItemsByBook(h){var b=new Array();var f=getItemsFromObj(h);for(var e=0;e<f.length;e++){b[b.length]=f[e]}var d=getChildrenByTag(h,"DIV");if(d&&d.length>0){for(var c=0;c<d.length;c++){var a=getItemsFromObj(d[c]);for(var g=0;g<a.length;g++){b[b.length]=a[g]}}}return b}function ExpandIt(a){if(!gsTP){ExpandIt2(a,false)}}function ExpandIt2(b,f){var a=TocExpand(b,true,f);var d=document.body.scrollTop;if(a.style.display=="block"){var e=a.offsetTop;var c=e+a.offsetHeight;if(document.body.scrollTop+getClientHeight()<c){d=c-getClientHeight()}if(c-e>getClientHeight()){d=e-20}}document.body.scrollTop=d}function TocExpand(c,b,f){var e=getElement(getCBId(c));if(e==null){return null}var a=document.images[getBId(c)];if((e.style.display!="block")||f){e.style.display="block";if(b){var d=getPath(a.src);d=_getFullPath(d,getBookImage(c,false));a.src=d}}else{e.style.display="none";if(b){var d=getPath(a.src);d=_getFullPath(d,getBookImage(c,true));a.src=d}if(gbMac&&gbIE5){this.parent.document.getElementById("tocIFrame").style.width="101%";this.parent.document.getElementById("tocIFrame").style.width="100%"}}return e}function getChunkId(c){var a=-1;for(var b=0;b<gaTocs.length;b++){if(gaTocs[b].nMI<=c&&gaTocs[b].nMI!=-1){if(a==-1){a=b}else{if(gaTocs[b].nMI>=gaTocs[a].nMI){a=b}}}}if(a!=-1){return a}else{return -1}}function getChunk(a){if(gnCC!=-1&&gaTocs[gnCC].nMI<=a&&(gnCC==gaTocs.length-1||gaTocs[gnCC+1].nMI>a)){return gaTocs[gnCC]}else{gnCC=getChunkId(a);if(gnCC!=-1){return gaTocs[gnCC]}else{return null}}}function getBookImage(b,a){var b=a?0:1;var c=getItemIcon(b,b);if(c==""){if(a){c=giBookClose}else{c=giBookOpen}}return _getFullPath(gaProj[0].sPPath,c)}function getItemImage(b,a){var c=getItemIcon(b,0);if(c==""){if(a){c=giURLItem}else{c=giBookItem}}return _getFullPath(gaProj[0].sPPath,c)}function getInnerText2(b){var a=getInnerText(b);if(a.length>0&&!gbOpera7){a=a.substring(1)}return a}function expandToc(h,q,g){var v=g.length;var y=q.indexOf(gsPathSplit);if(y!=-1){sPart=q.substring(0,y);q=q.substring(y+1)}else{sPart=q;var t=getItemsByBook(h);for(var m=0;m<t.length;m++){var r=getInnerText2(t[m]);if(r==sPart){g[v]=t[m];return 1}}return 0}var w=getChildrenByTag(h,"DIV");for(var u=0;u<w.length;u++){var a=w[u].id;if(!isPBId(a)){continue}var r=getInnerText2(w[u]);r=r.replace("\n","");if(r!=sPart){continue}g[v]=getIdByPBId(a);var x=getCBId(g[v]);var e=getElement(x);if(e){if(e.innerHTML==""){var k=getItemsByBook(w[u]);if(k.length>0){if(gbNav6||gbSafari3){if(gbNav6){var b=k[0].getAttribute("onClick");var c=b.indexOf(";");b=b.substring(0,c)}else{if(gbSafari3){var b=k[0].getAttribute("onClick");var o=b.indexOf(";");var n=b.indexOf(";",o+1);b=b.substring(o+1,n)}}var f=b.indexOf("(");var d=b.indexOf(",",f);var l=b.substring(f+1,d);f=d;d=b.indexOf(")",f);var j=b.substring(f+1,d);n1=parseInt(l);n2=parseInt(j);insertBookItems(n1,n2)}else{k[0].click()}}return -1}var p=expandToc(e,q,g);if(p){return p}}}g.length=v;return 0}function getIdByPBId(a){return parseInt(a.substring(2,a.length-1))}function getIdByCBId(a){return parseInt(a.substring(2,a.length-1))}function isPBId(a){return(a&&a.indexOf("B_")==0&&a.lastIndexOf("P")==a.length-1)}function isCBId(a){return(a&&a.indexOf("B_")==0&&a.lastIndexOf("C")==a.length-1)}function getBId(a){return"B_"+a}function getPBId(a){return getBId(a)+"P"}function getCBId(a){return getBId(a)+"C"}function getClosestTocPath(d){var f=0;var e=-1;var b=null;if(d.length==0){return b}for(var c=0;c<d.length;c++){var a=comparePath(gsCTPath,d[c]);if(a>f){f=a;e=c}}if(e!=-1){b=d[e]}else{b=d[0]}return b}function comparePath(h,g){var i=0;var f=0;var b=-1;var e=0;var a=-1;do{var d=null;var c=null;b=h.indexOf(gsPathSplit,f);if(b!=-1){d=h.substring(f,b);f=b+1}else{d=h.substring(f);f=-1}a=g.indexOf(gsPathSplit,e);if(b!=-1){c=g.substring(e,a);e=a+1}else{c=g.substring(e);e=-1}if(d==c){i++}else{break}}while(f!=-1&&e!=-1);return i}function getTocPaths(f){var a=f.aPaths;var g=new Array();for(var e=0;e<gaProj.length;e++){if(isSamePath(gaProj[e].sPPath,f.sPPath)){for(var d=0;d<a.length;d++){for(var c=0;c<gaRoot[e].aRPath.length;c++){var b=gaRoot[e].aRPath[c]+a[d];g[g.length]=b.substring(1)}}break}}return g}function syncInit(){if(gsTP&&!gbNeedFillStub){gInSync=true;var e=document.body;var c=new Array();var f=expandToc(e,gsTP,c);if(f!=-1){if(f==1){if(c.length){for(var b=0;b<c.length-1;b++){ExpandIt2(c[b],true)}}gsCTPath=gsTP;HighLightElement(c[c.length-1],gsABgColor,"transparent");c[c.length-1].focus();gsTP=null}if(gaBTPs!=""&&gaBTPs!=null){var d=gaBTPs;gsTP=null;gaBTPs=null;if(d!=null){var a=getClosestTocPath(d);if(a!=null){gsTP=a;setTimeout("syncInit()",1)}}}}gInSync=false}}function loadToc(){if(!gbLoadToc){var a=new whMessage(WH_MSG_GETPROJINFO,this,1,null);if(SendMessage(a)&&a.oParam){gbLoadToc=true;var b=a.oParam;gaProj=b.aProj;gbXML=b.bXML;load1B1()}}}function load1B1(){if(gnLT+1<gaProj.length){for(var a=gnLT+1;a<gaProj.length;a++){if(gaProj[a].sToc){gbToc=true;gnLT=a;setTimeout("loadTocInfo()",1);return true}}}return false}function loadTocInfo(){loadData2(gaProj[gnLT].sPPath+gaProj[gnLT].sDPath+gaProj[gnLT].sToc)}function loadData2(a){if(gbXML){loadDataXML(a)}else{loadData(a)}}function projReady(b,a){if(gaRoot.length<=gnLT||!gaRoot[gnLT]){gaRoot[gnLT]=new Object()}gaRoot[gnLT].sToc=b;if(gnLT==0){gaRoot[gnLT].aRPath=new Array();gaRoot[gnLT].aRPath[0]=gsPathSplit}updatePTPath(gnLT,a);if(!((gnLT+1<gaProj.length)&&load1B1())){gbReady=true;if(gbIE4){setTimeout("loadImages();",1)}else{setTimeout("loadTData();",1)}}}function loadTData(){if(gaProj[0].sToc!=""){gbLData=true;goChunk=addTocChunk(gaProj[0].sPPath,gaProj[0].sDPath);gbToc=false;loadData2(gaProj[0].sPPath+gaProj[0].sDPath+gaRoot[0].sToc)}}function updatePTPath(a,b){if(b){for(var g=0;g<b.length;g++){var m=_getFullPath(gaProj[a].sPPath,b[g].sPPath);for(var f=0;f<gaProj.length;f++){if(isSamePath(m,gaProj[f].sPPath)){if(gaRoot.length<=f||!gaRoot[f]){gaRoot[f]=new Object()}if(!gaRoot[f].aRPath){gaRoot[f].aRPath=new Array()}if(gaRoot[a].aRPath){for(var e=0;e<gaRoot[a].aRPath.length;e++){var h=false;var d=gaRoot[a].aRPath[e]+b[g].sRPath;for(var c=0;c<gaRoot[f].aRPath.length;c++){if(gaRoot[f].aRPath[c]==d){h=true;break}}if(!h){gaRoot[f].aRPath[gaRoot[f].aRPath.length]=d}}}else{gaRoot[f].aRPath[gaRoot[f].aRPath.length]=b[g].sRPath}break}}}}}function onLoadXMLError(){if(gbToc){var c="";var b=new Array();projReady(c,b)}else{var a=new Array();putData(a)}}function putDataXML(k,j){if(gbToc){var l=k.getElementsByTagName("toc")[0];if(l){var b=l.getAttribute("root");var h=l.getElementsByTagName("project");var c=new Array();if(h.length>0){for(var d=0;d<h.length;d++){c[d]=new Object();var f=h[d].getAttribute("url");if(f){if(f.lastIndexOf("/")!=f.length-1){f+="/"}}c[d].sPPath=f;c[d].sRPath="";var g=h[d].getElementsByTagName("subpath")[0];if(g){while(g){c[d].sRPath+=g.getAttribute("name")+"\n";g=g.getElementsByTagName("subpath")[0]}}else{c[d].sRPath=h[d].getAttribute("path")}}}projReady(b,c)}}else{var e=k.getElementsByTagName("tocdata")[0];if(e){var a=new Array();processBook(e,a);putData(a)}}}function processBook(d,a){var f=0;var k=null;var g=null;var n=d.firstChild;do{if(n){if(n.nodeName.indexOf("#")!=0){var e=n.getAttribute("name");var j=n.getAttribute("url");var c=n.getAttribute("ref");var b=n.getAttribute("target");var m=n.getAttribute("images");var l=new Object();l.sItemName=e;if(b){l.sTarget=b}if(m){l.sIconRef=m}if(j==null){j=""}l.sItemURL=j;if(n.nodeName=="book"){l.nType=1;a[a.length]=l;var h=a.length;processBook(n,a);l.nContents=a.length-h}else{if(n.nodeName=="item"){l.nType=2;l.nContents=0;a[a.length]=l}else{if(n.nodeName=="remoteitem"){l.nType=16;l.nContents=0;a[a.length]=l}else{if(n.nodeName=="project"){if(c){if(c.lastIndexOf("/")!=c.length-1){c+="/"}}l.nType=4;l.sRefURL=c;l.nContents=0;a[a.length]=l}else{if(n.nodeName=="chunk"){l.nType=8;l.sRefURL=c;l.nContents=0;a[a.length]=l}}}}}}}else{break}n=n.nextSibling}while(true)}function putData(a){gaTocsNs61Fix=a;setTimeout("realPutData();",1)}function realPutData(){removeLoadingDiv();var b=gaTocsNs61Fix;if(!b){return}if(goChunk){var e=gnMinIdx;goChunk.nMI=gnMinIdx;goChunk.aTocs=b;gnMinIdx+=b.length;if(gnInsIdx!=-1){var a=getElement(getPBId(gnInsIdx));if(a){a.insertAdjacentHTML("afterEnd",writeBookItems(e-1,b.length));setTimeout("syncInit()",1)}}else{document.body.insertAdjacentHTML("beforeEnd",writeBookItems(e-1,b.length));var d=new Object();d.oTocInfo=null;var c=new whMessage(WH_MSG_GETTOCPATHS,this,1,d);if(SendMessage(c)){if(c.oParam.oTocInfo){syncWithPaths(c.oParam.oTocInfo)}}}}gbLData=false;checkFillStub()}function syncWithPaths(b){var c=getTocPaths(b);if(gsTP){gaBTPs=c}else{var a=getClosestTocPath(c);if(a!=null){gsTP=a;setTimeout("syncInit()",1)}}}function window_OnLoad(){if(gsBgImage&&gsBgImage.length>0){document.body.background=gsBgImage}if(gsBgColor&&gsBgColor.length>0){document.body.bgColor=gsBgColor}loadToc();var a=new whMessage(WH_MSG_SHOWTOC,this,1,null);SendMessage(a)}function loadImages(){if(giBookClose){gaImgs[gnImages]=giBookClose;gnImages++}if(giBookOpen){gaImgs[gnImages]=giBookOpen;gnImages++}if(giBookItem){gaImgs[gnImages]=giBookItem;gnImages++}if(giURLItem){gaImgs[gnImages]=giURLItem;gnImages++}if(giNewBookClose){gaImgs[gnImages]=giNewBookClose;gnImages++}if(giNewBookOpen){gaImgs[gnImages]=giNewBookOpen;gnImages++}if(giNewBookItem){gaImgs[gnImages]=giNewBookItem;gnImages++}if(giNewURLItem){gaImgs[gnImages]=giNewURLItem;gnImages++}if(gnImages>0){setTimeout("loadDataAfter();",1000);loadImage(gaImgs[0])}else{loadDataAfter()}}function loadImage(b){var a=new Image();a.onload=checkImageLoading;a.onerror=errorImageLoading;a.src=_getFullPath(gaProj[0].sPPath,b)}function loadDataAfter(){if(!gbLoadData){gbLoadData=true;loadTData()}}function errorImageLoading(){gnLoadedImages++;if(gnImages==gnLoadedImages){loadDataAfter()}else{loadImage(gaImgs[gnLoadedImages])}}function checkImageLoading(){gnLoadedImages++;if(gnImages==gnLoadedImages){loadDataAfter()}else{loadImage(gaImgs[gnLoadedImages])}}function window_unload(){UnRegisterListener2(this,WH_MSG_PROJECTREADY);UnRegisterListener2(this,WH_MSG_SYNCTOC);UnRegisterListener2(this,WH_MSG_SHOWTOC)}function onSendMessage(a){if(a){var b=a.nMessageId;if(b==WH_MSG_PROJECTREADY){loadToc()}else{if(b==WH_MSG_SYNCTOC){if(gbReady){syncWithPaths(a.oParam)}}else{if(b==WH_MSG_SHOWTOC){if(!gbNav6){document.body.focus()}}}}}return true}if(window.gbWhUtil&&window.gbWhVer&&window.gbWhMsg&&window.gbWhProxy){RegisterListener2(this,WH_MSG_PROJECTREADY);RegisterListener2(this,WH_MSG_SYNCTOC);RegisterListener2(this,WH_MSG_SHOWTOC);goFont=new whFont("Verdana","8pt","#000000","normal","normal","none");goHFont=new whFont("Verdana","8pt","#007f00","normal","normal","underline");window.onload=window_OnLoad;window.onbeforeunload=window_BUnload;window.onunload=window_unload;gbWhTHost=true}else{document.location.reload()};if(typeof(Sys)!=="undefined"){Sys.Application.notifyScriptLoaded()};