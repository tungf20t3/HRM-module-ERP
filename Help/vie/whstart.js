RegisterListener2(this,WH_MSG_GETSTARTFRAME);RegisterListener2(this,WH_MSG_GETDEFAULTTOPIC);RegisterListener2(this,WH_MSG_MINIBARORDER);RegisterListener2(this,WH_MSG_TOOLBARORDER);RegisterListener2(this,WH_MSG_ISSEARCHSUPPORT);RegisterListener2(this,WH_MSG_ISSYNCSSUPPORT);RegisterListener2(this,WH_MSG_ISAVENUESUPPORT);RegisterListener2(this,WH_MSG_GETPANETYPE);RegisterListener2(this,WH_MSG_GETPANES);RegisterListener2(this,WH_MSG_RELOADNS6);RegisterListener2(this,WH_MSG_GETCMD);RegisterListener2(this,WH_MSG_GETPANE);RegisterListener2(this,WH_MSG_GETDEFPANE);if(gbNav4&&!gbNav6){var gnReload=0;setTimeout("delayReload();",5000)}function delayReload(){if(!(this.cMRServer&&cMRServer.m_strVersion)){if(gnReload!=2){if(typeof(nViewFrameType)!="undefined"&&nViewFrameType==1){document.location=document.location}}}}var gsToolbarOrder="toc|idx|fts|blankblock|searchform";var gsMinibarOrder="blankblock|hide2|";var gsTopic="Features.htm";var PANE_OPT_SEARCH=1;var PANE_OPT_BROWSESEQ=2;var gnOpts=-1;var gnCmd=-1;var gnPans=2;var gsBtns="invalid";var gsDefaultBtn="invalid";var gbHasTitle=false;if(location.hash.length>1){var sParam=location.hash;sParam=PatchParametersForEscapeChar(sParam);if(sParam.indexOf("#<")==0){document.location="whcsh_home.htm#"+sParam.substring(2)}else{if(sParam.indexOf("#>>")==0){parseParam(sParam.substring(3));sParam="#"+gsTopic+sParam.substring(1)}else{var nPos=sParam.indexOf(">>");if(nPos>1){if(IsInternal(sParam.substring(1,nPos))){gsTopic=sParam.substring(1,nPos)}parseParam(sParam.substring(nPos+2))}else{if(IsInternal(sParam.substring(1))){gsTopic=sParam.substring(1)}}}}if(gnPans==1&&gsTopic){var strURL=location.href;if(location.hash){var nPos=location.href.indexOf(location.hash);strURL=strURL.substring(0,nPos)}if(gbHasTitle){document.location=_getPath(strURL)+"whskin_tw.htm"+sParam}else{document.location=_getPath(strURL)+gsTopic}}}function parseParam(a){if(a){var c=0;do{var b=a.indexOf(">>",c);if(b!=-1){if(b>0){var d=a.substring(c,b);parsePart(d)}c=b+2}else{var d=a.substring(c);parsePart(d);break}}while(c<a.length)}}function parsePart(d){if(d.toLowerCase().indexOf("cmd=")==0){gnCmd=parseInt(d.substring(4))}else{if(d.toLowerCase().indexOf("cap=")==0){document.title=_browserStringToText(d.substring(4));gbHasTitle=true}else{if(d.toLowerCase().indexOf("pan=")==0){gnPans=parseInt(d.substring(4))}else{if(d.toLowerCase().indexOf("pot=")==0){gnOpts=parseInt(d.substring(4))}else{if(d.toLowerCase().indexOf("pbs=")==0){var c=d.substring(4);var a=c.split("|");for(var b=0;b<a.length;b++){a[b]=transferAgentNameToPaneName(a[b])}gsRawBtns=a.join("|")}else{if(d.toLowerCase().indexOf("pdb=")==0){gsDefaultBtn=transferAgentNameToPaneName(d.substring(4))}}}}}}}function setToolbarOrder(a){gsToolbarOrder=a}function setMinibarOrder(a){gsMinibarOrder=a}function onSendMessageX(f){var p=f.nMessageId;if(p==WH_MSG_GETSTARTFRAME){f.oParam.oFrame=this;return false}else{if(p==WH_MSG_GETDEFAULTTOPIC){if(this.cMRServer&&cMRServer.m_strVersion){if(cMRServer.m_strURLTopic){}f.oParam.sTopic=cMRServer.m_strURLTopic;return false}f.oParam.sTopic=gsTopic;return false}else{if(p==WH_MSG_TOOLBARORDER){var d=new whMessage(WH_MSG_GETPANES,this,1,null);if(SendMessage(d)){if(d.oParam){if(this.cMRServer&&cMRServer.m_strVersion){var q=cMRServer.m_strAgentList.split(";");var l=0;for(l=0;l<q.length;l++){q[l]=transferANToPN2(q[l])}q[q.length]="blankblock";if(cMRServer.m_bShowSearchInput){q[q.length]="searchform"}q[q.length]="banner";var e=new Array();for(l=0;l<q.length;l++){if(isAPane(q[l])){if(d.oParam.aPanes&&d.oParam.aPanes.length){for(var k=0;k<d.oParam.aPanes.length;k++){if(q[l]==d.oParam.aPanes[k].sPaneName){e[e.length]=q[l];break}}}}else{e[e.length]=q[l]}}f.oParam=e.join("|");return false}}}var g="";if(gsBtns!="invalid"){g=gsBtns+"|blankblock|banner"}else{g=gsToolbarOrder}if(gnOpts!=-1){var b=g.indexOf("|searchform|");if(gnOpts&PANE_OPT_SEARCH){if(b==-1&&g.indexOf("|fts|")!=-1){var a=g.indexOf("banner");if(a!=-1){g=g.substring(0,a)+"searchform|"+g.substring(a)}}}else{if(b!=-1){g=g.substring(0,b)+g.substring(b+11)}}}f.oParam=g;return false}else{if(p==WH_MSG_MINIBARORDER){var o=gsMinibarOrder;if(gnOpts!=-1){var h=gsMinibarOrder.indexOf("avprev|avnext");if(gnOpts&PANE_OPT_BROWSESEQ){if(h==-1){o="avprev|avnext|"+gsMinibarOrder}}else{if(h!=-1){if(h!=0){o=gsMinibarOrder.substring(0,h)+gsMinibarOrder.substring(h+14)}else{o=gsMinibarOrder.substring(14)}}}}f.oParam=o;return false}else{if(p==WH_MSG_ISSYNCSSUPPORT){if(this.cMRServer&&cMRServer.m_strVersion){if(cMRServer.m_bShowSync){f.oParam=true}else{f.oParam=false}return false}else{if(typeof(nViewFrameType)!="undefined"){f.oParam=(nViewFrameType<3);return false}}}else{if(p==WH_MSG_ISAVENUESUPPORT){if(this.cMRServer&&cMRServer.m_strVersion){if(cMRServer.m_bShowBrowseSequences){f.oParam=true}else{f.oParam=false}}else{f.oParam=true}return false}else{if(p==WH_MSG_ISSEARCHSUPPORT){if(typeof(nViewFrameType)!="undefined"){f.oParam=(nViewFrameType<3);return false}}else{if(p==WH_MSG_GETPANETYPE){if(typeof(nViewFrameType)!="undefined"){var r=new Object();r.nType=nViewFrameType;r.sPaneURL=strPane;f.oParam=r;return false}}else{if(p==WH_MSG_GETPANES){if(this.cMRServer&&cMRServer.m_strVersion){var n=new Object();var m=null;if(cMRServer.m_strDefAgent){n.sDefault=transferAgentNameToPaneName(cMRServer.m_strDefAgent)}aPanes=new Array();for(var l=0;l<cMRServer.m_cAgents.length;l++){var c=aPanes.length;aPanes[c]=new Object();aPanes[c].sPaneName=transferAgentNameToPaneName(cMRServer.m_cAgents[l].m_strID);aPanes[c].sPaneURL=cMRServer.m_cAgents[l].m_strURL}n.aPanes=aPanes;f.oParam=n;return false}else{f.oParam=null;return false}}else{if(p==WH_MSG_RELOADNS6){if(gbNav4&&!gbNav6){gnReload++}return false}else{if(p==WH_MSG_GETCMD){f.oParam=gnCmd;return false}else{if(p==WH_MSG_GETPANE){if(gsBtns!="invalid"&&f.oParam.sName){if(gsBtns.indexOf(f.oParam.sName)!=-1){f.oParam.bEnable=true}else{f.oParam.bEnable=false}}else{f.oParam.bEnable=true}return false}else{if(p==WH_MSG_GETDEFPANE){if(gsDefaultBtn!="invalid"){f.oParam=gsDefaultBtn}return false}}}}}}}}}}}}}return true}function transferANToPN2(a){if(a=="toc"){return"toc"}else{if(a=="ndx"){return"idx"}else{if(a=="nls"){return"fts"}else{if(a=="gls"){return"glo"}else{if(a=="WebSearch"){return"websearch"}else{if(a.indexOf("custom_")==0){}}}}}}return"custom"+a.substring(7);return a}function transferAgentNameToPaneName(a){if(a=="toc"){return"toc"}else{if(a=="ndx"){return"idx"}else{if(a=="nls"){return"fts"}else{if(a=="gls"){return"glo"}}}}return""}function isAPane(a){if(a=="toc"||a=="idx"||a=="fts"||a=="glo"){return true}else{return false}};if(typeof(Sys)!=="undefined"){Sys.Application.notifyScriptLoaded()};