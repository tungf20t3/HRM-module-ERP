<?xml version="1.0" encoding="utf-8"?>

<!DOCTYPE message [
  <!ENTITY CssClass "&lt;head&gt;&lt;style type=&quot;text/css&quot;&gt;.detail{color:#918c8c!important;margin-top:4px;margin-bottom:8px;}.ts{font-family:Verdana;font-size:11px;color:#444444;border-collapse:collapse;text-align:center;border-color:#999;}.info{font-family:Verdana!important;font-size:11px!important;color:#444444;width:100&#37;!important;white-space:normal;border-collapse:collapse;font-style:italic;}.r1{width:50px;text-align:left;}.r2{width:100px;text-align:left;}.r3{width:100px;text-align:right;}.r4{width:300px;text-align:left;}.r5{width:100px;background-color:#f3f3f3;text-align:right;}.r6{width:50px;background-color:#f3f3f3;text-align:left;}.r7{width:300px;background-color:#f3f3f3;text-align:left;}.r8{width:100px;background-color:#f3f3f3;text-align:left;}.r9{width:645px;text-align:left;}.h{height:20px;}&lt;/style&gt;&lt;/head&gt;">
  <!ENTITY HeaderColor "background-color:#edede2;">
  <!ENTITY Comment "
    &lt;div class=&quot;Comment&quot;>{!h_ghi_chu}&lt;/div&gt;
    &lt;textarea name=&quot;txtComment&quot; rows=&quot;2&quot; cols=&quot;20&quot; id=&quot;txtComment&quot; class=&quot;CommentInput&quot; maxlength=&quot;256&quot; spellcheck=&quot;false&quot; autocomplete=&quot;off&quot;&gt;&lt;/textarea&gt;&lt;br&gt;
    &lt;button name=&quot;btnOk&quot; id=&quot;btnOk&quot; class=&quot;Button&quot; onclick=&quot;var n=document.getElementById('txtComment'), v=b64encode(n.value); window.location.href='{!button_href}' + '&amp;t='+v;&quot;&gt;{!button_text}&lt;/button&gt;">

  <!ENTITY % PaymentApprovalMessage SYSTEM "..\Include\PaymentMessage.ent">
  %PaymentApprovalMessage;

  <!ENTITY % BIModeMessage SYSTEM "..\Include\BIMode.Message">
  %BIModeMessage;
]>

<message xmlns="urn:schemas-ai-erp:data-message">
  <mail>
    <template>
      &PaymentApprovalCommentAction;
      &BI.ApprovalCommentAction;

      <action id="PurchaseRequisition" table="m91$000000" v="Phiếu nhu cầu vật tư chờ duyệt" e="Purchase requisition waiting for approval">
        <fields>
          <field name="h_title">
            <header v="Phiếu nhu cầu vật tư chờ duyệt" e="Purchase requisition waiting for approval"/>
          </field>
          <field name="h_so_ct">
            <header v="Số phiếu" e="Number"/>
          </field>
          <field name="h_ngay_ct">
            <header v="Ngày" e="Date"/>
          </field>
          <field name="h_dien_giai">
            <header v="Diễn giải" e="Memo"/>
          </field>
          <field name="h_t_tien">
            <header v="Tổng tiền" e="Total Amount"/>
          </field>
          <field name="h_ghi_chu">
            <header v="Lý do:" e="Comment:"/>
          </field>
        </fields>

        <query id="report">
          <command id="master">
            <text>
              <![CDATA[
declare @l char(1)
select @l = d_language from @@sysDatabaseName..userinfo2 where id = @@contactID
create table #msg (smsg varchar(10), msg0 nvarchar(4000), msg1 nvarchar(4000), msg2 nvarchar(4000), msg3 nvarchar(4000), msg4 nvarchar(4000), msg5 nvarchar(4000), msg6 nvarchar(4000), msg7 nvarchar(4000), msg8 nvarchar(4000), msg9 nvarchar(4000))
insert into #msg exec AI_ERP$App$GetApprovalDetail @@stt_rec, '01205', 'PR1', @l, 1, 1

select ltrim(so_ct) as so_ct, ma_nt, convert(varchar(12), b.ngay_ct, 103) as ngay_ct,
    convert(varchar(32), b.datetime2, 121) as datetime2, dien_giai, dien_thoai, e_mail, d_language,
    upper(ma_nhan) as ma_nhan, upper(ma_huy) as ma_huy, m.smsg, m.msg0, m.msg1, m.msg2, m.msg3, m.msg4, m.msg5, m.msg6, m.msg7, m.msg8, m.msg9
  from @@sysDatabaseName..userinfo2 a, @@table b, dmxn c, #msg m
  where a.id = @@contactID and b.stt_rec = @@stt_rec and b.stt_rec = c.stt_rec and a.id = c.user_id
]]>
            </text>
          </command>

          <command id="footer">
            <text>
              <![CDATA[
declare @amountFormat varchar(32), @ma_nt varchar(32)
declare @t table(field varchar(32), format varchar(128))
select @ma_nt = ma_nt from @@table where stt_rec = @@stt_rec

if exists(select 1 from options where name = 'm_ma_nt0' and rtrim(val) = @ma_nt) select @amountFormat = rtrim(val) from options where name = 'm_ip_tien'
else select @amountFormat = rtrim(val) from options where name = 'm_ip_tien_nt'

insert into @t select 't_tt_nt', @amountFormat

select cast(t_tien_nt as varchar) as t_tt_nt from @@table where stt_rec = @@stt_rec
select * from @t
]]>
            </text>
          </command>
        </query>

        <body>
          <header>
            <text>
              <![CDATA[
<html>]]>&CssClass;<![CDATA[
<body><div style="padding:8px">
<div style="text-align:left;padding-bottom:8px;font-size:12px;font-weight:600;" class="ts">{!h_title}</div>
<table class="ts" border="0" cellpadding="1" cellspacing="1">
<tr class="h"><td style="width:120px;text-align:left;white-space:nowrap;">{!h_so_ct}</td><td class="r4">{!so_ct}</td></tr>
<tr class="h"><td style="width:120px;text-align:left;white-space:nowrap;">{!h_ngay_ct}</td><td class="r4">{!ngay_ct}</td></tr>
<tr class="h"><td style="width:120px;text-align:left;white-space:nowrap;">{!h_dien_giai}</td><td class="r9">{!dien_giai}</td></tr>
</table><br/>
<table class="ts detail" border="1" cellspacing="2" cellpadding="4">
]]>
            </text>
          </header>

          <footer>
            <text>
              <![CDATA[
<tr class="h"><td colspan="6" style="width:115px;text-align: right;">{!h_t_tien}</td><td class="r3">{!t_tt_nt}</td></tr>
</table>

<div style="padding-top:4px;display:{!smsg};" class="info r9">{!msg0}{!msg1}{!msg2}{!msg3}{!msg4}{!msg5}{!msg6}{!msg7}{!msg8}{!msg9}</div><br />
</body></html>
]]>&Comment;
            </text>
          </footer>
        </body>
      </action>

      <action id="ImportPurchaseOrder" table="m95$000000" v="Đơn hàng nhập khẩu chờ duyệt" e="Import purchase order waiting for approval">
        <fields>
          <field name="h_title">
            <header v="Đơn hàng nhập khẩu chờ duyệt" e="Import purchase order waiting for approval"/>
          </field>
          <field name="h_so_ct">
            <header v="Số đơn hàng" e="Number"/>
          </field>
          <field name="h_ngay_ct">
            <header v="Ngày" e="Date"/>
          </field>
          <field name="h_dien_giai">
            <header v="Diễn giải" e="Memo"/>
          </field>
          <field name="h_nha_cc">
            <header v="Nhà cung cấp" e="Supplier"/>
          </field>
          <field name="h_t_tien">
            <header v="Tiền hàng" e="Amount"/>
          </field>
          <field name="h_t_cp">
            <header v="Chi phí" e="Charges"/>
          </field>
          <field name="h_t_nk">
            <header v="Thuế nhập khẩu" e="Import Tax"/>
          </field>
          <field name="h_t_ttdb">
            <header v="Thuế tiêu thụ đb" e="Excise Tax"/>
          </field>
          <field name="h_t_gtgt">
            <header v="Thuế gtgt" e="VAT Amount"/>
          </field>
          <field name="h_t_tt">
            <header v="Tổng tiền" e="Total Amount"/>
          </field>
          <field name="h_ghi_chu">
            <header v="Lý do:" e="Comment:"/>
          </field>
        </fields>

        <query id="report">
          <command id="master">
            <text>
              <![CDATA[
declare @id int, @l varchar(8)
select @id = @@contactID
select @l = d_language from @@sysDatabaseName..userinfo2 where id = @id

create table #msg (smsg varchar(10), msg0 nvarchar(4000), msg1 nvarchar(4000), msg2 nvarchar(4000), msg3 nvarchar(4000), msg4 nvarchar(4000), msg5 nvarchar(4000), msg6 nvarchar(4000), msg7 nvarchar(4000), msg8 nvarchar(4000), msg9 nvarchar(4000))
insert into #msg exec AI_ERP$App$GetApprovalDetail @@stt_rec, '01220', 'PO2', @l, 1, 1

select ltrim(so_ct) as so_ct, ma_nt,
convert(varchar(12), a.ngay_ct, 103) as ngay_ct,
convert(varchar(32), a.datetime2, 121) as datetime2,
case @l when 'v' then d.ten_kh else d.ten_kh2 end as ten_kh, dien_giai, b.dien_thoai, b.e_mail, b.d_language,
    upper(ma_nhan) as ma_nhan, upper(ma_huy) as ma_huy, m.smsg, m.msg0, m.msg1, m.msg2, m.msg3, m.msg4, m.msg5, m.msg6, m.msg7, m.msg8, m.msg9
  from @@table a, @@sysDatabaseName..userinfo2 b, dmxn c, dmkh d, #msg m
  where a.stt_rec = @@stt_rec and b.id = @id and a.stt_rec = c.stt_rec and a.ma_kh = d.ma_kh and b.id = c.user_id
]]>
            </text>
          </command>

          <command id="footer">
            <text>
              <![CDATA[
declare @amountFormat varchar(32), @ma_nt varchar(32)
declare @t table(field varchar(32), format varchar(128))
select @ma_nt = ma_nt from @@table where stt_rec = @@stt_rec

if exists(select 1 from options where name = 'm_ma_nt0' and rtrim(val) = @ma_nt) select @amountFormat = rtrim(val) from options where name = 'm_ip_tien'
else select @amountFormat = rtrim(val) from options where name = 'm_ip_tien_nt'

insert into @t select 't_tien_nt', @amountFormat
insert into @t select 't_cp_nt', @amountFormat
insert into @t select 't_nk_nt', @amountFormat
insert into @t select 't_ttdb_nt', @amountFormat
insert into @t select 't_thue_nt', @amountFormat
insert into @t select 't_tt_nt', @amountFormat

select cast(t_tien_nt as varchar) as t_tien_nt, cast(t_cp_nt as varchar) as t_cp_nt,
    cast(t_nk_nt as varchar) as t_nk_nt, cast(t_ttdb_nt as varchar) as t_ttdb_nt,
    cast(t_thue_nt as varchar) as t_thue_nt, cast(t_tt_nt as varchar) as t_tt_nt
  from @@table where stt_rec = @@stt_rec

select * from @t
]]>
            </text>
          </command>
        </query>

        <body>
          <header>
            <text>
              <![CDATA[
<html>]]>&CssClass;<![CDATA[
<body><div style="padding:8px">
<div style="text-align:left;padding-bottom:8px;font-size:12px;font-weight:600;" class="ts">{!h_title}</div>
<table class="ts" border="0" cellpadding="1" cellspacing="1">
<tr class="h"><td style="width:120px;text-align:left;white-space:nowrap;">{!h_so_ct}</td><td class="r4">{!so_ct}</td></tr>
<tr class="h"><td style="width:120px;text-align:left;white-space:nowrap;">{!h_ngay_ct}</td><td class="r4">{!ngay_ct}</td></tr>
<tr class="h"><td style="width:120px;text-align:left;white-space:nowrap;">{!h_nha_cc}</td><td class="r4">{!ten_kh}</td></tr>
<tr class="h"><td style="width:120px;text-align:left;white-space:nowrap;">{!h_dien_giai}</td><td class="r9">{!dien_giai}</td></tr>
</table><br/>
<table class="ts detail" border="1" cellspacing="2" cellpadding="4">
]]>
            </text>
          </header>

          <footer>
            <text>
              <![CDATA[
<tr class="h"><td style="width:115px;text-align: right;">{!h_t_tien}</td><td class="r3">{!t_tien_nt}</td></tr>
<tr class="h"><td style="width:115px;text-align: right;">{!h_t_cp}</td><td class="r3">{!t_cp_nt}</td></tr>
<tr class="h"><td style="width:115px;text-align: right;">{!h_t_nk}</td><td class="r3">{!t_nk_nt}</td></tr>
<tr class="h"><td style="width:115px;text-align: right;">{!h_t_ttdb}</td><td class="r3">{!t_ttdb_nt}</td></tr>
<tr class="h"><td style="width:115px;text-align: right;">{!h_t_gtgt}</td><td class="r3">{!t_thue_nt}</td></tr>
<tr class="h"><td style="width:115px;text-align: right;">{!h_t_tt}</td><td class="r3">{!t_tt_nt}</td></tr>
</table>

<div style="padding-top:4px;display:{!smsg};" class="info r9">{!msg0}{!msg1}{!msg2}{!msg3}{!msg4}{!msg5}{!msg6}{!msg7}{!msg8}{!msg9}</div><br />
</body></html>
]]>&Comment;
            </text>
          </footer>
        </body>

      </action>

      <action id="DomesticPurchaseOrder" table="m94$000000" v="Đơn hàng mua trong nước chờ duyệt" e="Domestic purchase order waiting for approval">
        <fields>
          <field name="h_title">
            <header v="Đơn hàng mua trong nước chờ duyệt" e="Domestic purchase order waiting for approval"/>
          </field>
          <field name="h_so_ct">
            <header v="Số đơn hàng" e="Number"/>
          </field>
          <field name="h_ngay_ct">
            <header v="Ngày" e="Date"/>
          </field>
          <field name="h_nha_cc">
            <header v="Nhà cung cấp" e="Supplier"/>
          </field>
          <field name="h_dien_giai">
            <header v="Diễn giải" e="Memo"/>
          </field>
          <field name="h_t_tien">
            <header v="Tiền hàng" e="Amount"/>
          </field>
          <field name="h_t_thue">
            <header v="Thuế" e="Tax Amount"/>
          </field>
          <field name="h_t_tt">
            <header v="Tổng cộng" e="Total Amount"/>
          </field>
          <field name="h_ghi_chu">
            <header v="Lý do:" e="Comment:"/>
          </field>
        </fields>

        <query id="report">
          <command id="master">
            <text>
              <![CDATA[
declare @id int, @l varchar(8)
select @id = @@contactID
select @l = d_language from @@sysDatabaseName..userinfo2 where id = @id

create table #msg (smsg varchar(10), msg0 nvarchar(4000), msg1 nvarchar(4000), msg2 nvarchar(4000), msg3 nvarchar(4000), msg4 nvarchar(4000), msg5 nvarchar(4000), msg6 nvarchar(4000), msg7 nvarchar(4000), msg8 nvarchar(4000), msg9 nvarchar(4000))
insert into #msg exec AI_ERP$App$GetApprovalDetail @@stt_rec, '01220', 'PO1', @l, 1, 1

select ltrim(so_ct) as so_ct, ma_nt, convert(varchar(12), a.ngay_ct, 103) as ngay_ct,
    convert(varchar(32), a.datetime2, 121) as datetime2, case @l when 'v' then d.ten_kh else d.ten_kh2 end as ten_kh,
    dien_giai, b.dien_thoai, b.e_mail, b.d_language, upper(ma_nhan) as ma_nhan, upper(ma_huy) as ma_huy, m.smsg, m.msg0, m.msg1, m.msg2, m.msg3, m.msg4, m.msg5, m.msg6, m.msg7, m.msg8, m.msg9
  from @@table a, @@sysDatabaseName..userinfo2 b, dmxn c, dmkh d, #msg m
  where a.stt_rec = @@stt_rec and b.id = @id and a.stt_rec = c.stt_rec and a.ma_kh = d.ma_kh and b.id = c.user_id
]]>
            </text>
          </command>

          <command id="footer">
            <text>
              <![CDATA[
declare @amountFormat varchar(32), @ma_nt varchar(32)
declare @t table(field varchar(32), format varchar(128))
select @ma_nt = ma_nt from @@table where stt_rec = @@stt_rec

if exists(select 1 from options where name = 'm_ma_nt0' and rtrim(val) = @ma_nt) select @amountFormat = rtrim(val) from options where name = 'm_ip_tien'
else select @amountFormat = rtrim(val) from options where name = 'm_ip_tien_nt'

insert into @t select 't_tien_nt', @amountFormat
insert into @t select 't_thue_nt', @amountFormat
insert into @t select 't_tt_nt', @amountFormat

select cast(t_tien_nt as varchar) as t_tien_nt,
cast(t_thue_nt as varchar) as t_thue_nt,
cast(t_tt_nt as varchar) as t_tt_nt
from @@table where stt_rec = @@stt_rec

select * from @t
]]>
            </text>
          </command>
        </query>

        <body>
          <header>
            <text>
              <![CDATA[
<html>]]>&CssClass;<![CDATA[
<body><div style="padding:8px">
<div style="text-align:left;padding-bottom:8px;font-size:12px;font-weight:600;" class="ts">{!h_title}</div>
<table class="ts" border="0" cellpadding="1" cellspacing="1">
<tr class="h"><td style="width:120px;text-align:left;white-space:nowrap;">{!h_so_ct}</td><td class="r4">{!so_ct}</td></tr>
<tr class="h"><td style="width:120px;text-align:left;white-space:nowrap;">{!h_ngay_ct}</td><td class="r4">{!ngay_ct}</td></tr>
<tr class="h"><td style="width:120px;text-align:left;white-space:nowrap;">{!h_nha_cc}</td><td class="r4">{!ten_kh}</td></tr>
<tr class="h"><td style="width:120px;text-align:left;white-space:nowrap;">{!h_dien_giai}</td><td class="r9">{!dien_giai}</td></tr>
</table><br/>
<table class="ts detail" border="1" cellspacing="2" cellpadding="4">
]]>
            </text>
          </header>

          <footer>
            <text>
              <![CDATA[
<tr class="h"><td style="width:115px;text-align: right;">{!h_t_tien}</td><td class="r3">{!t_tien_nt}</td></tr>
<tr class="h"><td style="width:115px;text-align: right;">{!h_t_thue}</td><td class="r3">{!t_thue_nt}</td></tr>
<tr class="h"><td style="width:115px;text-align: right;">{!h_t_tt}</td><td class="r3">{!t_tt_nt}</td></tr>
</table>

<div style="padding-top:4px;display:{!smsg};" class="info r9">{!msg0}{!msg1}{!msg2}{!msg3}{!msg4}{!msg5}{!msg6}{!msg7}{!msg8}{!msg9}</div><br />
</body></html>
]]>&Comment;
            </text>
          </footer>
        </body>

      </action>

      <action id="SOApproval" table="m64$000000" v="Đơn hàng bán chờ duyệt" e="Sales order waiting for approval">
        <fields>
          <field name="h_title">
            <header v="Đơn hàng bán chờ duyệt" e="Sales order waiting for approval"/>
          </field>
          <field name="h_so_ct">
            <header v="Số đơn hàng" e="Number"/>
          </field>
          <field name="h_ngay_ct">
            <header v="Ngày" e="Date"/>
          </field>
          <field name="h_khach_hang">
            <header v="Khách hàng" e="Customer"/>
          </field>
          <field name="h_dien_giai">
            <header v="Diễn giải" e="Memo"/>
          </field>

          <field name="h_t_tien">
            <header v="Tiền hàng" e="Amount"/>
          </field>
          <field name="h_t_thue">
            <header v="Thuế" e="Tax Amount"/>
          </field>
          <field name="h_t_tt">
            <header v="Tổng cộng" e="Total Amount"/>
          </field>
          <field name="h_ghi_chu">
            <header v="Lý do:" e="Comment:"/>
          </field>

        </fields>

        <query id="report">
          <command id="master">
            <text>
              <![CDATA[
declare @id int, @l varchar(8)
select @id = @@contactID
select @l = d_language from @@sysDatabaseName..userinfo2 where id = @id

create table #msg (smsg varchar(10), msg0 nvarchar(4000), msg1 nvarchar(4000), msg2 nvarchar(4000), msg3 nvarchar(4000), msg4 nvarchar(4000), msg5 nvarchar(4000), msg6 nvarchar(4000), msg7 nvarchar(4000), msg8 nvarchar(4000), msg9 nvarchar(4000))
insert into #msg exec AI_ERP$APV$SO$GetApprovalDetail @@stt_rec, '00915', @l, 1, 1

select ltrim(so_ct) as so_ct, ma_nt, convert(varchar(12), a.ngay_ct, 103) as ngay_ct,
    convert(varchar(32), a.datetime2, 121) as datetime2, case @l when 'v' then d.ten_kh else d.ten_kh2 end as ten_kh,
    dien_giai, b.dien_thoai, b.e_mail, b.d_language, upper(ma_nhan) as ma_nhan, upper(ma_huy) as ma_huy, m.smsg, m.msg0, m.msg1, m.msg2, m.msg3, m.msg4, m.msg5, m.msg6, m.msg7, m.msg8, m.msg9
  from @@table a, @@sysDatabaseName..userinfo2 b, dmxn c, dmkh d, #msg m
  where a.stt_rec = @@stt_rec and b.id = @id and a.stt_rec = c.stt_rec and a.ma_kh = d.ma_kh and b.id = c.user_id
]]>
            </text>
          </command>

          <command id="footer">
            <text>
              <![CDATA[
declare @amountFormat varchar(32), @ma_nt varchar(32)
declare @t table(field varchar(32), format varchar(128))
select @ma_nt = ma_nt from @@table where stt_rec = @@stt_rec

if exists(select 1 from options where name = 'm_ma_nt0' and rtrim(val) = @ma_nt) select @amountFormat = rtrim(val) from options where name = 'm_ip_tien'
else select @amountFormat = rtrim(val) from options where name = 'm_ip_tien_nt'

insert into @t select 't_tien_nt', @amountFormat
insert into @t select 't_thue_nt', @amountFormat
insert into @t select 't_tt_nt', @amountFormat

select cast(t_tien_nt2 as varchar) as t_tien_nt,
cast(t_thue_nt as varchar) as t_thue_nt,
cast(t_tt_nt as varchar) as t_tt_nt
from @@table where stt_rec = @@stt_rec

select * from @t
]]>
            </text>
          </command>

        </query>

        <body>
          <header>
            <text>
              <![CDATA[
<html>]]>&CssClass;<![CDATA[
<body><div style="padding:8px">
<div style="text-align:left;padding-bottom:8px;font-size:12px;font-weight:700;color:#444;" class="ts">{!h_title}</div>
<table class="ts" border="0" cellpadding="1" cellspacing="1">
<tr class="h"><td style="width:120px;text-align:left;white-space:nowrap;">{!h_so_ct}</td><td class="r4">{!so_ct}</td></tr>
<tr class="h"><td style="width:120px;text-align:left;white-space:nowrap;">{!h_ngay_ct}</td><td class="r4">{!ngay_ct}</td></tr>
<tr class="h"><td style="width:120px;text-align:left;white-space:nowrap;">{!h_khach_hang}</td><td class="r4">{!ten_kh}</td></tr>
<tr class="h"><td style="width:120px;text-align:left;white-space:nowrap;">{!h_dien_giai}</td><td class="r9">{!dien_giai}</td></tr>
</table><br/>
<table class="ts detail" border="1" cellspacing="2" cellpadding="4">
]]>
            </text>
          </header>

          <footer>
            <text>
              <![CDATA[
<tr class="h"><td style="width:115px;text-align: right;">{!h_t_tien}</td><td class="r3">{!t_tien_nt}</td></tr>
<tr class="h"><td style="width:115px;text-align: right;">{!h_t_thue}</td><td class="r3">{!t_thue_nt}</td></tr>
<tr class="h"><td style="width:115px;text-align: right;">{!h_t_tt}</td><td class="r3">{!t_tt_nt}</td></tr>
</table>

<div style="padding-top:4px;display:{!smsg};" class="info r9">{!msg0}{!msg1}{!msg2}{!msg3}{!msg4}{!msg5}{!msg6}{!msg7}{!msg8}{!msg9}</div><br />
</body></html>
]]>&Comment;
            </text>
          </footer>
        </body>

      </action>

      <action id="DCApproval" table="m52$000000" v="Đề nghị chi tiền chờ duyệt" e="Supplier Payment Request waiting for approval">
        <fields>
          <field name="h_title">
            <header v="Đề nghị chi tiền chờ duyệt" e="Supplier Payment Request waiting for approval"/>
          </field>
          <field name="h_so_ct">
            <header v="Số chứng từ" e="Number"/>
          </field>
          <field name="h_ngay_ct">
            <header v="Ngày" e="Date"/>
          </field>
          <field name="h_ma_kh">
            <header v="Khách hàng" e="Customer"/>
          </field>
          <field name="h_ly_do">
            <header v="Lý do thanh toán" e="Memo"/>
          </field>
          <field name="h_t_tien">
            <header v="Tiền" e="Amount"/>
          </field>
          <field name="h_t_thue">
            <header v="Thuế" e="Tax Amount"/>
          </field>
          <field name="h_t_tt">
            <header v="Tổng thanh toán" e="Total"/>
          </field>
          <field name="h_ghi_chu">
            <header v="Lý do:" e="Comment:"/>
          </field>
        </fields>

        <query id="report">
          <command id="master">
            <text>
              <![CDATA[
declare @id int, @l varchar(8)
select @id = @@contactID
select @l = d_language from @@sysDatabaseName..userinfo2 where id = @id

create table #msg (smsg varchar(10), msg0 nvarchar(4000), msg1 nvarchar(4000), msg2 nvarchar(4000), msg3 nvarchar(4000), msg4 nvarchar(4000), msg5 nvarchar(4000), msg6 nvarchar(4000), msg7 nvarchar(4000), msg8 nvarchar(4000), msg9 nvarchar(4000))
insert into #msg exec AI_ERP$APV$GetApprovalDetail @@stt_rec, '00630', @l, 1, 1

select case when loai_ct = '1' then 'body2' else 'body' end as bodyID, ltrim(so_ct) as so_ct, ma_nt, convert(varchar(12), a.ngay_ct, 103) as ngay_ct,
    convert(varchar(32), a.datetime2, 121) as datetime2, case @l when 'v' then d.ten_kh else d.ten_kh2 end as ten_kh,
    dien_giai, b.dien_thoai, b.e_mail, b.d_language, upper(ma_nhan) as ma_nhan, upper(ma_huy) as ma_huy, m.smsg, m.msg0, m.msg1, m.msg2, m.msg3, m.msg4, m.msg5, m.msg6, m.msg7, m.msg8, m.msg9
  from @@table a, @@sysDatabaseName..userinfo2 b, dmxn c, dmkh d, #msg m
  where a.stt_rec = @@stt_rec and b.id = @id and a.stt_rec = c.stt_rec and a.ma_kh = d.ma_kh and b.id = c.user_id
]]>
            </text>
          </command>

          <command id="footer">
            <text>
              <![CDATA[
declare @amountFormat varchar(32), @ma_nt varchar(32)
declare @t table(field varchar(32), format varchar(128))
select @ma_nt = ma_nt from @@table where stt_rec = @@stt_rec

if exists(select 1 from options where name = 'm_ma_nt0' and rtrim(val) = @ma_nt) select @amountFormat = rtrim(val) from options where name = 'm_ip_tien'
else select @amountFormat = rtrim(val) from options where name = 'm_ip_tien_nt'

insert into @t select 't_tien_nt', @amountFormat
insert into @t select 't_thue_nt', @amountFormat
insert into @t select 't_tt_nt', @amountFormat

select cast(t_tien_nt as varchar) as t_tien_nt,
cast(t_thue_nt as varchar) as t_thue_nt,
cast(t_tt_nt as varchar) as t_tt_nt
from @@table where stt_rec = @@stt_rec

select * from @t
]]>
            </text>
          </command>
        </query>

        <body>
          <header>
            <text>
              <![CDATA[
<html>]]>&CssClass;<![CDATA[
<body><div style="padding:8px">
<div style="text-align:left;padding-bottom:8px;font-size:12px;font-weight:600;" class="ts">{!h_title}</div>
<table class="ts" border="0" cellpadding="1" cellspacing="1">
<tr class="h"><td style="width:120px;text-align:left;white-space:nowrap;">{!h_so_ct}</td><td class="r4">{!so_ct}</td></tr>
<tr class="h"><td style="width:120px;text-align:left;white-space:nowrap;">{!h_ngay_ct}</td><td class="r4">{!ngay_ct}</td></tr>
<tr class="h"><td style="width:120px;text-align:left;white-space:nowrap;">{!h_ma_kh}</td><td class="r4">{!ten_kh}</td></tr>
<tr class="h"><td style="width:120px;text-align:left;white-space:nowrap;">{!h_ly_do}</td><td class="r9">{!dien_giai}</td></tr>
</table><br/>
<table class="ts detail" border="1" cellspacing="2" cellpadding="4">
]]>
            </text>
          </header>

          <footer>
            <text>
              <![CDATA[
<tr class="h"><td colspan="3" style="width:115px;text-align: right;">{!h_t_tien}</td><td class="r3">{!t_tien_nt}</td></tr>
<tr class="h"><td colspan="3" style="width:115px;text-align: right;">{!h_t_thue}</td><td class="r3">{!t_thue_nt}</td></tr>
<tr class="h"><td colspan="3" style="width:115px;text-align: right;">{!h_t_tt}</td><td class="r3">{!t_tt_nt}</td></tr>
</table>

<div style="padding-top:4px;display:{!smsg};" class="info r9">{!msg0}{!msg1}{!msg2}{!msg3}{!msg4}{!msg5}{!msg6}{!msg7}{!msg8}{!msg9}</div><br />
</body></html>
]]>&Comment;
            </text>
          </footer>
        </body>
        <body2>
          <header>
            <text>
              <![CDATA[
<html>]]>&CssClass;<![CDATA[
<body><div style="padding:8px">
<div style="text-align:left;padding-bottom:8px;font-size:12px;font-weight:600;" class="ts">{!h_title}</div>
<table class="ts" border="0" cellpadding="1" cellspacing="1">
<tr class="h"><td style="width:120px;text-align:left;white-space:nowrap;">{!h_so_ct}</td><td class="r4">{!so_ct}</td></tr>
<tr class="h"><td style="width:120px;text-align:left;white-space:nowrap;">{!h_ngay_ct}</td><td class="r4">{!ngay_ct}</td></tr>
<tr class="h"><td style="width:120px;text-align:left;white-space:nowrap;">{!h_ma_kh}</td><td class="r4">{!ten_kh}</td></tr>
<tr class="h"><td style="width:120px;text-align:left;white-space:nowrap;">{!h_ly_do}</td><td class="r9">{!dien_giai}</td></tr>
</table><br/>
<table class="ts detail" border="1" cellspacing="2" cellpadding="4">
]]>
            </text>
          </header>

          <footer>
            <text>
              <![CDATA[
<tr class="h"><td colspan="6" style="width:115px;text-align: right;">{!h_t_tien}</td><td class="r3">{!t_tien_nt}</td></tr>
<tr class="h"><td colspan="6" style="width:115px;text-align: right;">{!h_t_thue}</td><td class="r3">{!t_thue_nt}</td></tr>
<tr class="h"><td colspan="6" style="width:115px;text-align: right;">{!h_t_tt}</td><td class="r3">{!t_tt_nt}</td></tr>
</table>

<div style="padding-top:4px;display:{!smsg};" class="info r9">{!msg0}{!msg1}{!msg2}{!msg3}{!msg4}{!msg5}{!msg6}{!msg7}{!msg8}{!msg9}</div><br />
</body></html>
]]>&Comment;
            </text>
          </footer>
        </body2>

      </action>

      <action id="DTApproval" table="m57$000000" v="Đề nghị thu tiền chờ duyệt" e="Customer Payment Request waiting for approval">
        <fields>
          <field name="h_title">
            <header v="Đề nghị thu tiền chờ duyệt" e="Customer Payment Request waiting for approval"/>
          </field>
          <field name="h_so_ct">
            <header v="Số chứng từ" e="Number"/>
          </field>
          <field name="h_ngay_ct">
            <header v="Ngày" e="Date"/>
          </field>
          <field name="h_ma_kh">
            <header v="Khách hàng" e="Customer"/>
          </field>
          <field name="h_ly_do">
            <header v="Lý do thanh toán" e="Memo"/>
          </field>
          <field name="h_t_tien">
            <header v="Tiền" e="Amount"/>
          </field>
          <field name="h_t_thue">
            <header v="Thuế" e="Tax Amount"/>
          </field>
          <field name="h_t_tt">
            <header v="Tổng thanh toán" e="Total"/>
          </field>
          <field name="h_ghi_chu">
            <header v="Lý do:" e="Comment:"/>
          </field>
        </fields>

        <query id="report">
          <command id="master">
            <text>
              <![CDATA[
declare @id int, @l varchar(8)
select @id = @@contactID
select @l = d_language from @@sysDatabaseName..userinfo2 where id = @id

create table #msg (smsg varchar(10), msg0 nvarchar(4000), msg1 nvarchar(4000), msg2 nvarchar(4000), msg3 nvarchar(4000), msg4 nvarchar(4000), msg5 nvarchar(4000), msg6 nvarchar(4000), msg7 nvarchar(4000), msg8 nvarchar(4000), msg9 nvarchar(4000))
insert into #msg exec AI_ERP$APV$GetApprovalDetail @@stt_rec, '00625', @l, 1, 1

select case when loai_ct = '1' then 'body2' else 'body' end as bodyID, ltrim(so_ct) as so_ct, ma_nt, convert(varchar(12), a.ngay_ct, 103) as ngay_ct,
    convert(varchar(32), a.datetime2, 121) as datetime2, case @l when 'v' then d.ten_kh else d.ten_kh2 end as ten_kh,
    dien_giai, b.dien_thoai, b.e_mail, b.d_language, upper(ma_nhan) as ma_nhan, upper(ma_huy) as ma_huy, m.smsg, m.msg0, m.msg1, m.msg2, m.msg3, m.msg4, m.msg5, m.msg6, m.msg7, m.msg8, m.msg9
  from @@table a, @@sysDatabaseName..userinfo2 b, dmxn c, dmkh d, #msg m
  where a.stt_rec = @@stt_rec and b.id = @id and a.stt_rec = c.stt_rec and a.ma_kh = d.ma_kh and b.id = c.user_id
]]>
            </text>
          </command>

          <command id="footer">
            <text>
              <![CDATA[
declare @amountFormat varchar(32), @ma_nt varchar(32)
declare @t table(field varchar(32), format varchar(128))
select @ma_nt = ma_nt from @@table where stt_rec = @@stt_rec

if exists(select 1 from options where name = 'm_ma_nt0' and rtrim(val) = @ma_nt) select @amountFormat = rtrim(val) from options where name = 'm_ip_tien'
else select @amountFormat = rtrim(val) from options where name = 'm_ip_tien_nt'

insert into @t select 't_tt_nt', @amountFormat

select cast(t_tien_nt as varchar) as t_tt_nt from @@table where stt_rec = @@stt_rec

select * from @t
]]>
            </text>
          </command>
        </query>

        <body>
          <header>
            <text>
              <![CDATA[
<html>]]>&CssClass;<![CDATA[
<body><div style="padding:8px">
<div style="text-align:left;padding-bottom:8px;font-size:12px;font-weight:600;" class="ts">{!h_title}</div>
<table class="ts" border="0" cellpadding="1" cellspacing="1">
<tr class="h"><td style="width:120px;text-align:left;white-space:nowrap;">{!h_so_ct}</td><td class="r4">{!so_ct}</td></tr>
<tr class="h"><td style="width:120px;text-align:left;white-space:nowrap;">{!h_ngay_ct}</td><td class="r4">{!ngay_ct}</td></tr>
<tr class="h"><td style="width:120px;text-align:left;white-space:nowrap;">{!h_ma_kh}</td><td class="r4">{!ten_kh}</td></tr>
<tr class="h"><td style="width:120px;text-align:left;white-space:nowrap;">{!h_ly_do}</td><td class="r9">{!dien_giai}</td></tr>
</table><br/>
<table class="ts detail" border="1" cellspacing="2" cellpadding="4">
]]>
            </text>
          </header>

          <footer>
            <text>
              <![CDATA[
<tr class="h"><td colspan="3" style="width:115px;text-align: right;">{!h_t_tien}</td><td class="r3">{!t_tt_nt}</td></tr>
</table>

<div style="padding-top:4px;display:{!smsg};" class="info r9">{!msg0}{!msg1}{!msg2}{!msg3}{!msg4}{!msg5}{!msg6}{!msg7}{!msg8}{!msg9}</div><br />
</body></html>
]]>&Comment;
            </text>
          </footer>
        </body>
        <body2>
          <header>
            <text>
              <![CDATA[
<html>]]>&CssClass;<![CDATA[
<body><div style="padding:8px">
<div style="text-align:left;padding-bottom:8px;font-size:12px;font-weight:600;" class="ts">{!h_title}</div>
<table class="ts" border="0" cellpadding="1" cellspacing="1">
<tr class="h"><td style="width:120px;text-align:left;white-space:nowrap;">{!h_so_ct}</td><td class="r4">{!so_ct}</td></tr>
<tr class="h"><td style="width:120px;text-align:left;white-space:nowrap;">{!h_ngay_ct}</td><td class="r4">{!ngay_ct}</td></tr>
<tr class="h"><td style="width:120px;text-align:left;white-space:nowrap;">{!h_ma_kh}</td><td class="r4">{!ten_kh}</td></tr>
<tr class="h"><td style="width:120px;text-align:left;white-space:nowrap;">{!h_ly_do}</td><td class="r9">{!dien_giai}</td></tr>
</table><br/>
<table class="ts detail" border="1" cellspacing="2" cellpadding="4">
]]>
            </text>
          </header>

          <footer>
            <text>
              <![CDATA[
<tr class="h"><td colspan="6" style="width:115px;text-align: right;">{!h_t_tien}</td><td class="r3">{!t_tt_nt}</td></tr>
</table>

<div style="padding-top:4px;display:{!smsg};" class="info r9">{!msg0}{!msg1}{!msg2}{!msg3}{!msg4}{!msg5}{!msg6}{!msg7}{!msg8}{!msg9}</div><br />
</body></html>
]]>&Comment;
            </text>
          </footer>
        </body2>

      </action>

      <action id="MRApproval" table="m87$000000" v="Phiếu yêu cầu lĩnh vật tư chờ duyệt" e="Material Requisition waiting for approval">
        <fields>
          <field name="h_title">
            <header v="Phiếu yêu cầu lĩnh vật tư chờ duyệt" e="Material Requisition waiting for approval"/>
          </field>
          <field name="h_so_ct">
            <header v="Số phiếu" e="Number"/>
          </field>
          <field name="h_ngay_ct">
            <header v="Ngày" e="Date"/>
          </field>
          <field name="h_dien_giai">
            <header v="Diễn giải" e="Memo"/>
          </field>
          <field name="h_t_so_luong">
            <header v="Tổng số lượng" e="Total Quantity"/>
          </field>
          <field name="h_ghi_chu">
            <header v="Lý do:" e="Comment:"/>
          </field>
        </fields>

        <query id="report">
          <command id="master">
            <text>
              <![CDATA[
declare @l char(1)
select @l = d_language from @@sysDatabaseName..userinfo2 where id = @@contactID
create table #msg (smsg varchar(10), msg0 nvarchar(4000), msg1 nvarchar(4000), msg2 nvarchar(4000), msg3 nvarchar(4000), msg4 nvarchar(4000), msg5 nvarchar(4000), msg6 nvarchar(4000), msg7 nvarchar(4000), msg8 nvarchar(4000), msg9 nvarchar(4000))
insert into #msg exec AI_ERP$APV$GetApprovalDetail @@stt_rec, '01510', @l, 1, 1

select ltrim(so_ct) as so_ct, ma_nt, convert(varchar(12), b.ngay_ct, 103) as ngay_ct,
    convert(varchar(32), b.datetime2, 121) as datetime2, dien_giai, dien_thoai, e_mail, d_language,
    upper(ma_nhan) as ma_nhan, upper(ma_huy) as ma_huy, m.smsg, m.msg0, m.msg1, m.msg2, m.msg3, m.msg4, m.msg5, m.msg6, m.msg7, m.msg8, m.msg9
  from @@sysDatabaseName..userinfo2 a, @@table b, dmxn c, #msg m
  where a.id = @@contactID and b.stt_rec = @@stt_rec and b.stt_rec = c.stt_rec and a.id = c.user_id
]]>
            </text>
          </command>

          <command id="footer">
            <text>
              <![CDATA[
declare @amountFormat varchar(32)
declare @t table(field varchar(32), format varchar(128))

insert into @t select 't_tt_nt', rtrim(val) from options where name = 'm_ip_sl'

select cast(t_so_luong as varchar) as t_tt_nt from @@table where stt_rec = @@stt_rec
select * from @t
]]>
            </text>
          </command>
        </query>

        <body>
          <header>
            <text>
              <![CDATA[
<html>]]>&CssClass;<![CDATA[
<body><div style="padding:8px">
<div style="text-align:left;padding-bottom:8px;font-size:12px;font-weight:600;" class="ts">{!h_title}</div>
<table class="ts" border="0" cellpadding="1" cellspacing="1">
<tr class="h"><td style="width:120px;text-align:left;white-space:nowrap;">{!h_so_ct}</td><td class="r4">{!so_ct}</td></tr>
<tr class="h"><td style="width:120px;text-align:left;white-space:nowrap;">{!h_ngay_ct}</td><td class="r4">{!ngay_ct}</td></tr>
<tr class="h"><td style="width:120px;text-align:left;white-space:nowrap;">{!h_dien_giai}</td><td class="r9">{!dien_giai}</td></tr>
</table><br/>
<table class="ts detail" border="1" cellspacing="2" cellpadding="4">
]]>
            </text>
          </header>

          <footer>
            <text>
              <![CDATA[
<tr class="h"><td colspan="3" style="width:115px;text-align: right;">{!h_t_so_luong}</td><td class="r3">{!t_tt_nt}</td></tr>
</table>

<div style="padding-top:4px;display:{!smsg};" class="info r9">{!msg0}{!msg1}{!msg2}{!msg3}{!msg4}{!msg5}{!msg6}{!msg7}{!msg8}{!msg9}</div><br />
</body></html>
]]>&Comment;
            </text>
          </footer>
        </body>

      </action>

      <action id="S2Approval" table="ms2$000000" v="Yêu cầu sản xuất chờ duyệt" e="Work Order waiting for approval">
        <fields>
          <field name="h_title">
            <header v="Yêu cầu sản xuất chờ duyệt" e="Work Order waiting for approval"/>
          </field>
          <field name="h_so_ct">
            <header v="Yêu cầu" e="Work Order"/>
          </field>
          <field name="h_ngay_ct">
            <header v="Ngày" e="Date"/>
          </field>

          <field name="h_so_lsx">
            <header v="Lệnh sản xuất" e="MO"/>
          </field>
          <field name="h_ma_sp">
            <header v="Sản phẩm" e="Product"/>
          </field>
          <field name="h_ma_ca">
            <header v="Ca" e="Working Shift"/>
          </field>
          <field name="h_ngay_bd">
            <header v="Ngày bắt đầu" e="Start Date"/>
          </field>

          <field name="h_sl_yc">
            <header v="Sl yêu cầu" e="Work Order Q'ty"/>
          </field>
          <field name="h_dien_giai">
            <header v="Diễn giải" e="Memo"/>
          </field>
          <field name="h_ghi_chu">
            <header v="Lý do:" e="Comment:"/>
          </field>
        </fields>

        <query id="report">
          <command id="master">
            <text>
              <![CDATA[
declare @l char(1)
select @l = d_language from @@sysDatabaseName..userinfo2 where id = @@contactID
create table #msg (smsg varchar(10), msg0 nvarchar(4000), msg1 nvarchar(4000), msg2 nvarchar(4000), msg3 nvarchar(4000), msg4 nvarchar(4000), msg5 nvarchar(4000), msg6 nvarchar(4000), msg7 nvarchar(4000), msg8 nvarchar(4000), msg9 nvarchar(4000))
insert into #msg exec AI_ERP$APV$GetApprovalDetail @@stt_rec, '01520', @l, 1, 1

declare @format varchar(128)
select @format = rtrim(val) from options where name = 'm_ip_sl'

select ma_lsx, convert(varchar(12), b.ngay_ct, 103) as ngay_ct, convert(varchar(32), b.datetime2, 121) as datetime2, dbo.ff_NumberFormat(sl_yc, @format) as sl_yc, b.dien_giai, dien_thoai, e_mail, d_language,
    upper(ma_nhan) as ma_nhan, upper(ma_huy) as ma_huy, m.smsg, m.msg0, m.msg1, m.msg2, m.msg3, m.msg4, m.msg5, m.msg6, m.msg7, m.msg8, m.msg9
  , x.dien_giai as so_lsx, v.ten_vt, v.ten_vt2, b.ma_ca
  from @@sysDatabaseName..userinfo2 a, @@table b, dmxn c, #msg m, phsx x, dmvt v
  where a.id = @@contactID and b.stt_rec = @@stt_rec and b.stt_rec = c.stt_rec and a.id = c.user_id and b.stt_rec_lsx = x.stt_rec and b.ma_sp = v.ma_vt
]]>
            </text>
          </command>

          <command id="footer">
            <text>
              <![CDATA[
select 't_tt_nt' as field, '' as format
]]>
            </text>
          </command>
        </query>

        <body>
          <header>
            <text>
              <![CDATA[
<html>]]>&CssClass;<![CDATA[
<body><div style="padding:8px">
<div style="text-align:left;padding-bottom:8px;font-size:12px;font-weight:600;" class="ts">{!h_title}</div>
<table class="ts" border="0" cellpadding="1" cellspacing="1">
<tr class="h"><td style="width:120px;text-align:left;white-space:nowrap;">{!h_so_ct}</td><td class="r4">{!ma_lsx}</td></tr>
<tr class="h"><td style="width:120px;text-align:left;white-space:nowrap;">{!h_ngay_ct}</td><td class="r4">{!ngay_ct}</td></tr>
<tr class="h"><td style="width:120px;text-align:left;white-space:nowrap;">{!h_so_lsx}</td><td class="r9">{!so_lsx}</td></tr>
<tr class="h"><td style="width:120px;text-align:left;white-space:nowrap;">{!h_ma_sp}</td><td class="r9">{!ten_vt}</td></tr>
<tr class="h"><td style="width:120px;text-align:left;white-space:nowrap;">{!h_ma_ca}</td><td class="r9">{!ma_ca}</td></tr>
<tr class="h"><td style="width:120px;text-align:left;white-space:nowrap;">{!h_sl_yc}</td><td class="r4">{!sl_yc}</td></tr>
<tr class="h"><td style="width:120px;text-align:left;white-space:nowrap;">{!h_dien_giai}</td><td class="r9">{!dien_giai}</td></tr>
</table><br/>
]]>
            </text>
          </header>

          <footer>
            <text>
              <![CDATA[
<div style="padding-top:4px;display:{!smsg};" class="info r9">{!msg0}{!msg1}{!msg2}{!msg3}{!msg4}{!msg5}{!msg6}{!msg7}{!msg8}{!msg9}</div><br />
</body></html>
]]>&Comment;
            </text>
          </footer>
        </body>

      </action>

      <action id="hrTMApproval" table="hrdtyc" v="Phiếu yêu cầu đào tạo chờ duyệt" e="Training Request waiting for approval">
        <fields>
          <field name="h_title">
            <header v="Phiếu yêu cầu đào tạo chờ duyệt" e="Training Request waiting for approval"/>
          </field>
          <field name="h_so_ct">
            <header v="Số phiếu" e="Number"/>
          </field>
          <field name="h_ngay_ct">
            <header v="Ngày" e="Date"/>
          </field>
          <field name="h_dien_giai">
            <header v="Nội dung" e="Content"/>
          </field>
          <field name="h_ghi_chu">
            <header v="Lý do:" e="Comment:"/>
          </field>
        </fields>

        <query id="report">
          <command id="master">
            <text>
              <![CDATA[
declare @l char(1)
select @l = d_language from @@sysDatabaseName..userinfo2 where id = @@contactID
create table #msg (smsg varchar(10), msg0 nvarchar(4000), msg1 nvarchar(4000), msg2 nvarchar(4000), msg3 nvarchar(4000), msg4 nvarchar(4000), msg5 nvarchar(4000), msg6 nvarchar(4000), msg7 nvarchar(4000), msg8 nvarchar(4000), msg9 nvarchar(4000))
insert into #msg exec AI_ERP$APV$GetApprovalDetail @@stt_rec, '02501', @l, 1, 1

select ltrim(so_ct) as so_ct, convert(varchar(12), b.ngay_ct, 103) as ngay_ct, convert(varchar(32), b.datetime2, 121) as datetime2, dien_giai, dien_thoai, e_mail, d_language,
    upper(ma_nhan) as ma_nhan, upper(ma_huy) as ma_huy, m.smsg, m.msg0, m.msg1, m.msg2, m.msg3, m.msg4, m.msg5, m.msg6, m.msg7, m.msg8, m.msg9
  from @@sysDatabaseName..userinfo2 a, @@table b, dmxn c, #msg m
    where a.id = @@contactID and b.stt_rec = @@stt_rec and b.stt_rec = c.stt_rec and a.id = c.user_id
]]>
            </text>
          </command>

          <command id="footer">
            <text>
              <![CDATA[
declare @amountFormat varchar(32)
declare @t table(field varchar(32), format varchar(128))

insert into @t select 't_tt_nt', rtrim(val) from options where name = 'm_ip_sl'

select * from @t
]]>
            </text>
          </command>
        </query>

        <body>
          <header>
            <text>
              <![CDATA[
<html>]]>&CssClass;<![CDATA[
<body><div style="padding:8px">
<div style="text-align:left;padding-bottom:8px;font-size:12px;font-weight:600;" class="ts">{!h_title}</div>
<table class="ts" border="0" cellpadding="1" cellspacing="1">
<tr class="h"><td style="width:120px;text-align:left;white-space:nowrap;">{!h_so_ct}</td><td class="r4">{!so_ct}</td></tr>
<tr class="h"><td style="width:120px;text-align:left;white-space:nowrap;">{!h_ngay_ct}</td><td class="r4">{!ngay_ct}</td></tr>
<tr class="h"><td style="width:120px;text-align:left;white-space:nowrap;">{!h_dien_giai}</td><td class="r9">{!dien_giai}</td></tr>
</table><br/>
]]>
            </text>
          </header>

          <footer>
            <text>
              <![CDATA[
<div style="padding-top:4px;display:{!smsg};" class="info r9">{!msg0}{!msg1}{!msg2}{!msg3}{!msg4}{!msg5}{!msg6}{!msg7}{!msg8}{!msg9}</div><br />
</body></html>
]]>&Comment;
            </text>
          </footer>
        </body>

      </action>

      <action id="hrRMApproval" table="hrrmyc" v="Phiếu yêu cầu tuyển dụng chờ duyệt" e="Recruitment Request waiting for approval">
        <fields>
          <field name="h_title">
            <header v="Phiếu yêu cầu tuyển dụng chờ duyệt" e="Recruitment Request waiting for approval"/>
          </field>
          <field name="h_so_ct">
            <header v="Số phiếu" e="Number"/>
          </field>
          <field name="h_ngay_ct">
            <header v="Ngày" e="Date"/>
          </field>
          <field name="h_dien_giai">
            <header v="Nội dung" e="Content"/>
          </field>
          <field name="h_t_so_luong">
            <header v="Tổng cộng" e="Total Quantity"/>
          </field>
          <field name="h_ghi_chu">
            <header v="Lý do:" e="Comment:"/>
          </field>
        </fields>

        <query id="report">
          <command id="master">
            <text>
              <![CDATA[
declare @l char(1)
select @l = d_language from @@sysDatabaseName..userinfo2 where id = @@contactID
create table #msg (smsg varchar(10), msg0 nvarchar(4000), msg1 nvarchar(4000), msg2 nvarchar(4000), msg3 nvarchar(4000), msg4 nvarchar(4000), msg5 nvarchar(4000), msg6 nvarchar(4000), msg7 nvarchar(4000), msg8 nvarchar(4000), msg9 nvarchar(4000))
insert into #msg exec AI_ERP$APV$GetApprovalDetail @@stt_rec, '02801', @l, 1, 1

select ltrim(so_ct) as so_ct, convert(varchar(12), b.ngay_ct, 103) as ngay_ct,
    convert(varchar(32), b.datetime2, 121) as datetime2, dien_giai, dien_thoai, e_mail, d_language,
    upper(ma_nhan) as ma_nhan, upper(ma_huy) as ma_huy, m.smsg, m.msg0, m.msg1, m.msg2, m.msg3, m.msg4, m.msg5, m.msg6, m.msg7, m.msg8, m.msg9
  from @@sysDatabaseName..userinfo2 a, @@table b, dmxn c, #msg m
  where a.id = @@contactID and b.stt_rec = @@stt_rec and b.stt_rec = c.stt_rec and a.id = c.user_id
]]>
            </text>
          </command>

          <command id="footer">
            <text>
              <![CDATA[
declare @amountFormat varchar(32)
declare @t table(field varchar(32), format varchar(128))

insert into @t select 't_tt_nt', rtrim(val) from options where name = 'm_ip_sl'

select cast(t_so_luong as varchar) as t_tt_nt from @@table where stt_rec = @@stt_rec
select * from @t
]]>
            </text>
          </command>
        </query>

        <body>
          <header>
            <text>
              <![CDATA[
<html>]]>&CssClass;<![CDATA[
<body><div style="padding:8px">
<div style="text-align:left;padding-bottom:8px;font-size:12px;font-weight:600;" class="ts">{!h_title}</div>
<table class="ts" border="0" cellpadding="1" cellspacing="1">
<tr class="h"><td style="width:120px;text-align:left;white-space:nowrap;">{!h_so_ct}</td><td class="r4">{!so_ct}</td></tr>
<tr class="h"><td style="width:120px;text-align:left;white-space:nowrap;">{!h_ngay_ct}</td><td class="r4">{!ngay_ct}</td></tr>
<tr class="h"><td style="width:120px;text-align:left;white-space:nowrap;">{!h_dien_giai}</td><td class="r9">{!dien_giai}</td></tr>
</table><br/>
<table class="ts detail" border="1" cellspacing="2" cellpadding="4">
]]>
            </text>
          </header>

          <footer>
            <text>
              <![CDATA[
<tr class="h"><td colspan="6" style="width:115px;text-align: right;">{!h_t_so_luong}</td><td class="r3">{!t_tt_nt}</td></tr>
</table>

<div style="padding-top:4px;display:{!smsg};" class="info r9">{!msg0}{!msg1}{!msg2}{!msg3}{!msg4}{!msg5}{!msg6}{!msg7}{!msg8}{!msg9}</div><br />
</body></html>
]]>&Comment;
            </text>
          </footer>
        </body>

      </action>

      <action id="hrTSRequisitionApproval" table="hrccyccp" v="Phiếu yêu cầu cấp phát công cụ, dụng cụ chờ duyệt" e="Tool &#38; Supply Requisition waiting for approval">
        <fields>
          <field name="h_title">
            <header v="Phiếu yêu cầu cấp phát công cụ, dụng cụ chờ duyệt" e="Tool &#38; Supply Requisition waiting for approval"/>
          </field>
          <field name="h_so_ct">
            <header v="Số yêu cầu" e="Number"/>
          </field>
          <field name="h_ngay_ct">
            <header v="Ngày" e="Date"/>
          </field>
          <field name="h_dien_giai">
            <header v="Diễn giải" e="Description"/>
          </field>
          <field name="h_ghi_chu">
            <header v="Lý do:" e="Comment:"/>
          </field>
        </fields>

        <query id="report">
          <command id="master">
            <text>
              <![CDATA[
declare @l char(1)
select @l = d_language from @@sysDatabaseName..userinfo2 where id = @@contactID
create table #msg (smsg varchar(10), msg0 nvarchar(4000), msg1 nvarchar(4000), msg2 nvarchar(4000), msg3 nvarchar(4000), msg4 nvarchar(4000), msg5 nvarchar(4000), msg6 nvarchar(4000), msg7 nvarchar(4000), msg8 nvarchar(4000), msg9 nvarchar(4000))
insert into #msg exec AI_ERP$APV$GetApprovalDetail @@stt_rec, '02601', @l, 1, 1

select ltrim(so_ct) as so_ct, convert(varchar(12), b.ngay_ct, 103) as ngay_ct,
    convert(varchar(32), b.datetime2, 121) as datetime2, dien_giai, dien_thoai, e_mail, d_language,
    upper(ma_nhan) as ma_nhan, upper(ma_huy) as ma_huy, m.smsg, m.msg0, m.msg1, m.msg2, m.msg3, m.msg4, m.msg5, m.msg6, m.msg7, m.msg8, m.msg9
  from @@sysDatabaseName..userinfo2 a, @@table b, dmxn c, #msg m
  where a.id = @@contactID and b.stt_rec = @@stt_rec and b.stt_rec = c.stt_rec and a.id = c.user_id
]]>
            </text>
          </command>

          <command id="footer">
            <text>
              <![CDATA[
declare @amountFormat varchar(32)
declare @t table(field varchar(32), format varchar(128))

insert into @t select 't_tt_nt', rtrim(val) from options where name = 'm_ip_sl'

select * from @t
]]>
            </text>
          </command>
        </query>

        <body>
          <header>
            <text>
              <![CDATA[
<html>]]>&CssClass;<![CDATA[
<body><div style="padding:8px">
<div style="text-align:left;padding-bottom:8px;font-size:12px;font-weight:600;" class="ts">{!h_title}</div>
<table class="ts" border="0" cellpadding="1" cellspacing="1">
<tr class="h"><td style="width:120px;text-align:left;white-space:nowrap;">{!h_so_ct}</td><td class="r4">{!so_ct}</td></tr>
<tr class="h"><td style="width:120px;text-align:left;white-space:nowrap;">{!h_ngay_ct}</td><td class="r4">{!ngay_ct}</td></tr>
<tr class="h"><td style="width:120px;text-align:left;white-space:nowrap;">{!h_dien_giai}</td><td class="r9">{!dien_giai}</td></tr>
</table><br/>
]]>
            </text>
          </header>

          <footer>
            <text>
              <![CDATA[
<div style="padding-top:4px;display:{!smsg};" class="info r9">{!msg0}{!msg1}{!msg2}{!msg3}{!msg4}{!msg5}{!msg6}{!msg7}{!msg8}{!msg9}</div><br />
</body></html>
]]>&Comment;
            </text>
          </footer>
        </body>

      </action>

      <action id="hrLIApproval" table="hrycnghi" v="Yêu cầu nghỉ, vắng mặt chờ duyệt" e="Leave or Vacation Request waiting for approval">
        <fields>
          <field name="h_title">
            <header v="Yêu cầu nghỉ, vắng mặt chờ duyệt" e="Leave or Vacation Request waiting for approval"/>
          </field>
          <field name="h_so_ngay">
            <header v="Số ngày" e="Leave Day(s)"/>
          </field>
          <field name="h_ngay_cl">
            <header v="Số dư phép trong năm" e="The annual leave balance"/>
          </field>
          <field name="h_ngay_ct1">
            <header v="Ngày từ" e="Date from"/>
          </field>
          <field name="h_ngay_ct2">
            <header v="Ngày đến" e="Date to"/>
          </field>
          <field name="h_ghi_chu">
            <header v="Lý do:" e="Comment:"/>
          </field>
        </fields>

        <query id="report">
          <command id="master">
            <text>
              <![CDATA[
declare @l char(1), @startDate smalldatetime, @dayLeft numeric(5, 2), @ma_nv varchar(32), @ten_nv nvarchar(256)
select @ma_nv = b.ma_nv, @ten_nv = b.ten, @startDate = a.ngay_tu from hrycnghi a join vhrnv b on a.stt_rec_nv = b.stt_rec where a.stt_rec = @@stt_rec
exec AI_ERP$HRM$Message$Leave '', @ma_nv, @startDate, 0, @dayLeft output, '@@sysDatabaseName'

select @l = d_language from @@sysDatabaseName..userinfo2 where id = @@contactID
create table #msg (smsg varchar(10), msg0 nvarchar(4000), msg1 nvarchar(4000), msg2 nvarchar(4000), msg3 nvarchar(4000), msg4 nvarchar(4000), msg5 nvarchar(4000), msg6 nvarchar(4000), msg7 nvarchar(4000), msg8 nvarchar(4000), msg9 nvarchar(4000))
insert into #msg exec AI_ERP$APV$GetApprovalDetail @@stt_rec, '03101', @l, 1, 1

select convert(varchar(12), b.ngay_tu, 103) as ngay_tu, convert(varchar(12), b.ngay_den, 103) as ngay_den, @ma_nv as ma_nv, @ten_nv as ten, @dayLeft as ngay_cl,
    convert(varchar(32), b.datetime2, 121) as datetime2, b.loai_nghi, b.so_ngay, b.ly_do, b.ghi_chu, a.e_mail, a.dien_thoai, a.d_language,
    upper(ma_nhan) as ma_nhan, upper(ma_huy) as ma_huy, m.smsg, m.msg0, m.msg1, m.msg2, m.msg3, m.msg4, m.msg5, m.msg6, m.msg7, m.msg8, m.msg9
  from @@sysDatabaseName..userinfo2 a, hrycnghi b, dmxn c, #msg m
  where a.id = @@contactID and b.stt_rec = @@stt_rec and b.stt_rec = c.stt_rec and a.id = c.user_id
]]>
            </text>
          </command>

          <command id="footer">
            <text>
              <![CDATA[
declare @amountFormat varchar(32)
declare @t table(field varchar(32), format varchar(128))

insert into @t select 't_tt_nt', rtrim(val) from options where name = 'm_ip_sl'

select * from @t
]]>
            </text>
          </command>
        </query>

        <body>
          <header>
            <text>
              <![CDATA[
<html>]]>&CssClass;<![CDATA[
<body><div style="padding:8px">
<div style="text-align:left;padding-bottom:8px;font-size:12px;font-weight:600;" class="ts">{!h_title}</div>
<table class="ts" border="0" cellpadding="1" cellspacing="1">
<tr class="h"><td style="width:160px;text-align:left;">{!h_nhan_vien}</td><td class="r9">{!ma_nv} - {!ten}</td></tr>
<tr class="h"><td style="width:160px;text-align:left;">{!h_ngay_ct1}</td><td class="r4">{!ngay_tu}</td></tr>
<tr class="h"><td style="width:160px;text-align:left;">{!h_ngay_ct2}</td><td class="r4">{!ngay_den}</td></tr>
<tr class="h"><td style="width:160px;text-align:left;">{!h_so_ngay}</td><td class="r4">{!so_ngay}</td></tr>
<tr class="h"><td style="width:160px;text-align:left;">{!h_ngay_cl}</td><td class="r4">{!ngay_cl}</td></tr>
<tr class="h"><td style="width:160px;text-align:left;">{!h_ghi_chu}</td><td class="r9">{!ghi_chu}</td></tr>
</table><br/>
]]>
            </text>
          </header>

          <footer>
            <text>
              <![CDATA[
<div style="padding-top:4px;display:{!smsg};" class="info r9">{!msg0}{!msg1}{!msg2}{!msg3}{!msg4}{!msg5}{!msg6}{!msg7}{!msg8}{!msg9}</div><br />
</body></html>
]]>&Comment;
            </text>
          </footer>
        </body>
      </action>

      <action id="hrPIApproval" table="dvhrnv" v="Thông tin nhân viên" e="Employee Information">
        <fields>
          <field name="h_title">
            <header v="Thông tin nhân viên" e="Employee Information"/>
          </field>
          <field name="h_ten_nv">
            <header v="Nhân viên" e="Employee"></header>
          </field>
          <field name="h_ten_bp">
            <header v="Bộ phận" e="Department"></header>
          </field>
          <field name="h_ten_vtr">
            <header v="Vị trí công việc" e="Position"/>
          </field>
          <field name="h_ghi_chu">
            <header v="Lý do:" e="Comment:"/>
          </field>
        </fields>

        <query id="report">
          <command id="master">
            <text>
              <![CDATA[
declare @l char(1)
select @l = d_language from @@sysDatabaseName..userinfo2 where id = @@contactID

create table #msg (smsg varchar(10), msg0 nvarchar(4000), msg1 nvarchar(4000), msg2 nvarchar(4000), msg3 nvarchar(4000), msg4 nvarchar(4000), msg5 nvarchar(4000), msg6 nvarchar(4000), msg7 nvarchar(4000), msg8 nvarchar(4000), msg9 nvarchar(4000))
insert into #msg exec AI_ERP$APV$GetApprovalDetail @@stt_rec, '02521', @l, 1, 1

select isnull(ten, '') as ten, case when @l = 'v' then isnull(bo_phan, '') else isnull(bo_phan2, '') end as bo_phan, case when @l = 'v' then isnull(vi_tri, '') else isnull(vi_tri2, '') end as vi_tri,
  a.d_language, a.e_mail, upper(ma_nhan) as ma_nhan, upper(ma_huy) as ma_huy, m.smsg, m.msg0, m.msg1, m.msg2, m.msg3, m.msg4, m.msg5, m.msg6, m.msg7, m.msg8, m.msg9,
  convert(varchar(32), getdate(), 121) as datetime2
from @@sysDatabaseName..userinfo2 a, vdvhrnvnew b, dmxn c, #msg m
where a.id = @@contactID and b.stt_rec = @@stt_rec and b.stt_rec = c.stt_rec and a.id = c.user_id
]]>
            </text>
          </command>

          <command id="footer">
            <text>
              <![CDATA[
select 't_so_luong' as field, '' as format
]]>
            </text>
          </command>
        </query>

        <body>
          <header>
            <text>
              <![CDATA[
<html>]]>&CssClass;<![CDATA[
<body><div style="padding:8px">
<div style="text-align:left;padding-bottom:8px;font-size:12px;font-weight:600;" class="ts">{!h_title}</div>
<table class="ts" border="0" cellpadding="1" cellspacing="1">
<tr class="h"><td style="width:160px;text-align:left;">{!h_ten_nv}</td><td class="r9">{!ten}</td></tr>
<tr class="h"><td style="width:160px;text-align:left;">{!h_ten_bp}</td><td class="r9">{!bo_phan}</td></tr>
<tr class="h"><td style="width:160px;text-align:left;">{!h_ten_vtr}</td><td class="r9">{!vi_tri}</td></tr>
</table><br/>
]]>
            </text>
          </header>

          <footer>
            <text>
              <![CDATA[
<div style="padding-top:4px;display:{!smsg};" class="info r9">{!msg0}{!msg1}{!msg2}{!msg3}{!msg4}{!msg5}{!msg6}{!msg7}{!msg8}{!msg9}</div><br />
</body></html>
]]>&Comment;
            </text>
          </footer>
        </body>
      </action>
    </template>
  </mail>

</message>