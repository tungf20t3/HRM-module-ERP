function dtmlXMLLoaderObject(n,t,i,r){return this.xmlDoc="",this.async=typeof i!="undefined"?i:!0,this.onloadAction=n||null,this.mainObject=t||null,this.waitCall=null,this.rSeed=r||!1,this}function callerFunction(n,t){return this.handler=function(i){return i||(i=window.event),n(i,t),!0},this.handler}function getAbsoluteLeft(n){return getOffset(n).left}function getAbsoluteTop(n){return getOffset(n).top}function getOffsetSum(n){for(var t=0,i=0;n;)t=t+parseInt(n.offsetTop),i=i+parseInt(n.offsetLeft),n=n.offsetParent;return{top:t,left:i}}function getOffsetRect(n){var r=n.getBoundingClientRect(),t=document.body,i=document.documentElement,u=window.pageYOffset||i.scrollTop||t.scrollTop,f=window.pageXOffset||i.scrollLeft||t.scrollLeft,e=i.clientTop||t.clientTop||0,o=i.clientLeft||t.clientLeft||0,s=r.top+u-e,h=r.left+f-o;return{top:Math.round(s),left:Math.round(h)}}function getOffset(n){return n.getBoundingClientRect?getOffsetRect(n):getOffsetSum(n)}function convertStringToBoolean(n){typeof n=="string"&&(n=n.toLowerCase());switch(n){case"1":case"true":case"yes":case"y":case 1:case!0:return!0;default:return!1}}function getUrlSymbol(n){return n.indexOf("?")!=-1?"&":"?"}function dhtmlDragAndDropObject(){return window.dhtmlDragAndDrop?window.dhtmlDragAndDrop:(this.lastLanding=0,this.dragNode=0,this.dragStartNode=0,this.dragStartObject=0,this.tempDOMU=null,this.tempDOMM=null,this.waitDrag=0,window.dhtmlDragAndDrop=this,this)}function _dhtmlxError(){return this.catches||(this.catches=[]),this}function dhtmlXHeir(n,t){for(var i in t)typeof t[i]=="function"&&(n[i]=t[i]);return n}function dhtmlxEvent(n,t,i){n.addEventListener?n.addEventListener(t,i,!1):n.attachEvent&&n.attachEvent("on"+t,i)}function dataProcessor(n){return this.serverProcessor=n,this.action_param="!nativeeditor_status",this.object=null,this.updatedRows=[],this.autoUpdate=!0,this.updateMode="cell",this._tMode="GET",this.post_delim="_",this._waitMode=0,this._in_progress={},this._invalid={},this.mandatoryFields=[],this.messages=[],this.styles={updated:"font-weight:bold;",inserted:"font-weight:bold;",deleted:"text-decoration : line-through;",invalid:"background-color:FFE0E0;",invalid_cell:"border-bottom:2px solid red;",error:"color:red;",clear:"font-weight:normal;text-decoration:none;"},this.enableUTFencoding(!0),dhtmlxEventable(this),this}window.dhtmlXScheduler=window.scheduler={version:"4.1.0"};window.dhtmlx||(dhtmlx=function(n){for(var t in n)dhtmlx[t]=n[t];return dhtmlx});dhtmlx.extend_api=function(n,t,i){var r=window[n];r&&(window[n]=function(n){var u,i;if(n&&typeof n=="object"&&!n.tagName){u=r.apply(this,t._init?t._init(n):arguments);for(i in dhtmlx)t[i]&&this[t[i]](dhtmlx[i]);for(i in n)t[i]?this[t[i]](n[i]):i.indexOf("on")===0&&this.attachEvent(i,n[i])}else u=r.apply(this,arguments);return t._patch&&t._patch(this),u||this},window[n].prototype=r.prototype,i&&dhtmlXHeir(window[n].prototype,i))};dhtmlxAjax={get:function(n,t){var i=new dtmlXMLLoaderObject(!0);return i.async=arguments.length<3,i.waitCall=t,i.loadXML(n),i},post:function(n,t,i){var r=new dtmlXMLLoaderObject(!0);return r.async=arguments.length<4,r.waitCall=i,r.loadXML(n,!0,t),r},getSync:function(n){return this.get(n,null,!0)},postSync:function(n,t){return this.post(n,t,null,!0)}};dtmlXMLLoaderObject.count=0;dtmlXMLLoaderObject.prototype.waitLoadFunction=function(n){var t=!0;return this.check=function(){if(n&&n.onloadAction&&(!n.xmlDoc.readyState||n.xmlDoc.readyState==4)){if(!t)return;if(t=!1,dtmlXMLLoaderObject.count++,typeof n.onloadAction=="function")n.onloadAction(n.mainObject,null,null,null,n);n.waitCall&&(n.waitCall.call(this,n),n.waitCall=null)}},this.check};dtmlXMLLoaderObject.prototype.getXMLTopNode=function(n,t){var i,r,t;return(this.xmlDoc.responseXML?(r=this.xmlDoc.responseXML.getElementsByTagName(n),r.length===0&&n.indexOf(":")!=-1&&(r=this.xmlDoc.responseXML.getElementsByTagName(n.split(":")[1])),i=r[0]):i=this.xmlDoc.documentElement,i)?(this._retry=!1,i):!this._retry&&_isIE?(this._retry=!0,t=this.xmlDoc,this.loadXMLString(this.xmlDoc.responseText.replace(/^[\s]+/,""),!0),this.getXMLTopNode(n,t)):(dhtmlxError.throwError("LoadXML","Incorrect XML",[t||this.xmlDoc,this.mainObject]),document.createElement("DIV"))};dtmlXMLLoaderObject.prototype.loadXMLString=function(n,t){if(_isIE)this.xmlDoc=new ActiveXObject("Microsoft.XMLDOM"),this.xmlDoc.async=this.async,this.xmlDoc.onreadystatechange=function(){},this.xmlDoc.loadXML(n);else{var i=new DOMParser;this.xmlDoc=i.parseFromString(n,"text/xml")}if(!t){if(this.onloadAction)this.onloadAction(this.mainObject,null,null,null,this);this.waitCall&&(this.waitCall(),this.waitCall=null)}};dtmlXMLLoaderObject.prototype.loadXML=function(n,t,i,r){this.rSeed&&(n+=(n.indexOf("?")!=-1?"&":"?")+"a_dhx_rSeed="+(new Date).valueOf());this.filePath=n;this.xmlDoc=!_isIE&&window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");this.async&&(this.xmlDoc.onreadystatechange=new this.waitLoadFunction(this));this.xmlDoc.open(t?"POST":"GET",n,this.async);r?(this.xmlDoc.setRequestHeader("User-Agent","dhtmlxRPC v0.1 ("+navigator.userAgent+")"),this.xmlDoc.setRequestHeader("Content-type","text/xml")):t&&this.xmlDoc.setRequestHeader("Content-type","application/x-www-form-urlencoded");this.xmlDoc.setRequestHeader("X-Requested-With","XMLHttpRequest");this.xmlDoc.send(null||i);this.async||new this.waitLoadFunction(this)()};dtmlXMLLoaderObject.prototype.destructor=function(){return this._filterXPath=null,this._getAllNamedChilds=null,this._retry=null,this.async=null,this.rSeed=null,this.filePath=null,this.onloadAction=null,this.mainObject=null,this.xmlDoc=null,this.doXPath=null,this.doXPathOpera=null,this.doXSLTransToObject=null,this.doXSLTransToString=null,this.loadXML=null,this.loadXMLString=null,this.doSerialization=null,this.xmlNodeToJSON=null,this.getXMLTopNode=null,this.setXSLParamValue=null,null};dtmlXMLLoaderObject.prototype.xmlNodeToJSON=function(n){for(var r,i={},t=0;t<n.attributes.length;t++)i[n.attributes[t].name]=n.attributes[t].value;for(i._tagvalue=n.firstChild?n.firstChild.nodeValue:"",t=0;t<n.childNodes.length;t++)r=n.childNodes[t].tagName,r&&(i[r]||(i[r]=[]),i[r].push(this.xmlNodeToJSON(n.childNodes[t])));return i};dhtmlDragAndDropObject.prototype.removeDraggableItem=function(n){n.onmousedown=null;n.dragStarter=null;n.dragLanding=null};dhtmlDragAndDropObject.prototype.addDraggableItem=function(n,t){n.onmousedown=this.preCreateDragCopy;n.dragStarter=t;this.addDragLanding(n,t)};dhtmlDragAndDropObject.prototype.addDragLanding=function(n,t){n.dragLanding=t};dhtmlDragAndDropObject.prototype.preCreateDragCopy=function(n){if(!(n||window.event)||(n||event).button!=2)return window.dhtmlDragAndDrop.waitDrag?(window.dhtmlDragAndDrop.waitDrag=0,document.body.onmouseup=window.dhtmlDragAndDrop.tempDOMU,document.body.onmousemove=window.dhtmlDragAndDrop.tempDOMM,!1):(window.dhtmlDragAndDrop.dragNode&&window.dhtmlDragAndDrop.stopDrag(n),window.dhtmlDragAndDrop.waitDrag=1,window.dhtmlDragAndDrop.tempDOMU=document.body.onmouseup,window.dhtmlDragAndDrop.tempDOMM=document.body.onmousemove,window.dhtmlDragAndDrop.dragStartNode=this,window.dhtmlDragAndDrop.dragStartObject=this.dragStarter,document.body.onmouseup=window.dhtmlDragAndDrop.preCreateDragCopy,document.body.onmousemove=window.dhtmlDragAndDrop.callDrag,window.dhtmlDragAndDrop.downtime=(new Date).valueOf(),n&&n.preventDefault)?(n.preventDefault(),!1):!1};dhtmlDragAndDropObject.prototype.callDrag=function(n){var t,i,u,r,f;if(n||(n=window.event),t=window.dhtmlDragAndDrop,!((new Date).valueOf()-t.downtime<100)){if(!t.dragNode)if(t.waitDrag){if(t.dragNode=t.dragStartObject._createDragNode(t.dragStartNode,n),!t.dragNode)return t.stopDrag();t.dragNode.onselectstart=function(){return!1};t.gldragNode=t.dragNode;document.body.appendChild(t.dragNode);document.body.onmouseup=t.stopDrag;t.waitDrag=0;t.dragNode.pWindow=window;t.initFrameRoute()}else return t.stopDrag(n,!0);t.dragNode.parentNode!=window.document.body&&t.gldragNode&&(i=t.gldragNode,t.gldragNode.old&&(i=t.gldragNode.old),i.parentNode.removeChild(i),u=t.dragNode.pWindow,i.pWindow&&i.pWindow.dhtmlDragAndDrop.lastLanding&&i.pWindow.dhtmlDragAndDrop.lastLanding.dragLanding._dragOut(i.pWindow.dhtmlDragAndDrop.lastLanding),_isIE?(r=document.createElement("Div"),r.innerHTML=t.dragNode.outerHTML,t.dragNode=r.childNodes[0]):t.dragNode=t.dragNode.cloneNode(!0),t.dragNode.pWindow=window,t.gldragNode.old=t.dragNode,document.body.appendChild(t.dragNode),u.dhtmlDragAndDrop.dragNode=t.dragNode);t.dragNode.style.left=n.clientX+15+(t.fx?t.fx*-1:0)+(document.body.scrollLeft||document.documentElement.scrollLeft)+"px";t.dragNode.style.top=n.clientY+3+(t.fy?t.fy*-1:0)+(document.body.scrollTop||document.documentElement.scrollTop)+"px";f=n.srcElement?n.srcElement:n.target;t.checkLanding(f,n)}};dhtmlDragAndDropObject.prototype.calculateFramePosition=function(n){var u;if(window.name){for(var t=parent.frames[window.name].frameElement.offsetParent,i=0,r=0;t;)i+=t.offsetLeft,r+=t.offsetTop,t=t.offsetParent;if(parent.dhtmlDragAndDrop&&(u=parent.dhtmlDragAndDrop.calculateFramePosition(1),i+=u.split("_")[0]*1,r+=u.split("_")[1]*1),n)return i+"_"+r;this.fx=i;this.fy=r}return"0_0"};dhtmlDragAndDropObject.prototype.checkLanding=function(n,t){n&&n.dragLanding?(this.lastLanding&&this.lastLanding.dragLanding._dragOut(this.lastLanding),this.lastLanding=n,this.lastLanding=this.lastLanding.dragLanding._dragIn(this.lastLanding,this.dragStartNode,t.clientX,t.clientY,t),this.lastLanding_scr=_isIE?t.srcElement:t.target):n&&n.tagName!="BODY"?this.checkLanding(n.parentNode,t):(this.lastLanding&&this.lastLanding.dragLanding._dragOut(this.lastLanding,t.clientX,t.clientY,t),this.lastLanding=0,this._onNotFound&&this._onNotFound())};dhtmlDragAndDropObject.prototype.stopDrag=function(n,t){var i=window.dhtmlDragAndDrop,r;t||(i.stopFrameRoute(),r=i.lastLanding,i.lastLanding=null,r&&r.dragLanding._drag(i.dragStartNode,i.dragStartObject,r,_isIE?event.srcElement:n.target));i.lastLanding=null;i.dragNode&&i.dragNode.parentNode==document.body&&i.dragNode.parentNode.removeChild(i.dragNode);i.dragNode=0;i.gldragNode=0;i.fx=0;i.fy=0;i.dragStartNode=0;i.dragStartObject=0;document.body.onmouseup=i.tempDOMU;document.body.onmousemove=i.tempDOMM;i.tempDOMU=null;i.tempDOMM=null;i.waitDrag=0};dhtmlDragAndDropObject.prototype.stopFrameRoute=function(n){n&&window.dhtmlDragAndDrop.stopDrag(1,1);for(var t=0;t<window.frames.length;t++)try{window.frames[t]!=n&&window.frames[t].dhtmlDragAndDrop&&window.frames[t].dhtmlDragAndDrop.stopFrameRoute(window)}catch(i){}try{parent.dhtmlDragAndDrop&&parent!=window&&parent!=n&&parent.dhtmlDragAndDrop.stopFrameRoute(window)}catch(i){}};dhtmlDragAndDropObject.prototype.initFrameRoute=function(n,t){n&&(window.dhtmlDragAndDrop.preCreateDragCopy(),window.dhtmlDragAndDrop.dragStartNode=n.dhtmlDragAndDrop.dragStartNode,window.dhtmlDragAndDrop.dragStartObject=n.dhtmlDragAndDrop.dragStartObject,window.dhtmlDragAndDrop.dragNode=n.dhtmlDragAndDrop.dragNode,window.dhtmlDragAndDrop.gldragNode=n.dhtmlDragAndDrop.dragNode,window.document.body.onmouseup=window.dhtmlDragAndDrop.stopDrag,window.waitDrag=0,!_isIE&&t&&(!_isFF||_FFrv<1.8)&&window.dhtmlDragAndDrop.calculateFramePosition());try{parent.dhtmlDragAndDrop&&parent!=window&&parent!=n&&parent.dhtmlDragAndDrop.initFrameRoute(window)}catch(r){}for(var i=0;i<window.frames.length;i++)try{window.frames[i]!=n&&window.frames[i].dhtmlDragAndDrop&&window.frames[i].dhtmlDragAndDrop.initFrameRoute(window,!n||t?1:0)}catch(r){}};_isFF=!1;_isIE=!1;_isOpera=!1;_isKHTML=!1;_isMacOS=!1;_isChrome=!1;_FFrv=!1;_KHTMLrv=!1;_OperaRv=!1;navigator.userAgent.indexOf("Macintosh")!=-1&&(_isMacOS=!0);navigator.userAgent.toLowerCase().indexOf("chrome")>-1&&(_isChrome=!0);navigator.userAgent.indexOf("Safari")!=-1||navigator.userAgent.indexOf("Konqueror")!=-1?(_KHTMLrv=parseFloat(navigator.userAgent.substr(navigator.userAgent.indexOf("Safari")+7,5)),_KHTMLrv>525?(_isFF=!0,_FFrv=1.9):_isKHTML=!0):navigator.userAgent.indexOf("Opera")!=-1?(_isOpera=!0,_OperaRv=parseFloat(navigator.userAgent.substr(navigator.userAgent.indexOf("Opera")+6,3))):navigator.appName.indexOf("Microsoft")!=-1?(_isIE=!0,(navigator.appVersion.indexOf("MSIE 8.0")!=-1||navigator.appVersion.indexOf("MSIE 9.0")!=-1||navigator.appVersion.indexOf("MSIE 10.0")!=-1)&&document.compatMode!="BackCompat"&&(_isIE=8)):navigator.appName=="Netscape"&&navigator.userAgent.indexOf("Trident")!=-1?_isIE=8:(_isFF=!0,_FFrv=parseFloat(navigator.userAgent.split("rv:")[1]));dtmlXMLLoaderObject.prototype.doXPath=function(n,t,i,r){var u,f,e,o,s;if(_isKHTML||!_isIE&&!window.XPathResult)return this.doXPathOpera(n,t);if(_isIE)return t||(t=this.xmlDoc.nodeName?this.xmlDoc:this.xmlDoc.responseXML),t||dhtmlxError.throwError("LoadXML","Incorrect XML",[t||this.xmlDoc,this.mainObject]),i&&t.setProperty("SelectionNamespaces","xmlns:xsl='"+i+"'"),r=="single"?t.selectSingleNode(n):t.selectNodes(n)||new Array(0);if(u=t,t||(t=this.xmlDoc.nodeName?this.xmlDoc:this.xmlDoc.responseXML),t||dhtmlxError.throwError("LoadXML","Incorrect XML",[t||this.xmlDoc,this.mainObject]),t.nodeName.indexOf("document")!=-1?u=t:(u=t,t=t.ownerDocument),f=XPathResult.ANY_TYPE,r=="single"&&(f=XPathResult.FIRST_ORDERED_NODE_TYPE),e=[],o=t.evaluate(n,u,function(){return i},f,null),f==XPathResult.FIRST_ORDERED_NODE_TYPE)return o.singleNodeValue;for(s=o.iterateNext();s;)e[e.length]=s,s=o.iterateNext();return e};_dhtmlxError.prototype.catchError=function(n,t){this.catches[n]=t};_dhtmlxError.prototype.throwError=function(n,t,i){return this.catches[n]?this.catches[n](n,t,i):this.catches.ALL?this.catches.ALL(n,t,i):(window.alert("Error type: "+arguments[0]+"\nDescription: "+arguments[1]),null)};window.dhtmlxError=new _dhtmlxError;dtmlXMLLoaderObject.prototype.doXPathOpera=function(n,t){var i=n.replace(/[\/]+/gi,"/").split("/"),u=null,r=1;if(!i.length)return[];if(i[0]==".")u=[t];else if(i[0]==="")u=(this.xmlDoc.responseXML||this.xmlDoc).getElementsByTagName(i[r].replace(/\[[^\]]*\]/g,"")),r++;else return[];for(r;r<i.length;r++)u=this._getAllNamedChilds(u,i[r]);return i[r-1].indexOf("[")!=-1&&(u=this._filterXPath(u,i[r-1])),u};dtmlXMLLoaderObject.prototype._filterXPath=function(n,t){for(var r=[],t=t.replace(/[^\[]*\[\@/g,"").replace(/[\[\]\@]*/g,""),i=0;i<n.length;i++)n[i].getAttribute(t)&&(r[r.length]=n[i]);return r};dtmlXMLLoaderObject.prototype._getAllNamedChilds=function(n,t){var u=[],i,r;for(_isKHTML&&(t=t.toUpperCase()),i=0;i<n.length;i++)for(r=0;r<n[i].childNodes.length;r++)_isKHTML?n[i].childNodes[r].tagName&&n[i].childNodes[r].tagName.toUpperCase()==t&&(u[u.length]=n[i].childNodes[r]):n[i].childNodes[r].tagName==t&&(u[u.length]=n[i].childNodes[r]);return u};dtmlXMLLoaderObject.prototype.xslDoc=null;dtmlXMLLoaderObject.prototype.setXSLParamValue=function(n,t,i){i||(i=this.xslDoc);i.responseXML&&(i=i.responseXML);var r=this.doXPath("/xsl:stylesheet/xsl:variable[@name='"+n+"']",i,"http://www.w3.org/1999/XSL/Transform","single");r&&(r.firstChild.nodeValue=t)};dtmlXMLLoaderObject.prototype.doXSLTransToObject=function(n,t){n||(n=this.xslDoc);n.responseXML&&(n=n.responseXML);t||(t=this.xmlDoc);t.responseXML&&(t=t.responseXML);var i;if(_isIE){i=new ActiveXObject("Msxml2.DOMDocument.3.0");try{t.transformNodeToObject(n,i)}catch(r){i=t.transformNode(n)}}else this.XSLProcessor||(this.XSLProcessor=new XSLTProcessor,this.XSLProcessor.importStylesheet(n)),i=this.XSLProcessor.transformToDocument(t);return i};dtmlXMLLoaderObject.prototype.doXSLTransToString=function(n,t){var i=this.doXSLTransToObject(n,t);return typeof i=="string"?i:this.doSerialization(i)};dtmlXMLLoaderObject.prototype.doSerialization=function(n){if(n||(n=this.xmlDoc),n.responseXML&&(n=n.responseXML),_isIE)return n.xml;var t=new XMLSerializer;return t.serializeToString(n)};dhtmlxEventable=function(n){n.attachEvent=function(n,t,i){return n="ev_"+n.toLowerCase(),this[n]||(this[n]=new this.eventCatcher(i||this)),n+":"+this[n].addEvent(t)};n.callEvent=function(n,t){return(n="ev_"+n.toLowerCase(),this[n])?this[n].apply(this,t):!0};n.checkEvent=function(n){return!!this["ev_"+n.toLowerCase()]};n.eventCatcher=function(n){var t=[],i=function(){for(var u,r=!0,i=0;i<t.length;i++)t[i]&&(u=t[i].apply(n,arguments),r=r&&u);return r};return i.addEvent=function(n){return(typeof n!="function"&&(n=eval(n)),n)?t.push(n)-1:!1},i.removeEvent=function(n){t[n]=null},i};n.detachEvent=function(n){if(n){var t=n.split(":");this[t[0]].removeEvent(t[1])}};n.detachAllEvents=function(){for(var n in this)n.indexOf("ev_")===0&&(this.detachEvent(n),this[n]=null)};n=null};window.dhtmlx||(window.dhtmlx={}),function(){function u(n,r){var u=n.callback;t(!1);n.box.parentNode.removeChild(n.box);i=n.box=null;u&&u(r)}function r(n){if(i){n=n||event;var t=n.which||event.keyCode;return dhtmlx.message.keyboard&&((t==13||t==32)&&u(i,!0),t==27&&u(i,!1)),n.preventDefault&&n.preventDefault(),!(n.cancelBubble=!0)}}function t(n){t.cover||(t.cover=document.createElement("DIV"),t.cover.onkeydown=r,t.cover.className="dhx_modal_cover",document.body.appendChild(t.cover));var i=document.body.scrollHeight;t.cover.style.display=n?"inline-block":"none"}function f(n,t,i){var r=i?i:n||"",u="dhtmlx_"+r.toLowerCase().replace(/ /g,"_")+"_button";return"<div class='dhtmlx_popup_button "+u+"' result='"+t+"' ><div>"+n+"<\/div><\/div>"}function l(t){n.area||(n.area=document.createElement("DIV"),n.area.className="dhtmlx_message_area",n.area.style[n.position]="5px",document.body.appendChild(n.area));n.hide(t.id);var i=document.createElement("DIV");return i.innerHTML="<div>"+t.text+"<\/div>",i.className="dhtmlx-info dhtmlx-"+t.type,i.onclick=function(){n.hide(t.id);t=null},n.position=="bottom"&&n.area.firstChild?n.area.insertBefore(i,n.area.firstChild):n.area.appendChild(i),t.expire>0&&(n.timers[t.id]=window.setTimeout(function(){n.hide(t.id)},t.expire)),n.pull[t.id]=i,i=null,t.id}function a(n,t,r){var e=document.createElement("DIV"),o,c,l,h,s;if(e.className=" dhtmlx_modal_box dhtmlx-"+n.type,e.setAttribute("dhxbox",1),o="",n.width&&(e.style.width=n.width),n.height&&(e.style.height=n.height),n.title&&(o+='<div class="dhtmlx_popup_title">'+n.title+"<\/div>"),o+='<div class="dhtmlx_popup_text"><span>'+(n.content?"":n.text)+'<\/span><\/div><div  class="dhtmlx_popup_controls">',t&&(c=n.ok||scheduler.locale.labels.message_ok,c===undefined&&(c="OK"),o+=f(c,!0,"ok")),r&&(l=n.cancel||scheduler.locale.labels.message_cancel,l===undefined&&(l="Cancel"),o+=f(l,!1,"cancel")),n.buttons)for(h=0;h<n.buttons.length;h++)o+=f(n.buttons[h],h);return o+="<\/div>",e.innerHTML=o,n.content&&(s=n.content,typeof s=="string"&&(s=document.getElementById(s)),s.style.display=="none"&&(s.style.display=""),e.childNodes[n.title?1:0].appendChild(s)),e.onclick=function(t){var i,r;t=t||event;i=t.target||t.srcElement;i.className||(i=i.parentNode);i.className.split(" ")[0]=="dhtmlx_popup_button"&&(r=i.getAttribute("result"),r=r=="true"||(r=="false"?!1:r),u(n,r))},n.box=e,(t||r)&&(i=n),e}function e(n,i,u){var f=n.tagName?n:a(n,i,u),e,o;return n.hidden||t(!0),document.body.appendChild(f),e=Math.abs(Math.floor(((window.innerWidth||document.documentElement.offsetWidth)-f.offsetWidth)/2)),o=Math.abs(Math.floor(((window.innerHeight||document.documentElement.offsetHeight)-f.offsetHeight)/2)),f.style.top=n.position=="top"?"-3px":o+"px",f.style.left=e+"px",f.onkeydown=r,f.focus(),n.hidden&&dhtmlx.modalbox.hide(f),f}function s(n){return e(n,!0,!1)}function h(n){return e(n,!0,!0)}function c(n){return e(n)}function o(n,t,i){return typeof n!="object"&&(typeof t=="function"&&(i=t,t=""),n={text:n,type:t,callback:i}),n}function v(t,i,r,u){return typeof t!="object"&&(t={text:t,type:i,expire:r,id:u}),t.id=t.id||n.uid(),t.expire=t.expire||n.expire,t}var i=null,n;document.attachEvent?document.attachEvent("onkeydown",r):document.addEventListener("keydown",r,!0);dhtmlx.alert=function(){var n=o.apply(this,arguments);return n.type=n.type||"confirm",s(n)};dhtmlx.confirm=function(){var n=o.apply(this,arguments);return n.type=n.type||"alert",h(n)};dhtmlx.modalbox=function(){var n=o.apply(this,arguments);return n.type=n.type||"alert",c(n)};dhtmlx.modalbox.hide=function(n){while(n&&n.getAttribute&&!n.getAttribute("dhxbox"))n=n.parentNode;n&&(n.parentNode.removeChild(n),t(!1))};n=dhtmlx.message=function(n){n=v.apply(this,arguments);n.type=n.type||"info";var t=n.type.split("-")[0];switch(t){case"alert":return s(n);case"confirm":return h(n);case"modalbox":return c(n);default:return l(n)}};n.seed=(new Date).valueOf();n.uid=function(){return n.seed++};n.expire=4e3;n.keyboard=!0;n.position="top";n.pull={};n.timers={};n.hideAll=function(){for(var t in n.pull)n.hide(t)};n.hide=function(t){var i=n.pull[t];i&&i.parentNode&&(window.setTimeout(function(){i.parentNode.removeChild(i);i=null},2e3),i.className+=" hidden",n.timers[t]&&window.clearTimeout(n.timers[t]),delete n.pull[t])}}();dataProcessor.prototype={setTransactionMode:function(n,t){this._tMode=n;this._tSend=t},escape:function(n){return this._utf?encodeURIComponent(n):escape(n)},enableUTFencoding:function(n){this._utf=convertStringToBoolean(n)},setDataColumns:function(n){this._columns=typeof n=="string"?n.split(","):n},getSyncState:function(){return!this.updatedRows.length},enableDataNames:function(n){this._endnm=convertStringToBoolean(n)},enablePartialDataSend:function(n){this._changed=convertStringToBoolean(n)},setUpdateMode:function(n,t){this.autoUpdate=n=="cell";this.updateMode=n;this.dnd=t},ignore:function(n,t){this._silent_mode=!0;n.call(t||window);this._silent_mode=!1},setUpdated:function(n,t,i){var r,u;this._silent_mode||(r=this.findRow(n),i=i||"updated",u=this.obj.getUserData(n,this.action_param),u&&i=="updated"&&(i=u),t?(this.set_invalid(n,!1),this.updatedRows[r]=n,this.obj.setUserData(n,this.action_param,i),this._in_progress[n]&&(this._in_progress[n]="wait")):this.is_invalid(n)||(this.updatedRows.splice(r,1),this.obj.setUserData(n,this.action_param,"")),t||this._clearUpdateFlag(n),this.markRow(n,t,i),t&&this.autoUpdate&&this.sendData(n))},_clearUpdateFlag:function(){},markRow:function(n,t,i){var u="",r=this.is_invalid(n),f;if(r&&(u=this.styles[r],t=!0),this.callEvent("onRowMark",[n,t,i,r])&&(u=this.styles[t?i:"clear"]+u,this.obj[this._methods[0]](n,u),r&&r.details))for(u+=this.styles[r+"_cell"],f=0;f<r.details.length;f++)r.details[f]&&this.obj[this._methods[1]](n,f,u)},getState:function(n){return this.obj.getUserData(n,this.action_param)},is_invalid:function(n){return this._invalid[n]},set_invalid:function(n,t,i){i&&(t={value:t,details:i,toString:function(){return this.value.toString()}});this._invalid[n]=t},checkBeforeUpdate:function(){return!0},sendData:function(n){if(!this._waitMode||this.obj.mytype!="tree"&&!this.obj._h2){if(this.obj.editStop&&this.obj.editStop(),typeof n=="undefined"||this._tSend)return this.sendAllData();if(this._in_progress[n]||(this.messages=[],!this.checkBeforeUpdate(n)&&this.callEvent("onValidationError",[n,this.messages])))return!1;this._beforeSendData(this._getRowData(n),n)}},_beforeSendData:function(n,t){if(!this.callEvent("onBeforeUpdate",[t,this.getState(t),n]))return!1;this._sendData(n,t)},serialize:function(n,t){var i,u,r;if(typeof n=="string")return n;if(typeof t!="undefined")return this.serialize_one(n,"");i=[];u=[];for(r in n)n.hasOwnProperty(r)&&(i.push(this.serialize_one(n[r],r+this.post_delim)),u.push(r));return i.push("ids="+this.escape(u.join(","))),dhtmlx.security_key&&i.push("dhx_security="+dhtmlx.security_key),i.join("&")},serialize_one:function(n,t){var r,i;if(typeof n=="string")return n;r=[];for(i in n)n.hasOwnProperty(i)&&r.push(this.escape((t||"")+i)+"="+this.escape(n[i]));return r.join("&")},_sendData:function(n,t){if(n){if(!this.callEvent("onBeforeDataSending",t?[t,this.getState(t),n]:[null,null,n]))return!1;t&&(this._in_progress[t]=(new Date).valueOf());var r=new dtmlXMLLoaderObject(this.afterUpdate,this,!0),i=this.serverProcessor+(this._user?getUrlSymbol(this.serverProcessor)+["dhx_user="+this._user,"dhx_version="+this.obj.getUserData(0,"version")].join("&"):"");this._tMode!="POST"?r.loadXML(i+(i.indexOf("?")!=-1?"&":"?")+this.serialize(n,t)):r.loadXML(i,!0,this.serialize(n,t));this._waitMode++}},sendAllData:function(){var t,n;if(this.updatedRows.length){for(this.messages=[],t=!0,n=0;n<this.updatedRows.length;n++)t&=this.checkBeforeUpdate(this.updatedRows[n]);if(!t&&!this.callEvent("onValidationError",["",this.messages]))return!1;if(this._tSend)this._sendData(this._getAllData());else for(n=0;n<this.updatedRows.length;n++)if(!this._in_progress[this.updatedRows[n]]){if(this.is_invalid(this.updatedRows[n]))continue;if(this._beforeSendData(this._getRowData(this.updatedRows[n]),this.updatedRows[n]),this._waitMode&&(this.obj.mytype=="tree"||this.obj._h2))return}}},_getAllData:function(){for(var n,i={},r=!1,t=0;t<this.updatedRows.length;t++)(n=this.updatedRows[t],this._in_progress[n]||this.is_invalid(n))||this.callEvent("onBeforeUpdate",[n,this.getState(n)])&&(i[n]=this._getRowData(n,n+this.post_delim),r=!0,this._in_progress[n]=(new Date).valueOf());return r?i:null},setVerificator:function(n,t){this.mandatoryFields[n]=t||function(n){return n!==""}},clearVerificator:function(n){this.mandatoryFields[n]=!1},findRow:function(n){for(var t=0,t=0;t<this.updatedRows.length;t++)if(n==this.updatedRows[t])break;return t},defineAction:function(n,t){this._uActions||(this._uActions=[]);this._uActions[n]=t},afterUpdateCallback:function(n,t,i,r){var u=n,f=i!="error"&&i!="invalid",e;if(f||this.set_invalid(n,i),this._uActions&&this._uActions[i]&&!this._uActions[i](r))return delete this._in_progress[u];this._in_progress[u]!="wait"&&this.setUpdated(n,!1);e=n;switch(i){case"inserted":case"insert":t!=n&&(this.obj[this._methods[2]](n,t),n=t);break;case"delete":case"deleted":return this.obj.setUserData(n,this.action_param,"true_deleted"),this.obj[this._methods[3]](n),delete this._in_progress[u],this.callEvent("onAfterUpdate",[n,i,t,r])}this._in_progress[u]!="wait"?(f&&this.obj.setUserData(n,this.action_param,""),delete this._in_progress[u]):(delete this._in_progress[u],this.setUpdated(t,!0,this.obj.getUserData(n,this.action_param)));this.callEvent("onAfterUpdate",[e,i,t,r])},afterUpdate:function(n,t,i,r,u){var o,f;if(u.getXMLTopNode("data"),u.xmlDoc.responseXML){for(o=u.doXPath("//data/action"),f=0;f<o.length;f++){var e=o[f],s=e.getAttribute("type"),h=e.getAttribute("sid"),c=e.getAttribute("tid");n.afterUpdateCallback(h,c,s,e)}n.finalizeUpdate()}},finalizeUpdate:function(){this._waitMode&&this._waitMode--;(this.obj.mytype=="tree"||this.obj._h2)&&this.updatedRows.length&&this.sendData();this.callEvent("onAfterUpdateFinish",[]);this.updatedRows.length||this.callEvent("onFullSync",[])},init:function(n){this.obj=n;this.obj._dp_init&&this.obj._dp_init(this)},setOnAfterUpdate:function(n){this.attachEvent("onAfterUpdate",n)},enableDebug:function(){},setOnBeforeUpdateHandler:function(n){this.attachEvent("onBeforeDataSending",n)},setAutoUpdate:function(n,t){n=n||2e3;this._user=t||(new Date).valueOf();this._need_update=!1;this._loader=null;this._update_busy=!1;this.attachEvent("onAfterUpdate",function(n,t,i,r){this.afterAutoUpdate(n,t,i,r)});this.attachEvent("onFullSync",function(){this.fullSync()});var i=this;window.setInterval(function(){i.loadUpdate()},n)},afterAutoUpdate:function(n,t){return t=="collision"?(this._need_update=!0,!1):!0},fullSync:function(){return this._need_update===!0&&(this._need_update=!1,this.loadUpdate()),!0},getUpdates:function(n,t){if(this._update_busy)return!1;this._update_busy=!0;this._loader=this._loader||new dtmlXMLLoaderObject(!0);this._loader.async=!0;this._loader.waitCall=t;this._loader.loadXML(n)},_v:function(n){return n.firstChild?n.firstChild.nodeValue:""},_a:function(n){for(var i=[],t=0;t<n.length;t++)i[t]=this._v(n[t]);return i},loadUpdate:function(){var n=this,i=this.obj.getUserData(0,"version"),t=this.serverProcessor+getUrlSymbol(this.serverProcessor)+["dhx_user="+this._user,"dhx_version="+i].join("&");t=t.replace("editing=true&","");this.getUpdates(t,function(){var f=n._loader.doXPath("//userdata"),t,i;if(n.obj.setUserData(0,"version",n._v(f[0])),t=n._loader.doXPath("//update"),t.length){for(n._silent_mode=!0,i=0;i<t.length;i++){var e=t[i].getAttribute("status"),r=t[i].getAttribute("id"),u=t[i].getAttribute("parent");switch(e){case"inserted":n.callEvent("insertCallback",[t[i],r,u]);break;case"updated":n.callEvent("updateCallback",[t[i],r,u]);break;case"deleted":n.callEvent("deleteCallback",[t[i],r,u])}}n._silent_mode=!1}n._update_busy=!1;n=null})}};window.dhtmlXGridObject&&(dhtmlXGridObject.prototype._init_point_connector=dhtmlXGridObject.prototype._init_point,dhtmlXGridObject.prototype._init_point=function(){var t=function(n){return n=n.replace(/(\?|\&)connector[^\f]*/g,""),n+(n.indexOf("?")!=-1?"&":"?")+"connector=true"+(this.hdr.rows.length>0?"&dhx_no_header=1":"")},n=function(n){return t.call(this,n)+(this._connector_sorting||"")+(this._connector_filter||"")},i=function(t,i,r){return this._connector_sorting="&dhx_sort["+i+"]="+r,n.call(this,t)},r=function(t,i,r){for(var u=0;u<i.length;u++)i[u]="dhx_filter["+i[u]+"]="+encodeURIComponent(r[u]);return this._connector_filter="&"+i.join("&"),n.call(this,t)};this.attachEvent("onCollectValues",function(n){return this._con_f_used[n]?typeof this._con_f_used[n]=="object"?this._con_f_used[n]:!1:!0});this.attachEvent("onDynXLS",function(){return this.xmlFileUrl=n.call(this,this.xmlFileUrl),!0});this.attachEvent("onBeforeSorting",function(n,t,r){if(t=="connector"){var u=this;return this.clearAndLoad(i.call(this,this.xmlFileUrl,n,r),function(){u.setSortImgState(!0,n,r)}),!1}return!0});this.attachEvent("onFilterStart",function(n,t){return this._con_f_used.length?(this.clearAndLoad(r.call(this,this.xmlFileUrl,n,t)),!1):!0});this.attachEvent("onXLE",function(n,t,i,r){!r});this._init_point_connector&&this._init_point_connector()},dhtmlXGridObject.prototype._con_f_used=[],dhtmlXGridObject.prototype._in_header_connector_text_filter=function(n,t){return this._con_f_used[t]||(this._con_f_used[t]=1),this._in_header_text_filter(n,t)},dhtmlXGridObject.prototype._in_header_connector_select_filter=function(n,t){return this._con_f_used[t]||(this._con_f_used[t]=2),this._in_header_select_filter(n,t)},dhtmlXGridObject.prototype.load_connector=dhtmlXGridObject.prototype.load,dhtmlXGridObject.prototype.load=function(){var i=[].concat(arguments),t,n;if(!this._colls_loaded&&this.cellType){for(t=[],n=0;n<this.cellType.length;n++)(this.cellType[n].indexOf("co")===0||this._con_f_used[n]==2)&&t.push(n);t.length&&(i[0]+=(i[0].indexOf("?")!=-1?"&":"?")+"connector=true&dhx_colls="+t.join(","))}return this.load_connector.apply(this,i)},dhtmlXGridObject.prototype._parseHead_connector=dhtmlXGridObject.prototype._parseHead,dhtmlXGridObject.prototype._parseHead=function(){var e,i,o,u,f,s;if(this._parseHead_connector.apply(this,arguments),!this._colls_loaded){for(e=this.xmlLoader.doXPath("./coll_options",arguments[0]),i=0;i<e.length;i++){var n=e[i].getAttribute("for"),r=[],t=null;for(this.cellType[n]=="combo"&&(t=this.getColumnCombo(n)),this.cellType[n].indexOf("co")===0&&(t=this.getCombo(n)),o=this.xmlLoader.doXPath("./item",e[i]),u=0;u<o.length;u++)f=o[u].getAttribute("value"),t?(s=o[u].getAttribute("label")||f,t.addOption?t.addOption([[f,s]]):t.put(f,s),r[r.length]=s):r[r.length]=f;this._con_f_used[n*1]&&(this._con_f_used[n*1]=r)}this._colls_loaded=!0}});window.dataProcessor&&(dataProcessor.prototype.init_original=dataProcessor.prototype.init,dataProcessor.prototype.init=function(n){this.init_original(n);n._dataprocessor=this;this.setTransactionMode("POST",!0);this.serverProcessor+=(this.serverProcessor.indexOf("?")!=-1?"&":"?")+"editing=true"});dhtmlxError.catchError("LoadXML",function(n,t,i){i[0].status&&window.alert(i[0].responseText)});dhtmlxEventable(scheduler);scheduler._detachDomEvent=function(n,t,i){n.removeEventListener?n.removeEventListener(t,i,!1):n.detachEvent&&n.detachEvent("on"+t,i)};scheduler._init_once=function(){function t(){return{w:window.innerWidth||document.documentElement.clientWidth,h:window.innerHeight||document.documentElement.clientHeight}}function i(n,t){return n.w==t.w&&n.h==t.h}var n=t();dhtmlxEvent(window,"resize",function(){var r=t();i(n,r)||(window.clearTimeout(scheduler._resize_timer),scheduler._resize_timer=window.setTimeout(function(){scheduler.callEvent("onSchedulerResize",[])&&(scheduler.update_view(),scheduler.callEvent("onAfterSchedulerResize",[]))},100));n=r});scheduler._init_once=function(){}};scheduler.init=function(n,t,i){t=t||scheduler._currentDate();i=i||"week";this._obj&&this.unset_actions();this._obj=typeof n=="string"?document.getElementById(n):n;this._skin_init&&scheduler._skin_init();scheduler.date.init();this._els=[];this._scroll=!0;this._quirks=_isIE&&document.compatMode=="BackCompat";this._quirks7=_isIE&&navigator.appVersion.indexOf("MSIE 8")==-1;this.get_elements();this.init_templates();this.set_actions();this._init_once();this._init_touch_events();this.set_sizes();scheduler.callEvent("onSchedulerReady",[]);this.setCurrentView(t,i)};scheduler.xy={min_event_height:40,scale_width:50,scroll_width:18,scale_height:20,month_scale_height:20,menu_width:25,margin_top:0,margin_left:0,editor_width:140,month_head_height:22};scheduler.keys={edit_save:13,edit_cancel:27};scheduler.set_sizes=function(){var t=this._x=this._obj.clientWidth-this.xy.margin_left,r=this._y=this._obj.clientHeight-this.xy.margin_top,u=this._table_view?0:this.xy.scale_width+this.xy.scroll_width,f=this._table_view?-1:this.xy.scale_width,i,n;this.set_xy(this._els.dhx_cal_navline[0],t,this.xy.nav_height,0,0);this.set_xy(this._els.dhx_cal_header[0],t-u,this.xy.scale_height,f,this.xy.nav_height+(this._quirks?-1:1));i=this._els.dhx_cal_navline[0].offsetHeight;i>0&&(this.xy.nav_height=i);n=this.xy.scale_height+this.xy.nav_height+(this._quirks?-2:0);this.getState().mode=="year"?this.set_xy(this._els.dhx_cal_data[0],t,r-(n+2)-11,0,n+2+11):this.set_xy(this._els.dhx_cal_data[0],t,r-(n+2)-10,0,n+2+10)};scheduler.set_xy=function(n,t,i,r,u){n.style.width=Math.max(0,t)+"px";n.style.height=Math.max(0,i)+"px";arguments.length>3&&(n.style.left=r+"px",n.style.top=u+"px")};scheduler.get_elements=function(){for(var n,u,r,i=this._obj.getElementsByTagName("DIV"),t=0;t<i.length;t++)n=i[t].className||"",u=i[t].getAttribute("name")||"",n&&(n=n.split(" ")[0]),this._els[n]||(this._els[n]=[]),this._els[n].push(i[t]),r=scheduler.locale.labels[u||n],typeof r!="string"&&u&&!i[t].innerHTML&&(r=u.split("_")[0]),r&&(i[t].innerHTML=r)};scheduler.unset_actions=function(){var n,t;for(n in this._els)if(this._click[n])for(t=0;t<this._els[n].length;t++)this._els[n][t].onclick=null;this._obj.onselectstart=null;this._obj.onmousemove=null;this._obj.onmousedown=null;this._obj.onmouseup=null;this._obj.ondblclick=null;this._obj.oncontextmenu=null};scheduler.set_actions=function(){var n,t;for(n in this._els)if(this._click[n])for(t=0;t<this._els[n].length;t++)this._els[n][t].onclick=scheduler._click[n];this._obj.onselectstart=function(){return!1};this._obj.onmousemove=function(n){scheduler._temp_touch_block||scheduler._on_mouse_move(n||event)};this._obj.onmousedown=function(n){scheduler._ignore_next_click||scheduler._on_mouse_down(n||event)};this._obj.onmouseup=function(n){scheduler._ignore_next_click||scheduler._on_mouse_up(n||event)};this._obj.ondblclick=function(n){scheduler._on_dbl_click(n||event)};this._obj.oncontextmenu=function(n){var t=n||event,i=t.target||t.srcElement;return scheduler.callEvent("onContextMenu",[scheduler._locate_event(i),t])}};scheduler.select=function(n){this._select_id!=n&&(this.editStop(!1),this.unselect(),this._select_id=n,this.updateEvent(n))};scheduler.unselect=function(n){if(!n||n==this._select_id){var t=this._select_id;this._select_id=null;t&&this.getEvent(t)&&this.updateEvent(t)}};scheduler.getState=function(){return{mode:this._mode,date:new Date(this._date),min_date:new Date(this._min_date),max_date:new Date(this._max_date),editor_id:this._edit_id,lightbox_id:this._lightbox_id,new_event:this._new_event,select_id:this._select_id,expanded:this.expanded,drag_id:this._drag_id,drag_mode:this._drag_mode}};scheduler._click={dhx_cal_data:function(n){var i,t,r;if(scheduler._ignore_next_click)return n.preventDefault&&n.preventDefault(),n.cancelBubble=!0,scheduler._ignore_next_click=!1,!1;if(i=n?n.target:event.srcElement,t=scheduler._locate_event(i),n=n||event,t){if(!scheduler.callEvent("onClick",[t,n])||scheduler.config.readonly)return}else scheduler.callEvent("onEmptyClick",[scheduler.getActionData(n).date,n]);t&&scheduler.config.select?(scheduler.select(t),r=i.className,r.indexOf("_icon")!=-1&&scheduler._click.buttons[r.split(" ")[1].replace("icon_","")](t)):(scheduler._close_not_saved(),scheduler.unselect())},dhx_cal_prev_button:function(){scheduler._click.dhx_cal_next_button(0,-1)},dhx_cal_next_button:function(n,t){scheduler.setCurrentView(scheduler.date.add(scheduler.date[scheduler._mode+"_start"](scheduler._date),t||1,scheduler._mode))},dhx_cal_today_button:function(){scheduler.callEvent("onBeforeTodayDisplayed",[])&&scheduler.setCurrentView(scheduler._currentDate())},dhx_cal_tab:function(){var n=this.getAttribute("name"),t=n.substring(0,n.search("_tab"));scheduler.setCurrentView(scheduler._date,t)},buttons:{"delete":function(n){var t=scheduler.locale.labels.confirm_deleting;scheduler._dhtmlx_confirm(t,scheduler.locale.labels.title_confirm_deleting,function(){scheduler.deleteEvent(n)})},edit:function(n){scheduler.edit(n)},save:function(){scheduler.editStop(!0)},details:function(n){scheduler.showLightbox(n)},cancel:function(){scheduler.editStop(!1)}}};scheduler._dhtmlx_confirm=function(n,t,i){if(!n)return i();var r={text:n};t&&(r.title=t);i&&(r.callback=function(n){n&&i()});dhtmlx.confirm(r)};scheduler.addEventNow=function(n,t,i){var r={},f,u,o,e;n&&n.constructor.toString().match(/object/i)!==null&&(r=n,n=null);f=(this.config.event_duration||this.config.time_step)*6e4;n||(n=r.start_date||Math.round(scheduler._currentDate().valueOf()/f)*f);u=new Date(n);t||(o=this.config.first_hour,o>u.getHours()&&(u.setHours(o),n=u.valueOf()),t=n.valueOf()+f);e=new Date(t);u.valueOf()==e.valueOf()&&e.setTime(e.valueOf()+f);r.start_date=r.start_date||u;r.end_date=r.end_date||e;r.text=r.text||this.locale.labels.new_event;r.id=this._drag_id=this.uid();this._drag_mode="new-size";this._loading=!0;this.addEvent(r);this.callEvent("onEventCreated",[this._drag_id,i]);this._loading=!1;this._drag_event={};this._on_mouse_up(i)};scheduler._on_dbl_click=function(n,t){var r,i,u;if(t=t||n.target||n.srcElement,!this.config.readonly){r=(t.className||"").split(" ")[0];switch(r){case"dhx_scale_holder":case"dhx_scale_holder_now":case"dhx_month_body":case"dhx_wa_day_data":if(!scheduler.config.dblclick_create)break;this.addEventNow(this.getActionData(n).date,null,n);break;case"dhx_cal_event":case"dhx_wa_ev_body":case"dhx_agenda_line":case"dhx_grid_event":case"dhx_cal_event_line":case"dhx_cal_event_clear":if(i=this._locate_event(t),!this.callEvent("onDblClick",[i,n]))return;this.config.details_on_dblclick||this._table_view||!this.getEvent(i)._timed||!this.config.select?this.showLightbox(i):this.edit(i);break;case"dhx_time_block":case"dhx_cal_container":return;default:if(u=this["dblclick_"+r],u)u.call(this,n);else if(t.parentNode&&t!=this)return scheduler._on_dbl_click(n,t.parentNode)}}};scheduler._get_column_index=function(n){var r=0,i,t;if(this._cols){for(i=0,t=0;t<this._cols.length&&!i;t++)i=this._cols[t];if(r=i?n/i:0,this._ignores)for(t=0;t<=r;t++)this._ignores[t]&&r++}return r};scheduler._week_indexes_from_pos=function(n){if(this._cols){var t=this._get_column_index(n.x);return n.x=Math.min(this._cols.length-1,Math.max(0,Math.ceil(t)-1)),n.y=Math.max(0,Math.ceil(n.y*60/(this.config.time_step*this.config.hour_size_px))-1)+this.config.first_hour*(60/this.config.time_step),n}return n};scheduler._mouse_coords=function(n){var t,r=document.body,e=document.documentElement,u,f,i;if(t=!_isIE&&(n.pageX||n.pageY)?{x:n.pageX,y:n.pageY}:{x:n.clientX+(r.scrollLeft||e.scrollLeft||0)-r.clientLeft,y:n.clientY+(r.scrollTop||e.scrollTop||0)-r.clientTop},t.x-=getAbsoluteLeft(this._obj)+(this._table_view?0:this.xy.scale_width),t.y-=getAbsoluteTop(this._obj)+this.xy.nav_height+(this._dy_shift||0)+this.xy.scale_height-this._els.dhx_cal_data[0].scrollTop,t.ev=n,u=this["mouse_"+this._mode],u)return u.call(this,t);if(this._table_view){if(f=this._get_column_index(t.x),!this._cols||!this._colsS)return t;for(i=0,i=1;i<this._colsS.heights.length;i++)if(this._colsS.heights[i]+12>t.y)break;t.y=Math.ceil((Math.max(0,f)+Math.max(0,i-1)*7)*1440/this.config.time_step);(scheduler._drag_mode||this._mode=="month")&&(t.y=(Math.max(0,Math.ceil(f)-1)+Math.max(0,i-1)*7)*1440/this.config.time_step);this._drag_mode=="move"&&scheduler._ignores_detected&&scheduler.config.preserve_length&&(t._ignores=!0,this._drag_event._event_length||(this._drag_event._event_length=this._get_real_event_length(this._drag_event.start_date,this._drag_event.end_date,{x_step:1,x_unit:"day"})));t.x=0}else t=this._week_indexes_from_pos(t);return t};scheduler._close_not_saved=function(){if((new Date).valueOf()-(scheduler._new_event||0)>500&&scheduler._edit_id){var n=scheduler.locale.labels.confirm_closing;scheduler._dhtmlx_confirm(n,scheduler.locale.labels.title_confirm_closing,function(){scheduler.editStop(scheduler.config.positive_closing)})}};scheduler._correct_shift=function(n,t){return n-(new Date(scheduler._min_date).getTimezoneOffset()-new Date(n).getTimezoneOffset())*6e4*(t?-1:1)};scheduler._on_mouse_move=function(n){var i,r,t,y,l,o,f,a,e,v,u,h,c,s,p,w;if(this._drag_mode){if(i=this._mouse_coords(n),!this._drag_pos||i.force_redraw||this._drag_pos.x!=i.x||this._drag_pos.y!=i.y){if(this._edit_id!=this._drag_id&&this._close_not_saved(),this._drag_pos=i,this._drag_mode=="create"){if(this._close_not_saved(),this.unselect(this._select_id),this._loading=!0,r=this._get_date_from_pos(i).valueOf(),!this._drag_start){if(y=this.callEvent("onBeforeEventCreated",[n,this._drag_id]),!y)return;this._drag_start=r;return}t=r;t==this._drag_start;l=new Date(this._drag_start);o=new Date(t);(this._mode=="day"||this._mode=="week")&&l.getHours()==o.getHours()&&l.getMinutes()==o.getMinutes()&&(o=new Date(this._drag_start+1e3));this._drag_id=this.uid();this.addEvent(l,o,this.locale.labels.new_event,this._drag_id,i.fields);this.callEvent("onEventCreated",[this._drag_id,n]);this._loading=!1;this._drag_mode="new-size"}f=this.getEvent(this._drag_id);this._drag_mode=="move"?(r=this._min_date.valueOf()+(i.y*this.config.time_step+i.x*1440-(scheduler._move_pos_shift||0))*6e4,!i.custom&&this._table_view&&(r+=this.date.time_part(f.start_date)*1e3),r=this._correct_shift(r),i._ignores&&this.config.preserve_length&&this._table_view?(this.matrix&&(a=this.matrix[this._mode]),a=a||{x_step:1,x_unit:"day"},t=r*1+this._get_fictional_event_length(r,this._drag_event._event_length,a)):t=f.end_date.valueOf()-(f.start_date.valueOf()-r)):(r=f.start_date.valueOf(),t=f.end_date.valueOf(),this._table_view?(e=this._min_date.valueOf()+i.y*this.config.time_step*6e4+(i.custom?0:864e5),this._mode=="month"?(e=this._correct_shift(e,!1),this._drag_from_start?(s=864e5,e<=scheduler.date.date_part(new Date(t+s-1)).valueOf()&&(r=e-s)):t=e):i.resize_from_start?r=e:t=e):(t=this.date.date_part(new Date(f.end_date.valueOf()-1)).valueOf()+i.y*this.config.time_step*6e4,this._els.dhx_cal_data[0].style.cursor="s-resize",(this._mode=="week"||this._mode=="day")&&(t=this._correct_shift(t))),this._drag_mode=="new-size"?t<=this._drag_start?(v=i.shift||(this._table_view&&!i.custom?864e5:0),r=t-(i.shift?0:v),t=this._drag_start+(v||this.config.time_step*6e4)):r=this._drag_start:t<=r&&(t=r+this.config.time_step*6e4));h=new Date(t-1);u=new Date(r);scheduler.config.limit_drag_out&&(+u<+scheduler._min_date||+t>+scheduler._max_date)&&(c=t-u,+u<+scheduler._min_date?(u=new Date(scheduler._min_date),t=new Date(+u+c)):(t=new Date(scheduler._max_date),u=new Date(+t-c)),h=new Date(t-1));!this._table_view&&(i.x!=this._get_event_sday({start_date:new Date(t),end_date:new Date(t)})||new Date(t).getHours()>=this.config.last_hour)&&(c=t-u,s=this._min_date.valueOf()+i.x*864e5,t=scheduler.date.date_part(new Date(s)),t.setHours(this.config.last_hour),h=new Date(t-1),this._drag_mode=="move"&&(u=new Date(+t-c)));(this._table_view||h.getDate()==u.getDate()&&h.getHours()<this.config.last_hour||scheduler._allow_dnd)&&(f.start_date=u,f.end_date=new Date(t),this.config.update_render?(p=scheduler._els.dhx_cal_data[0].scrollTop,this.update_view(),scheduler._els.dhx_cal_data[0].scrollTop=p):this.updateEvent(this._drag_id));this._table_view&&this.for_rendered(this._drag_id,function(n){n.className+=" dhx_in_move"});this.callEvent("onEventDrag",[this._drag_id,this._drag_mode,n])}}else scheduler.checkEvent("onMouseMove")&&(w=this._locate_event(n.target||n.srcElement),this.callEvent("onMouseMove",[w,n]))};scheduler._on_mouse_down=function(n,t){var i,r;if(n.button!=2&&!this.config.readonly&&!this._drag_mode){t=t||n.target||n.srcElement;i=t.className&&t.className.split(" ")[0];switch(i){case"dhx_cal_event_line":case"dhx_cal_event_clear":this._table_view&&(this._drag_mode="move");break;case"dhx_event_move":case"dhx_wa_ev_body":this._drag_mode="move";break;case"dhx_event_resize":this._drag_mode="resize";scheduler._drag_from_start=(t.className||"").indexOf("dhx_event_resize_end")<0?!0:!1;break;case"dhx_scale_holder":case"dhx_scale_holder_now":case"dhx_month_body":case"dhx_matrix_cell":case"dhx_marked_timespan":this._drag_mode="create";break;case"":if(t.parentNode)return scheduler._on_mouse_down(n,t.parentNode);break;default:if((!scheduler.checkEvent("onMouseDown")||scheduler.callEvent("onMouseDown",[i]))&&t.parentNode&&t!=this&&i!="dhx_body")return scheduler._on_mouse_down(n,t.parentNode);this._drag_mode=null;this._drag_id=null}this._drag_mode&&(r=this._locate_event(t),this.config["drag_"+this._drag_mode]&&this.callEvent("onBeforeDrag",[r,this._drag_mode,n])?(this._drag_id=r,this._drag_event=scheduler._lame_clone(this.getEvent(this._drag_id)||{})):this._drag_mode=this._drag_id=0);this._drag_start=null}};scheduler._get_private_properties=function(n){var t={};for(var i in n)i.indexOf("_")===0&&(t[i]=!0);return t};scheduler._clear_temporary_properties=function(n,t){var r=this._get_private_properties(n),u=this._get_private_properties(t);for(var i in u)r[i]||delete t[i]};scheduler._on_mouse_up=function(n){var t,r,i,u;if(!n||n.button!=2||!scheduler.config.touch){if(this._drag_mode&&this._drag_id){if(this._els.dhx_cal_data[0].style.cursor="default",t=this.getEvent(this._drag_id),this._drag_event._dhx_changed||!this._drag_event.start_date||t.start_date.valueOf()!=this._drag_event.start_date.valueOf()||t.end_date.valueOf()!=this._drag_event.end_date.valueOf())if(r=this._drag_mode=="new-size",this.callEvent("onBeforeEventChanged",[t,n,r,this._drag_event]))if(i=this._drag_id,u=this._drag_mode,this._drag_id=this._drag_mode=null,r&&this.config.edit_on_create){if(this.unselect(),this._new_event=new Date,this._table_view||this.config.details_on_create||!this.config.select)return scheduler.callEvent("onDragEnd",[i,u,n]),this.showLightbox(i);this._drag_pos=!0;this._select_id=this._edit_id=i}else this._new_event||this.callEvent(r?"onEventAdded":"onEventChanged",[i,this.getEvent(i)]);else r?this.deleteEvent(t.id,!0):(this._drag_event._dhx_changed=!1,this._clear_temporary_properties(t,this._drag_event),scheduler._lame_copy(t,this._drag_event),this.updateEvent(t.id));this._drag_pos&&this.render_view_data();scheduler.callEvent("onDragEnd",[this._drag_id,this._drag_mode,n])}this._drag_id=null;this._drag_mode=null;this._drag_pos=null}};scheduler._trigger_dyn_loading=function(){return this._load_mode&&this._load()?(this._render_wait=!0,!0):!1};scheduler.update_view=function(){var n=this[this._mode+"_view"];if(n?n(!0):this._reset_scale(),this._trigger_dyn_loading())return!0;this.render_view_data()};scheduler.isViewExists=function(n){return!!(scheduler[n+"_view"]||scheduler.date[n+"_start"]&&scheduler.templates[n+"_date"]&&scheduler.templates[n+"_scale_date"])};scheduler.updateView=function(n,t){var e,o,f,i,r,u;if(n=n||this._date,t=t||this._mode,e="dhx_cal_data",this._mode?this._obj.className=this._obj.className.replace("dhx_scheduler_"+this._mode,"dhx_scheduler_"+t):this._obj.className+=" dhx_scheduler_"+t,o=this._mode==t&&this.config.preserve_scroll?this._els[e][0].scrollTop:!1,this[this._mode+"_view"]&&t&&this._mode!=t&&this[this._mode+"_view"](!1),this._close_not_saved(),f="dhx_multi_day",this._els[f]&&(this._els[f][0].parentNode.removeChild(this._els[f][0]),this._els[f]=null),this._mode=t,this._date=n,this._table_view=this._mode=="month",this._dy_shift=0,i=this._els.dhx_cal_tab,i)for(r=0;r<i.length;r++)u=i[r].className,u=u.replace(/ active/g,""),i[r].getAttribute("name")==this._mode+"_tab"&&(u=u+" active"),i[r].className=u;this.update_view();typeof o=="number"&&(this._els[e][0].scrollTop=o)};scheduler.setCurrentView=function(n,t){this.callEvent("onBeforeViewChange",[this._mode,this._date,t||this._mode,n||this._date])&&(this.updateView(n,t),this.callEvent("onViewChange",[this._mode,this._date]))};scheduler._render_x_header=function(n,t,i,r){var u=document.createElement("DIV"),f;u.className="dhx_scale_bar";this.templates[this._mode+"_scalex_class"]&&(u.className+=" "+this.templates[this._mode+"_scalex_class"](i));f=this._cols[n]-1;this._mode=="month"&&n===0&&this.config.left_border&&(u.className+=" dhx_scale_bar_border",t=t+1);this.set_xy(u,f,this.xy.scale_height-2,t,0);u.innerHTML=this.templates[this._mode+"_scale_date"](i,this._mode);r.appendChild(u)};scheduler._get_columns_num=function(n,t){var r=7,i;return scheduler._table_view||(i=scheduler.date["get_"+scheduler._mode+"_end"],i&&(t=i(n)),r=Math.round((t.valueOf()-n.valueOf())/864e5)),r};scheduler._get_timeunit_start=function(){return this.date[this._mode+"_start"](new Date(this._date.valueOf()))};scheduler._get_view_end=function(){var t=this._get_timeunit_start(),i=scheduler.date.add(t,1,this._mode),n;return scheduler._table_view||(n=scheduler.date["get_"+scheduler._mode+"_end"],n&&(i=n(t))),i};scheduler._calc_scale_sizes=function(n,t,i){var e=n,u=this._get_columns_num(t,i),f,r;for(this._process_ignores(t,u,"day",1),f=u-this._ignores_detected,r=0;r<u;r++)this._ignores[r]?(this._cols[r]=0,f++):this._cols[r]=Math.floor(e/(f-r)),e-=this._cols[r],this._colsS[r]=(this._cols[r-1]||0)+(this._colsS[r-1]||(this._table_view?0:this.xy.scale_width+2)),this._colsS.col_length=u;this._colsS[u]=this._cols[u-1]+this._colsS[u-1]};scheduler._set_scale_col_size=function(n,t,i){var r=this.config;this.set_xy(n,t-1,r.hour_size_px*(r.last_hour-r.first_hour),i+this.xy.scale_width+1,0)};scheduler._render_scales=function(n,t){var o=new Date(scheduler._min_date),s=new Date(scheduler._max_date),h=this.date.date_part(scheduler._currentDate()),c=parseInt(n.style.width,10),r=new Date(this._min_date),l=this._get_columns_num(o,s),f,i,u,e;for(this._calc_scale_sizes(c,o,s),f=0,n.innerHTML="",i=0;i<l;i++)this._ignores[i]||this._render_x_header(i,f,r,n),this._table_view||(u=document.createElement("DIV"),e="dhx_scale_holder",r.valueOf()==h.valueOf()&&(e="dhx_scale_holder_now"),this._ignores_detected&&this._ignores[i]&&(e+=" dhx_scale_ignore"),u.className=e+" "+this.templates.week_date_class(r,h),this._set_scale_col_size(u,this._cols[i],f),t.appendChild(u),this.callEvent("onScaleAdd",[u,r])),f+=this._cols[i],r=this.date.add(r,1,"day")};scheduler._reset_scale=function(){var h,c,e,r,o,n,u;if(this.templates[this._mode+"_date"]){var s=this._els.dhx_cal_header[0],t=this._els.dhx_cal_data[0],f=this.config;if(s.innerHTML="",t.innerHTML="",h=(f.readonly||!f.drag_resize?" dhx_resize_denied":"")+(f.readonly||!f.drag_move?" dhx_move_denied":""),t.className="dhx_cal_data"+h,this._scales={},this._cols=[],this._colsS={height:0},this._dy_shift=0,this.set_sizes(),r=this._get_timeunit_start(),o=scheduler._get_view_end(),c=e=this._table_view?scheduler.date.week_start(r):r,this._min_date=c,this._els.dhx_cal_date[0].innerHTML=this._mode=="day"?"":this.templates[this._mode+"_date"](r,o,this._mode),this._max_date=o,scheduler._render_scales(s,t),this._table_view)this._reset_month_scale(t,r,e);else if(this._reset_hours_scale(t,r,e),f.multi_day){n="dhx_multi_day";this._els[n]&&(this._els[n][0].parentNode.removeChild(this._els[n][0]),this._els[n]=null);var a=this._els.dhx_cal_navline[0],l=a.offsetHeight+this._els.dhx_cal_header[0].offsetHeight+1,i=document.createElement("DIV");i.className=n;i.style.visibility="hidden";this.set_xy(i,this._colsS[this._colsS.col_length]+this.xy.scroll_width,0,0,l);t.parentNode.insertBefore(i,t);u=i.cloneNode(!0);u.className=n+"_icon";u.style.visibility="hidden";this.set_xy(u,this.xy.scale_width,0,0,l);i.appendChild(u);this._els[n]=[i,u];this._els[n][0].onclick=this._click.dhx_cal_data}}};scheduler._reset_hours_scale=function(n){var u=document.createElement("DIV"),i,f,t,r;for(u.className="dhx_scale_holder",i=new Date(1980,1,1,this.config.first_hour,0,0),f=this.config.first_hour*1;f<this.config.last_hour;f++)t=document.createElement("DIV"),t.className="dhx_scale_hour",t.style.height=this.config.hour_size_px-(this._quirks?0:1)+"px",r=this.xy.scale_width,this.config.left_border&&(r=r-1,t.className+=" dhx_scale_hour_border"),t.style.width=r+"px",t.innerHTML=scheduler.templates.hour_scale(i),u.appendChild(t),i=this.date.add(i,1,"hour");n.appendChild(u);this.config.scroll_hour&&(n.scrollTop=this.config.hour_size_px*(this.config.scroll_hour-this.config.first_hour))};scheduler._currentDate=function(){return scheduler.config.now_date?new Date(scheduler.config.now_date):new Date};scheduler._process_ignores=function(n,t,i,r,u){var o,f,e;if(this._ignores={},this._ignores_detected=0,o=scheduler["ignore_"+this._mode],o)for(f=new Date(n),e=0;e<t;e++)o(f)&&(this._ignores_detected+=1,this._ignores[e]=!0,u&&t++),f=scheduler.date.add(f,r,i)};scheduler._render_month_scale=function(n,t,i){function b(n){var t=scheduler._colsS.height;return scheduler._colsS.heights[n+1]!==undefined&&(t=scheduler._colsS.heights[n+1]-(scheduler._colsS.heights[n]||0)),t}var p=scheduler.date.add(t,1,"month"),nt=new Date(i),c=scheduler._currentDate(),w,l,h,d,f,e,a,v,y,g,n,r,s;for(this.date.date_part(c),this.date.date_part(i),w=Math.ceil(Math.round((p.valueOf()-i.valueOf())/864e5)/7),l=[],r=0;r<=7;r++)h=(this._cols[r]||0)-1,r===0&&this.config.left_border&&(h=h-1),l[r]=" style='width:"+h+"px;";var k=0,u="<table cellpadding='0' cellspacing='0'>",o=[];for(r=0;r<w;r++){for(u+="<tr>",d=Math.max(b(r)-scheduler.xy.month_head_height,0),f=0;f<7;f++)u+="<td",e="",i<t?e="dhx_before":i>=p?e="dhx_after":i.valueOf()==c.valueOf()&&(e="dhx_now"),this._ignores_detected&&this._ignores[f]&&(e+=" dhx_scale_ignore"),u+=" class='"+e+" "+this.templates.month_date_class(i,c)+"' >",a="dhx_month_body",v="dhx_month_head",f===0&&this.config.left_border&&(a+=" dhx_month_body_border",v+=" dhx_month_head_border"),this._ignores_detected&&this._ignores[f]?u+="<div><\/div><div><\/div>":(u+="<div class='"+v+"'>"+this.templates.month_day(i)+"<\/div>",u+="<div class='"+a+"' "+l[f]+";height:"+d+"px;'><\/div><\/td>"),o.push(i),y=i.getDate(),i=this.date.add(i,1,"day"),i.getDate()-y>1&&(i=new Date(i.getFullYear(),i.getMonth(),y+1,12,0));u+="<\/tr>";scheduler._colsS.heights[r]=k;k+=b(r)}for(u+="<\/table>",this._min_date=nt,this._max_date=i,n.innerHTML=u,this._scales={},g=n.getElementsByTagName("div"),r=0;r<o.length;r++)n=g[r*2+1],s=o[r],this._scales[+s]=n;for(r=0;r<o.length;r++)s=o[r],this.callEvent("onScaleAdd",[this._scales[+s],s]);return this._max_date};scheduler._reset_month_scale=function(n,t,i){var f=scheduler.date.add(t,1,"month"),e=scheduler._currentDate(),r,u;return this.date.date_part(e),this.date.date_part(i),r=Math.ceil(Math.round((f.valueOf()-i.valueOf())/864e5)/7),u=Math.floor(n.clientHeight/r)-this.xy.month_head_height,this._colsS.height=u+this.xy.month_head_height,this._colsS.heights=[],scheduler._render_month_scale(n,t,i)};scheduler.getLabel=function(n,t){for(var u,i,f=this.config.lightbox.sections,r=0;r<f.length;r++)if(f[r].map_to==n)for(u=f[r].options,i=0;i<u.length;i++)if(u[i].key==t)return u[i].label;return""};scheduler.updateCollection=function(n,t){var i=scheduler.serverList(n);return i?(i.splice(0,i.length),i.push.apply(i,t||[]),scheduler.callEvent("onOptionsLoad",[]),scheduler.resetLightbox(),!0):!1};scheduler._lame_clone=function(n,t){var i,r,u;for(t=t||[],i=0;i<t.length;i+=2)if(n===t[i])return t[i+1];if(n&&typeof n=="object"){for(u={},r=[Array,Date,Number,String,Boolean],i=0;i<r.length;i++)n instanceof r[i]&&(u=i?new r[i](n):new r[i]);t.push(n,u);for(i in n)Object.prototype.hasOwnProperty.apply(n,[i])&&(u[i]=scheduler._lame_clone(n[i],t))}return u||n};scheduler._lame_copy=function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);return n};scheduler._get_date_from_pos=function(n){var t=this._min_date.valueOf()+(n.y*this.config.time_step+(this._table_view?0:n.x)*1440)*6e4;return new Date(this._correct_shift(t))};scheduler.getActionData=function(n){var t=this._mouse_coords(n);return{date:this._get_date_from_pos(t),section:t.section}};scheduler._focus=function(n,t){n&&n.focus&&(this.config.touch?window.setTimeout(function(){n.focus()},100):(t&&n.select&&n.select(),n.focus()))};scheduler._get_real_event_length=function(n,t,i){var u=t-n,s=i._start_correction+i._end_correction||0,e=this["ignore_"+this._mode],o=0,r,f;for(i.render?(o=this._get_date_index(i,n),r=this._get_date_index(i,t)):r=Math.round(u/864e5);o<r;)f=scheduler.date.add(t,-i.x_step,i.x_unit),u-=e&&e(t)?t-f:s,t=f,r--;return u};scheduler._get_fictional_event_length=function(n,t,i,r){var u=new Date(n),f=r?-1:1,c,o,l,h;(i._start_correction||i._end_correction)&&(c=r?u.getHours()*60+u.getMinutes()-(i.first_hour||0)*60:(i.last_hour||0)*60-(u.getHours()*60+u.getMinutes()),o=(i.last_hour-i.first_hour)*60,l=Math.ceil((t/6e4-c)/o),t+=l*(1440-o)*6e4);var v=new Date(n*1+t*f),a=this["ignore_"+this._mode],s=0,e;for(i.render?(s=this._get_date_index(i,u),e=this._get_date_index(i,v)):e=Math.round(t/864e5);s*f<=e*f;)h=scheduler.date.add(u,i.x_step*f,i.x_unit),a&&a(u)&&(t+=(h-u)*f,e+=f),u=h,s+=f;return t};scheduler._get_section_view=function(){return this.matrix&&this.matrix[this._mode]?this.matrix[this._mode]:this._props&&this._props[this._mode]?this._props[this._mode]:null};scheduler._get_section_property=function(){return this.matrix&&this.matrix[this._mode]?this.matrix[this._mode].y_property:this._props&&this._props[this._mode]?this._props[this._mode].map_to:null};scheduler._is_initialized=function(){var n=this.getState();return this._obj&&n.date&&n.mode};scheduler._is_lightbox_open=function(){var n=this.getState();return n.lightbox_id!==null&&n.lightbox_id!==undefined};scheduler.date={init:function(){for(var t=scheduler.locale.date.month_short,i=scheduler.locale.date.month_short_hash={},n=0;n<t.length;n++)i[t[n]]=n;for(t=scheduler.locale.date.month_full,i=scheduler.locale.date.month_full_hash={},n=0;n<t.length;n++)i[t[n]]=n},date_part:function(n){return n.setHours(0),n.setMinutes(0),n.setSeconds(0),n.setMilliseconds(0),n.getHours()!==0&&n.setTime(n.getTime()+36e5*(24-n.getHours())),n},time_part:function(n){return(n.valueOf()/1e3-n.getTimezoneOffset()*60)%86400},week_start:function(n){var t=n.getDay();return scheduler.config.start_on_monday&&(t===0?t=6:t--),this.date_part(this.add(n,-1*t,"day"))},month_start:function(n){return n.setDate(1),this.date_part(n)},year_start:function(n){return n.setMonth(0),this.month_start(n)},day_start:function(n){return this.date_part(n)},_add_days:function(n,t){var i=new Date(n.valueOf());return i.setDate(i.getDate()+t),!n.getHours()&&i.getHours()&&i.setTime(i.getTime()+36e5*(24-i.getHours())),i},add:function(n,t,i){var r=new Date(n.valueOf());switch(i){case"day":r=scheduler.date._add_days(r,t);break;case"week":r=scheduler.date._add_days(r,t*7);break;case"month":r.setMonth(r.getMonth()+t);break;case"year":r.setYear(r.getFullYear()+t);break;case"hour":r.setHours(r.getHours()+t);break;case"minute":r.setMinutes(r.getMinutes()+t);break;default:return scheduler.date["add_"+i](n,t,i)}return r},to_fixed:function(n){return n<10?"0"+n:n},copy:function(n){return new Date(n.valueOf())},date_to_str:function(n,t){return n=n.replace(/%[a-zA-Z]/g,function(n){switch(n){case"%d":return'"+scheduler.date.to_fixed(date.getDate())+"';case"%m":return'"+scheduler.date.to_fixed((date.getMonth()+1))+"';case"%j":return'"+date.getDate()+"';case"%n":return'"+(date.getMonth()+1)+"';case"%y":return'"+scheduler.date.to_fixed(date.getFullYear()%100)+"';case"%Y":return'"+date.getFullYear()+"';case"%D":return'"+scheduler.locale.date.day_short[date.getDay()]+"';case"%l":return'"+scheduler.locale.date.day_full[date.getDay()]+"';case"%M":return'"+scheduler.locale.date.month_short[date.getMonth()]+"';case"%F":return'"+scheduler.locale.date.month_full[date.getMonth()]+"';case"%h":return'"+scheduler.date.to_fixed((date.getHours()+11)%12+1)+"';case"%g":return'"+((date.getHours()+11)%12+1)+"';case"%G":return'"+date.getHours()+"';case"%H":return'"+scheduler.date.to_fixed(date.getHours())+"';case"%i":return'"+scheduler.date.to_fixed(date.getMinutes())+"';case"%a":return'"+(date.getHours()>11?"pm":"am")+"';case"%A":return'"+(date.getHours()>11?"PM":"AM")+"';case"%s":return'"+scheduler.date.to_fixed(date.getSeconds())+"';case"%W":return'"+scheduler.date.to_fixed(scheduler.date.getISOWeek(date))+"';default:return n}}),t&&(n=n.replace(/date\.get/g,"date.getUTC")),new Function("date",'return "'+n+'";')},str_to_date:function(n,t){for(var u,r="var temp=date.match(/[a-zA-Z]+|[0-9]+/g);",f=n.match(/%[a-zA-Z]/g),i=0;i<f.length;i++)switch(f[i]){case"%j":case"%d":r+="set[2]=temp["+i+"]||1;";break;case"%n":case"%m":r+="set[1]=(temp["+i+"]||1)-1;";break;case"%y":r+="set[0]=temp["+i+"]*1+(temp["+i+"]>50?1900:2000);";break;case"%g":case"%G":case"%h":case"%H":r+="set[3]=temp["+i+"]||0;";break;case"%i":r+="set[4]=temp["+i+"]||0;";break;case"%Y":r+="set[0]=temp["+i+"]||0;";break;case"%a":case"%A":r+="set[3]=set[3]%12+((temp["+i+"]||'').toLowerCase()=='am'?0:12);";break;case"%s":r+="set[5]=temp["+i+"]||0;";break;case"%M":r+="set[1]=scheduler.locale.date.month_short_hash[temp["+i+"]]||0;";break;case"%F":r+="set[1]=scheduler.locale.date.month_full_hash[temp["+i+"]]||0;"}return u="set[0],set[1],set[2],set[3],set[4],set[5]",t&&(u=" Date.UTC("+u+")"),new Function("date","var set=[0,0,1,0,0,0]; "+r+" return new Date("+u+");")},getISOWeek:function(n){var t,i;if(!n)return!1;t=n.getDay();t===0&&(t=7);i=new Date(n.valueOf());i.setDate(n.getDate()+(4-t));var r=i.getFullYear(),u=Math.round((i.getTime()-new Date(r,0,1).getTime())/864e5);return 1+Math.floor(u/7)},getUTCISOWeek:function(n){return this.getISOWeek(this.convert_to_utc(n))},convert_to_utc:function(n){return new Date(n.getUTCFullYear(),n.getUTCMonth(),n.getUTCDate(),n.getUTCHours(),n.getUTCMinutes(),n.getUTCSeconds())}};scheduler.locale={date:{month_full:["January","February","March","April","May","June","July","August","September","October","November","December"],month_short:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],day_full:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],day_short:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},labels:{dhx_cal_today_button:"Today",day_tab:"Day",week_tab:"Week",month_tab:"Month",new_event:"New event",icon_save:"Save",icon_cancel:"Cancel",icon_details:"Details",icon_edit:"Edit",icon_delete:"Delete",confirm_closing:"",confirm_deleting:"Event will be deleted permanently, are you sure?",section_description:"Description",section_time:"Time period",full_day:"Full day",confirm_recurring:"Do you want to edit the whole set of repeated events?",section_recurring:"Repeat event",button_recurring:"Disabled",button_recurring_open:"Enabled",button_edit_series:"Edit series",button_edit_occurrence:"Edit occurrence",agenda_tab:"Agenda",date:"Date",description:"Description",year_tab:"Year",week_agenda_tab:"Agenda",grid_tab:"Grid",drag_to_create:"Drag to create",drag_to_move:"Drag to move",message_ok:"OK",message_cancel:"Cancel"}};scheduler.config={default_date:"%j %M %Y",month_date:"%F %Y",load_date:"%Y-%m-%d",week_date:"%l",day_date:"%D, %F %j",hour_date:"%H:%i",month_day:"%d",xml_date:"%m/%d/%Y %H:%i",api_date:"%d-%m-%Y %H:%i",preserve_length:!0,time_step:5,start_on_monday:1,first_hour:0,last_hour:24,readonly:!1,drag_resize:1,drag_move:1,drag_create:1,dblclick_create:1,edit_on_create:1,details_on_create:0,resize_month_events:!1,resize_month_timed:!1,cascade_event_display:!1,cascade_event_count:4,cascade_event_margin:30,multi_day:!0,multi_day_height_limit:0,drag_lightbox:!0,preserve_scroll:!0,select:!0,server_utc:!1,touch:!0,touch_tip:!0,touch_drag:500,quick_info_detached:!0,positive_closing:!1,drag_highlight:!0,limit_drag_out:!1,icons_edit:["icon_save","icon_cancel"],icons_select:["icon_details","icon_edit","icon_delete"],buttons_left:["dhx_save_btn","dhx_cancel_btn"],buttons_right:["dhx_delete_btn"],lightbox:{sections:[{name:"description",height:200,map_to:"text",type:"textarea",focus:!0},{name:"time",height:72,type:"time",map_to:"auto"}]},highlight_displayed_event:!0,left_border:!1};scheduler.templates={};scheduler.init_templates=function(){var i=scheduler.locale.labels;i.dhx_save_btn=i.icon_save;i.dhx_cancel_btn=i.icon_cancel;i.dhx_delete_btn=i.icon_delete;var t=scheduler.date.date_to_str,n=scheduler.config,r=function(n,t){for(var i in t)n[i]||(n[i]=t[i])};r(scheduler.templates,{day_date:t(n.default_date),month_date:t(n.month_date),week_date:function(n,t){return scheduler.templates.day_date(n)+" &ndash; "+scheduler.templates.day_date(scheduler.date.add(t,-1,"day"))},day_scale_date:t(n.default_date),month_scale_date:t(n.week_date),week_scale_date:t(n.day_date),hour_scale:t(n.hour_date),time_picker:t(n.hour_date),event_date:t(n.hour_date),month_day:t(n.month_day),xml_date:scheduler.date.str_to_date(n.xml_date,n.server_utc),load_format:t(n.load_date,n.server_utc),xml_format:t(n.xml_date,n.server_utc),api_date:scheduler.date.str_to_date(n.api_date),event_header:function(n,t){return scheduler.templates.event_date(n)+" - "+scheduler.templates.event_date(t)},event_text:function(n,t,i){return i.text},event_class:function(){return""},month_date_class:function(){return""},week_date_class:function(){return""},event_bar_date:function(n){return scheduler.templates.event_date(n)+" "},event_bar_text:function(n,t,i){return i.text},month_events_link:function(n,t){return"<a>View more("+t+" events)<\/a>"},drag_marker_class:function(){return""},drag_marker_content:function(){return""}});this.callEvent("onTemplatesReady",[])};scheduler.uid=function(){return this._seed||(this._seed=(new Date).valueOf()),this._seed++};scheduler._events={};scheduler.clearAll=function(){this._events={};this._loaded={};this.clear_view();this.callEvent("onClearAll",[])};scheduler.addEvent=function(n,t,i,r,u){var f,e,o;return arguments.length?(f=n,arguments.length!=1&&(f=u||{},f.start_date=n,f.end_date=t,f.text=i,f.id=r),f.id=f.id||scheduler.uid(),f.text=f.text||"",typeof f.start_date=="string"&&(f.start_date=this.templates.api_date(f.start_date)),typeof f.end_date=="string"&&(f.end_date=this.templates.api_date(f.end_date)),e=(this.config.event_duration||this.config.time_step)*6e4,f.start_date.valueOf()==f.end_date.valueOf()&&f.end_date.setTime(f.end_date.valueOf()+e),f._timed=this.isOneDayEvent(f),o=!this._events[f.id],this._events[f.id]=f,this.event_updated(f),this._loading||this.callEvent(o?"onEventAdded":"onEventChanged",[f.id,f]),f.id):this.addEventNow()};scheduler.deleteEvent=function(n,t){var i=this._events[n];(t||this.callEvent("onBeforeEventDelete",[n,i])&&this.callEvent("onConfirmedBeforeEventDelete",[n,i]))&&(i&&(this._select_id=null,delete this._events[n],this.event_updated(i)),this.callEvent("onEventDeleted",[n,i]))};scheduler.getEvent=function(n){return this._events[n]};scheduler.setEvent=function(n,t){t.id||(t.id=n);this._events[n]=t};scheduler.for_rendered=function(n,t){for(var i=this._rendered.length-1;i>=0;i--)this._rendered[i].getAttribute("event_id")==n&&t(this._rendered[i],i)};scheduler.changeEventId=function(n,t){if(n!=t){var i=this._events[n];i&&(i.id=t,this._events[t]=i,delete this._events[n]);this.for_rendered(n,function(n){n.setAttribute("event_id",t)});this._select_id==n&&(this._select_id=t);this._edit_id==n&&(this._edit_id=t);this.callEvent("onEventIdChange",[n,t])}},function(){for(var t=["text","Text","start_date","StartDate","end_date","EndDate"],i=function(n){return function(t){return scheduler.getEvent(t)[n]}},r=function(n){return function(t,i){var r=scheduler.getEvent(t);r[n]=i;r._changed=!0;r._timed=this.isOneDayEvent(r);scheduler.event_updated(r,!0)}},n=0;n<t.length;n+=2)scheduler["getEvent"+t[n+1]]=i(t[n]),scheduler["setEvent"+t[n+1]]=r(t[n])}();scheduler.event_updated=function(n){this.is_visible_events(n)?this.render_view_data():this.clear_event(n.id)};scheduler.is_visible_events=function(n){var u=n.start_date<this._max_date&&this._min_date<n.end_date,t,i,r;return u?(t=n.end_date.getHours()>=this.config.first_hour&&n.end_date.getHours()<this.config.last_hour||n.start_date.getHours()>=this.config.first_hour&&n.start_date.getHours()<this.config.last_hour,t?!0:(i=(n.end_date.valueOf()-n.start_date.valueOf())/36e5,r=24-(this.config.last_hour-this.config.first_hour),i>r)):!1};scheduler.isOneDayEvent=function(n){var t=n.end_date.getDate()-n.start_date.getDate();return t?(t<0&&(t=Math.ceil((n.end_date.valueOf()-n.start_date.valueOf())/864e5)),t==1&&!n.end_date.getHours()&&!n.end_date.getMinutes()&&(n.start_date.getHours()||n.start_date.getMinutes())):n.start_date.getMonth()==n.end_date.getMonth()&&n.start_date.getFullYear()==n.end_date.getFullYear()};scheduler.get_visible_events=function(n){var i=[];for(var t in this._events)this.is_visible_events(this._events[t])&&(!n||this._events[t]._timed)&&this.filter_event(t,this._events[t])&&i.push(this._events[t]);return i};scheduler.filter_event=function(n,t){var i=this["filter_"+this._mode];return i?i(n,t):!0};scheduler._is_main_area_event=function(n){return!!n._timed};scheduler.render_view_data=function(n,t){var f,r,u,i;if(!n){if(this._not_render){this._render_wait=!0;return}this._render_wait=!1;this.clear_view();n=this.get_visible_events(!(this._table_view||this.config.multi_day))}for(i=0,f=n.length;i<f;i++)this._recalculate_timed(n[i]);if(this.config.multi_day&&!this._table_view){for(r=[],u=[],i=0;i<n.length;i++)this._is_main_area_event(n[i])?r.push(n[i]):u.push(n[i]);this._rendered_location=this._els.dhx_multi_day[0];this._table_view=!0;this.render_data(u,t);this._table_view=!1;this._rendered_location=this._els.dhx_cal_data[0];this._table_view=!1;this.render_data(r,t)}else this._rendered_location=this._els.dhx_cal_data[0],this.render_data(n,t)};scheduler._view_month_day=function(n){var t=scheduler.getActionData(n).date;scheduler.callEvent("onViewMoreClick",[t])&&scheduler.setCurrentView(t,"day")};scheduler._render_month_link=function(n){for(var f,t,o=this._rendered_location,r=this._lame_clone(n),u=n._sday;u<n._eday;u++){r._sday=u;r._eday=u+1;f=scheduler.date;t=scheduler._min_date;t=f.add(t,r._sweek,"week");t=f.add(t,r._sday,"day");var s=scheduler.getEvents(t,f.add(t,1,"day")).length,e=this._get_event_bar_pos(r),h=e.x2-e.x,i=document.createElement("div");i.onclick=function(n){scheduler._view_month_day(n||event)};i.className="dhx_month_link";i.style.top=e.y+"px";i.style.left=e.x+"px";i.style.width=h-14+"px";i.innerHTML=scheduler.templates.month_events_link(t,s);this._rendered.push(i);o.appendChild(i)}};scheduler._recalculate_timed=function(n){if(n){var t;(t=typeof n!="object"?this._events[n]:n,t)&&(t._timed=scheduler.isOneDayEvent(t))}};scheduler.attachEvent("onEventChanged",scheduler._recalculate_timed);scheduler.attachEvent("onEventAdded",scheduler._recalculate_timed);scheduler.render_data=function(n,t){var i,r;for(n=this._pre_render_events(n,t),i=0;i<n.length;i++)this._table_view?scheduler._mode!="month"?this.render_event_bar(n[i]):(r=scheduler.config.max_month_events,r!==r*1||n[i]._sorder<r?this.render_event_bar(n[i]):r!==undefined&&n[i]._sorder==r&&scheduler._render_month_link(n[i])):this.render_event(n[i])};scheduler._pre_render_events=function(n,t){var o=this.xy.bar_height,k=this._colsS.heights,i=this._colsS.heights=[0,0,0,0,0,0,0],s=this._els.dhx_cal_data[0],u,r,h,c,l,a,f,e;if(n=this._table_view?this._pre_render_events_table(n,t):this._pre_render_events_line(n,t),this._table_view)if(t)this._colsS.heights=k;else if(u=s.firstChild,u.rows){for(r=0;r<u.rows.length;r++){if(i[r]++,h=this._colsS.height-this.xy.month_head_height,i[r]*o>h){for(c=u.rows[r].cells,l=h,this.config.max_month_events*1!==this.config.max_month_events||i[r]<=this.config.max_month_events?l=i[r]*o:(this.config.max_month_events+1)*o>h&&(l=(this.config.max_month_events+1)*o),a=0;a<c.length;a++)c[a].childNodes[1].style.height=l+"px";i[r]=(i[r-1]||0)+c[0].offsetHeight}i[r]=(i[r-1]||0)+u.rows[r].cells[0].offsetHeight}if(i.unshift(0),u.parentNode.offsetHeight<u.parentNode.scrollHeight&&!scheduler._colsS.scroll_fix&&scheduler.xy.scroll_width){var v=scheduler._colsS,w=v[v.col_length],d=v.heights.slice();w-=scheduler.xy.scroll_width||0;this._calc_scale_sizes(w,this._min_date,this._max_date);scheduler._colsS.heights=d;this.set_xy(this._els.dhx_cal_header[0],w,this.xy.scale_height);scheduler._render_scales(this._els.dhx_cal_header[0]);scheduler._render_month_scale(this._els.dhx_cal_data[0],this._get_timeunit_start(),this._min_date);v.scroll_fix=!0}}else if(n.length||this._els.dhx_multi_day[0].style.visibility!="visible"||(i[0]=-1),n.length||i[0]==-1){var g=u.parentNode.childNodes,y=(i[0]+1)*o+1,p=y,b=y+"px";this.config.multi_day_height_limit&&(p=Math.min(y,this.config.multi_day_height_limit),b=p+"px");s.style.top=this._els.dhx_cal_navline[0].offsetHeight+this._els.dhx_cal_header[0].offsetHeight+p+10+"px";s.style.height=this._obj.offsetHeight-parseInt(s.style.top,10)-(this.xy.margin_top||0)+"px";f=this._els.dhx_multi_day[0];f.style.height=b;f.style.visibility=i[0]==-1?"hidden":"visible";f.style.top=this._els.dhx_cal_navline[0].offsetHeight+this._els.dhx_cal_header[0].offsetHeight+11+"px";e=this._els.dhx_multi_day[1];e.style.height=b;e.style.visibility=i[0]==-1?"hidden":"visible";e.className=i[0]?"dhx_multi_day_icon":"dhx_multi_day_icon_small";this._dy_shift=(i[0]+1)*o;i[0]=0;p!=y&&(s.style.top=parseInt(s.style.top)+2+"px",f.style.overflowY="auto",f.style.width=parseInt(f.style.width)-2+"px",e.style.position="fixed",e.style.top="",e.style.left="")}return n};scheduler._get_event_sday=function(n){return Math.floor((n.start_date.valueOf()-this._min_date.valueOf())/864e5)};scheduler._get_event_mapped_end_date=function(n){var t=n.end_date,i;return this.config.separate_short_events&&(i=(n.end_date-n.start_date)/6e4,i<this._min_mapped_duration&&(t=this.date.add(t,this._min_mapped_duration-i,"minute"))),t};scheduler._pre_render_events_line=function(n,t){var e,o,r,c,y,f,s,h,p,l,a,u;for(n.sort(function(n,t){return n.start_date.valueOf()==t.start_date.valueOf()?n.id>t.id?1:-1:n.start_date>t.start_date?1:-1}),e=[],o=[],this._min_mapped_duration=Math.ceil(this.xy.min_event_height*60/this.config.hour_size_px),u=0;u<n.length;u++){var i=n[u],b=i.start_date,k=i.end_date,v=b.getHours(),w=k.getHours();if(i._sday=this._get_event_sday(i),this._ignores[i._sday]){n.splice(u,1);u--;continue}if(e[i._sday]||(e[i._sday]=[]),!t){for(i._inner=!1,r=e[i._sday];r.length;)if(s=r[r.length-1],h=this._get_event_mapped_end_date(s),h.valueOf()<=i.start_date.valueOf())r.splice(r.length-1,1);else break;for(c=r.length,y=!1,f=0;f<r.length;f++)if(s=r[f],h=this._get_event_mapped_end_date(s),h.valueOf()<=i.start_date.valueOf()){y=!0;i._sorder=s._sorder;c=f;i._inner=!0;break}if(r.length&&(r[r.length-1]._inner=!0),!y)if(r.length)if(r.length<=r[r.length-1]._sorder){if(r[r.length-1]._sorder)for(f=0;f<r.length;f++){for(p=!1,l=0;l<r.length;l++)if(r[l]._sorder==f){p=!0;break}if(!p){i._sorder=f;break}}else i._sorder=0;i._inner=!0}else{for(a=r[0]._sorder,f=1;f<r.length;f++)r[f]._sorder>a&&(a=r[f]._sorder);i._sorder=a+1;i._inner=!1}else i._sorder=0;r.splice(c,c==r.length?0:1,i);r.length>(r.max_count||0)?(r.max_count=r.length,i._count=r.length):i._count=i._count?i._count:1}if((v<this.config.first_hour||w>=this.config.last_hour)&&(o.push(i),n[u]=i=this._copy_event(i),v<this.config.first_hour&&(i.start_date.setHours(this.config.first_hour),i.start_date.setMinutes(0)),w>=this.config.last_hour&&(i.end_date.setMinutes(0),i.end_date.setHours(this.config.last_hour)),i.start_date>i.end_date||v==this.config.last_hour)){n.splice(u,1);u--;continue}}if(!t){for(u=0;u<n.length;u++)n[u]._count=e[n[u]._sday].max_count;for(u=0;u<o.length;u++)o[u]._count=e[o[u]._sday].max_count}return n};scheduler._time_order=function(n){n.sort(function(n,t){return n.start_date.valueOf()==t.start_date.valueOf()?n._timed&&!t._timed?1:!n._timed&&t._timed?-1:n.id>t.id?1:-1:n.start_date>t.start_date?1:-1})};scheduler._pre_render_events_table=function(n,t){var s,i,c,p,w,e,o,r;this._time_order(n);var l=[],k=[[],[],[],[],[],[],[]],b=this._colsS.heights,a,u=this._cols.length,v={};for(s=0;s<n.length;s++){i=n[s];c=i.id;v[c]||(v[c]={first_chunk:!0,last_chunk:!0});var f=v[c],h=a||i.start_date,y=i.end_date;if(h<this._min_date&&(f.first_chunk=!1,h=this._min_date),y>this._max_date&&(f.last_chunk=!1,y=this._max_date),p=this.locate_holder_day(h,!1,i),i._sday=p%u,!this._ignores[i._sday]||!i._timed){for(w=this.locate_holder_day(y,!0,i)||u,i._eday=w%u||u,i._length=w-p,i._sweek=Math.floor((this._correct_shift(h.valueOf(),1)-this._min_date.valueOf())/(864e5*u)),e=k[i._sweek],o=0;o<e.length;o++)if(e[o]._eday<=i._sday)break;if(i._sorder&&t||(i._sorder=o),i._sday+i._length<=u)a=null,l.push(i),e[o]=i,b[i._sweek]=e.length-1,i._first_chunk=f.first_chunk,i._last_chunk=f.last_chunk;else{r=this._copy_event(i);r.id=i.id;r._length=u-i._sday;r._eday=u;r._sday=i._sday;r._sweek=i._sweek;r._sorder=i._sorder;r.end_date=this.date.add(h,r._length,"day");r._first_chunk=f.first_chunk;f.first_chunk&&(f.first_chunk=!1);l.push(r);e[o]=r;a=r.end_date;b[i._sweek]=e.length-1;s--;continue}}}return l};scheduler._copy_dummy=function(){var n=new Date(this.start_date),t=new Date(this.end_date);this.start_date=n;this.end_date=t};scheduler._copy_event=function(n){return this._copy_dummy.prototype=n,new this._copy_dummy};scheduler._rendered=[];scheduler.clear_view=function(){for(var t,n=0;n<this._rendered.length;n++)t=this._rendered[n],t.parentNode&&t.parentNode.removeChild(t);this._rendered=[]};scheduler.updateEvent=function(n){var t=this.getEvent(n);this.clear_event(n);t&&this.is_visible_events(t)&&this.filter_event(n,t)&&(this._table_view||this.config.multi_day||t._timed)&&(this.config.update_render?this.render_view_data():this.render_view_data([t],!0))};scheduler.clear_event=function(n){this.for_rendered(n,function(n,t){n.parentNode&&n.parentNode.removeChild(n);scheduler._rendered.splice(t,1)})};scheduler._y_from_date=function(n){var t=n.getHours()*60+n.getMinutes();return Math.round((t*6e4-this.config.first_hour*36e5)*this.config.hour_size_px/36e5)%(this.config.hour_size_px*24)};scheduler._calc_event_y=function(n,t){t=t||0;var i=n.start_date.getHours()*60+n.start_date.getMinutes(),r=n.end_date.getHours()*60+n.end_date.getMinutes()||scheduler.config.last_hour*60,u=this._y_from_date(n.start_date),f=Math.max(t,(r-i)*this.config.hour_size_px/60);return{top:u,height:f}};scheduler.render_event=function(n){var o=scheduler.xy.menu_width,s=this.config.use_select_menu_space?0:o,f,p,w,d,t,b,u,e,a;if(!(n._sday<0)&&(f=scheduler.locate_holder(n._sday),f)){var k=this._calc_event_y(n,scheduler.xy.min_event_height),v=k.top,h=k.height,y=n._count||1,c=n._sorder||0,i=Math.floor((f.clientWidth-s)/y),r=c*i+1;if(n._inner||(i=i*(y-c)),this.config.cascade_event_display&&(p=this.config.cascade_event_count,w=this.config.cascade_event_margin,r=c%p*w,d=n._inner?(y-c-1)%p*w/2:0,i=Math.floor(f.clientWidth-s-r-d)),t=this._render_v_bar(n,s+r,v,i,h,n._text_style,scheduler.templates.event_header(n.start_date,n.end_date,n),scheduler.templates.event_text(n.start_date,n.end_date,n)),this._rendered.push(t),f.appendChild(t),r=r+parseInt(f.style.left,10)+s,this._edit_id==n.id&&(t.style.zIndex=1,i=Math.max(i-4,scheduler.xy.editor_width),t=document.createElement("DIV"),t.setAttribute("event_id",n.id),this.set_xy(t,i,h-20,r,v+14),t.className="dhx_cal_event dhx_cal_editor",b=scheduler.templates.event_class(n.start_date,n.end_date,n),b&&(t.className+=" "+b),u=document.createElement("DIV"),this.set_xy(u,i-6,h-26),u.style.cssText+=";margin:2px 2px 2px 2px;overflow:hidden;",t.appendChild(u),this._els.dhx_cal_data[0].appendChild(t),this._rendered.push(t),u.innerHTML="<textarea class='dhx_cal_editor'>"+n.text+"<\/textarea>",this._quirks7&&(u.firstChild.style.height=h-12+"px"),this._editor=u.firstChild,this._editor.onkeydown=function(n){if((n||event).shiftKey)return!0;var t=(n||event).keyCode;t==scheduler.keys.edit_save&&scheduler.editStop(!0);t==scheduler.keys.edit_cancel&&scheduler.editStop(!1)},this._editor.onselectstart=function(n){return(n||event).cancelBubble=!0,!0},scheduler._focus(u.firstChild,!0),this._els.dhx_cal_data[0].scrollLeft=0),this.xy.menu_width!==0&&this._select_id==n.id){this.config.cascade_event_display&&this._drag_mode&&(t.style.zIndex=1);var l=this.config["icons_"+(this._edit_id==n.id?"edit":"select")],g="",nt=n.color?"background-color: "+n.color+";":"",tt=n.textColor?"color: "+n.textColor+";":"";for(e=0;e<l.length;e++)g+="<div class='dhx_menu_icon "+l[e]+"' style='"+nt+""+tt+"' title='"+this.locale.labels[l[e]]+"'><\/div>";a=this._render_v_bar(n,r-o+1,v,o,l.length*20+26-2,"","<div style='"+nt+""+tt+"' class='dhx_menu_head'><\/div>",g,!0);a.style.left=r-o+1;this._els.dhx_cal_data[0].appendChild(a);this._rendered.push(a)}this.config.drag_highlight&&this._drag_id==n.id&&this.highlightEventPosition(n)}};scheduler._render_v_bar=function(n,t,i,r,u,f,e,o,s){var v=document.createElement("DIV"),b=n.id,y=s?"dhx_cal_event dhx_cal_select_menu":"dhx_cal_event",w=scheduler.templates.event_class(n.start_date,n.end_date,n),h,c,a;w&&(y=y+" "+w);var l=n.color?"background:"+n.color+";":"",p=n.textColor?"color:"+n.textColor+";":"",k='<div event_id="'+b+'" class="'+y+'" style="position:absolute; top:'+i+"px; left:"+t+"px; width:"+(r-2)+"px; height:"+u+"px;"+(f||"")+'"><\/div>';return(v.innerHTML=k,h=v.cloneNode(!0).firstChild,!s&&scheduler.renderEvent(h,n,r,u,e,o))?h:(h=v.firstChild,c='<div class="dhx_event_move dhx_header" style=" width:'+(r-6)+"px;"+l+'" >&nbsp;<\/div>',c+='<div class="dhx_event_move dhx_title" style="'+l+""+p+'">'+e+"<\/div>",c+='<div class="dhx_body" style=" width:'+(r-(this._quirks?4:14))+"px; height:"+(u-(this._quirks?20:30)+1)+"px;"+l+""+p+'">'+o+"<\/div>",a="dhx_event_resize dhx_footer",s&&(a="dhx_resize_denied "+a),c+='<div class="'+a+'" style=" width:'+(r-8)+"px;"+(s?" margin-top:-1px;":"")+""+l+""+p+'" ><\/div>',h.innerHTML=c,h)};scheduler.renderEvent=function(){return!1};scheduler.locate_holder=function(n){return this._mode=="day"?this._els.dhx_cal_data[0].firstChild:this._els.dhx_cal_data[0].childNodes[n]};scheduler.locate_holder_day=function(n,t){var i=Math.floor((this._correct_shift(n,1)-this._min_date)/864e5);return t&&this.date.time_part(n)&&i++,i};scheduler._get_dnd_order=function(n,t,i){if(!this._drag_event)return n;this._drag_event._orig_sorder?n=this._drag_event._orig_sorder:this._drag_event._orig_sorder=n;for(var r=t*n;r+t>i;)n--,r-=t;return Math.max(n,0)};scheduler._get_event_bar_pos=function(n){var u=this._colsS[n._sday],i=this._colsS[n._eday],r,t,f,e,o;return i==u&&(i=this._colsS[n._eday+1]),r=this.xy.bar_height,t=n._sorder,n.id==this._drag_id&&(f=this._colsS.heights[n._sweek+1]-this._colsS.heights[n._sweek]-this.xy.month_head_height,t=scheduler._get_dnd_order(t,r,f)),e=t*r,o=this._colsS.heights[n._sweek]+(this._colsS.height?this.xy.month_scale_height+2:2)+e,{x:u,x2:i,y:o}};scheduler.render_event_bar=function(n){var a=this._rendered_location,f=this._get_event_bar_pos(n),v=f.y,h=f.x,r=f.x2,e="",s;if(r){var u=scheduler.config.resize_month_events&&this._mode=="month"&&(!n._timed||scheduler.config.resize_month_timed),o=document.createElement("DIV"),c=n.hasOwnProperty("_first_chunk")&&n._first_chunk,l=n.hasOwnProperty("_last_chunk")&&n._last_chunk,y=u&&(n._timed||c),p=u&&(n._timed||l),t="dhx_cal_event_clear";(!n._timed||u)&&(t="dhx_cal_event_line",r=r-9);c&&(t+=" dhx_cal_event_line_start");l&&(t+=" dhx_cal_event_line_end");y&&(e+="<div class='dhx_event_resize dhx_event_resize_start'><\/div>");p&&(e+="<div class='dhx_event_resize dhx_event_resize_end'><\/div>");s=scheduler.templates.event_class(n.start_date,n.end_date,n);s&&(t+=" "+s);var w=n.color?"background:"+n.color+";":"",b=n.textColor?"color:"+n.textColor+";":"",k=["position:absolute","top:"+v+"px","left:"+h+"px","width:"+(r-h-3)+"px","text-overflow:ellipsis",b,w,n._text_style||""].join(";"),i='<div event_id="'+n.id+'" class="'+t+'" style="'+k+'">';u&&(i+=e);scheduler.getState().mode=="month"&&(n=scheduler.getEvent(n.id));n._timed&&(i+=scheduler.templates.event_bar_date(n.start_date,n.end_date,n));i+=scheduler.templates.event_bar_text(n.start_date,n.end_date,n)+"<\/div>";i+="<\/div>";o.innerHTML=i;this._rendered.push(o.firstChild);a.appendChild(o.firstChild)}};scheduler._locate_event=function(n){for(var t=null;n&&!t&&n.getAttribute;)t=n.getAttribute("event_id"),n=n.parentNode;return t};scheduler.edit=function(n){this._edit_id!=n&&(this.editStop(!1,n),this._edit_id=n,this.updateEvent(n))};scheduler.editStop=function(n,t){if(!t||this._edit_id!=t){var i=this.getEvent(this._edit_id);i&&(n&&(i.text=this._editor.value),this._edit_id=null,this._editor=null,this.updateEvent(i.id),this._edit_stop_event(i,n))}};scheduler._edit_stop_event=function(n,t){this._new_event?(t?this.callEvent("onEventAdded",[n.id,n]):n&&this.deleteEvent(n.id,!0),this._new_event=null):t&&this.callEvent("onEventChanged",[n.id,n])};scheduler.getEvents=function(n,t){var r=[],u,i;for(u in this._events)i=this._events[u],i&&(!n&&!t||i.start_date<t&&i.end_date>n)&&r.push(i);return r};scheduler.getRenderedEvent=function(n){var i,t,r;if(n){for(i=scheduler._rendered,t=0;t<i.length;t++)if(r=i[t],r.getAttribute("event_id")==n)return r;return null}};scheduler.showEvent=function(n,t){var i=typeof n=="number"||typeof n=="string"?scheduler.getEvent(n):n,r,u,f,e;(t=t||scheduler._mode,i&&(!this.checkEvent("onBeforeEventDisplay")||this.callEvent("onBeforeEventDisplay",[i,t])))&&(r=scheduler.config.scroll_hour,scheduler.config.scroll_hour=i.start_date.getHours(),u=scheduler.config.preserve_scroll,scheduler.config.preserve_scroll=!1,f=i.color,e=i.textColor,scheduler.config.highlight_displayed_event&&(i.color=scheduler.config.displayed_event_color,i.textColor=scheduler.config.displayed_event_text_color),scheduler.setCurrentView(new Date(i.start_date),t),i.color=f,i.textColor=e,scheduler.config.scroll_hour=r,scheduler.config.preserve_scroll=u,scheduler.matrix&&scheduler.matrix[t]&&(scheduler._els.dhx_cal_data[0].scrollTop=getAbsoluteTop(scheduler.getRenderedEvent(i.id))-getAbsoluteTop(scheduler._els.dhx_cal_data[0])-20),scheduler.callEvent("onAfterEventDisplay",[i,t]))};scheduler._append_drag_marker=function(n){if(!n.parentNode){var i=scheduler._els.dhx_cal_data[0],t=i.lastChild;t.className&&t.className.indexOf("dhx_scale_holder")<0&&t.previousSibling&&(t=t.previousSibling);t&&t.className.indexOf("dhx_scale_holder")===0&&t.appendChild(n)}};scheduler._update_marker_position=function(n,t){var i=scheduler._calc_event_y(t,0);n.style.top=i.top+"px";n.style.height=i.height+"px"};scheduler.highlightEventPosition=function(n){var t=document.createElement("div"),i,r;t.setAttribute("event_id",n.id);this._rendered.push(t);this._update_marker_position(t,n);i=this.templates.drag_marker_class(n.start_date,n.end_date,n);r=this.templates.drag_marker_content(n.start_date,n.end_date,n);t.className="dhx_drag_marker";i&&(t.className+=" "+i);r&&(t.innerHTML=r);this._append_drag_marker(t)};scheduler._loaded={};scheduler._load=function(n,t){var i,r,f,u;if(n=n||this._load_url,n){if(n+=(n.indexOf("?")==-1?"?":"&")+"timeshift="+(new Date).getTimezoneOffset(),this.config.prevent_cache&&(n+="&uid="+this.uid()),t=t||this._date,this._load_mode){for(r=this.templates.load_format,t=this.date[this._load_mode+"_start"](new Date(t.valueOf()));t>this._min_date;)t=this.date.add(t,-1,this._load_mode);for(i=t,f=!0;i<this._max_date;)i=this.date.add(i,1,this._load_mode),this._loaded[r(t)]&&f?t=this.date.add(t,1,this._load_mode):f=!1;u=i;do i=u,u=this.date.add(i,-1,this._load_mode);while(u>t&&this._loaded[r(u)]);if(i<=t)return!1;for(dhtmlxAjax.get(n+"&from="+r(t)+"&to="+r(i),function(n){scheduler.on_load(n)});t<i;)this._loaded[r(t)]=!0,t=this.date.add(t,1,this._load_mode)}else dhtmlxAjax.get(n,function(n){scheduler.on_load(n)});return this.callEvent("onXLS",[]),!0}};scheduler.on_load=function(n){var t;t=this._process&&this._process!="xml"?this[this._process].parse(n.xmlDoc.responseText):this._magic_parser(n);scheduler._process_loading(t);this.callEvent("onXLE",[])};scheduler._process_loading=function(n){this._loading=!0;this._not_render=!0;for(var t=0;t<n.length;t++)this.callEvent("onEventLoading",[n[t]])&&this.addEvent(n[t]);this._not_render=!1;this._render_wait&&this.render_view_data();this._loading=!1;this._after_call&&this._after_call();this._after_call=null};scheduler._init_event=function(n){n._text=n.text||n._tagvalue||"";n._details=n.details;n.text=$func.htmlEncode(n.text)||n._tagvalue||"";n.start_date=scheduler._init_date(n.start_date);n.end_date=scheduler._init_date(n.end_date);n.details=$func.htmlEncode(n.details)};scheduler._init_date=function(n){return n?typeof n=="string"?scheduler.templates.xml_date(n):new Date(n):null};scheduler.json={};scheduler.json.parse=function(n){var u,s,f,h,r,e,t,c,i,l,o,a;typeof n=="string"&&(scheduler._temp=eval("("+n+")"),n=scheduler._temp?scheduler._temp.data||scheduler._temp.d||scheduler._temp:[]);n.dhx_security&&(dhtmlx.security_key=n.dhx_security);u=scheduler._temp&&scheduler._temp.collections?scheduler._temp.collections:{};s=!1;for(f in u)if(u.hasOwnProperty(f)){if(s=!0,h=u[f],r=scheduler.serverList[f],!r)continue;for(r.splice(0,r.length),e=0;e<h.length;e++){t=h[e];c={key:t.value,label:t.label};for(i in t)if(t.hasOwnProperty(i)){if(i=="value"||i=="label")continue;c[i]=t[i]}r.push(c)}}for(s&&scheduler.callEvent("onOptionsLoad",[]),l=[],o=0;o<n.length;o++)a=n[o],scheduler._init_event(a),l.push(a);return l};scheduler.parse=function(n,t){this._process=t;this.on_load({xmlDoc:{responseText:n}})};scheduler.load=function(n,t){typeof t=="string"&&(this._process=t,t=arguments[2]);this._load_url=n;this._after_call=t;this._load(n,this._date)};scheduler.setLoadMode=function(n){n=="all"&&(n="");this._load_mode=n};scheduler.serverList=function(n,t){return t?(this.serverList[n]=t.slice(0),this.serverList[n]):(this.serverList[n]=this.serverList[n]||[],this.serverList[n])};scheduler._userdata={};scheduler._magic_parser=function(n){var i,v,h,u,y,f,e,r,s,o,c,l,a,t,b;if(n.getXMLTopNode||(v=n.xmlDoc.responseText,n=new dtmlXMLLoaderObject(function(){}),n.loadXMLString(v)),i=n.getXMLTopNode("data"),i.tagName!="data")return[];for(h=i.getAttribute("dhx_security"),h&&(dhtmlx.security_key=h),u=n.doXPath("//coll_options"),t=0;t<u.length;t++)if(y=u[t].getAttribute("for"),f=this.serverList[y],f)for(f.splice(0,f.length),e=n.doXPath(".//item",u[t]),r=0;r<e.length;r++){var k=e[r],p=k.attributes,w={key:e[r].getAttribute("value"),label:e[r].getAttribute("label")};for(s=0;s<p.length;s++)(o=p[s],o.nodeName!="value"&&o.nodeName!="label")&&(w[o.nodeName]=o.nodeValue);f.push(w)}for(u.length&&scheduler.callEvent("onOptionsLoad",[]),c=n.doXPath("//userdata"),t=0;t<c.length;t++)l=this._xmlNodeToJSON(c[t]),this._userdata[l.name]=l.text;for(a=[],i=n.doXPath("//event"),t=0;t<i.length;t++)b=a[t]=this._xmlNodeToJSON(i[t]),scheduler._init_event(b);return a};scheduler._xmlNodeToJSON=function(n){for(var r,i={},t=0;t<n.attributes.length;t++)i[n.attributes[t].name]=n.attributes[t].value;for(t=0;t<n.childNodes.length;t++)r=n.childNodes[t],r.nodeType==1&&(i[r.tagName]=r.firstChild?r.firstChild.nodeValue:"");return i.text||(i.text=n.firstChild?n.firstChild.nodeValue:""),i};scheduler.attachEvent("onXLS",function(){if(this.config.show_loading===!0){var n;n=this.config.show_loading=document.createElement("DIV");n.className="dhx_loading";n.style.left=Math.round((this._x-128)/2)+"px";n.style.top=Math.round((this._y-15)/2)+"px";this._obj.appendChild(n)}});scheduler.attachEvent("onXLE",function(){var n=this.config.show_loading;n&&typeof n=="object"&&(this._obj.removeChild(n),this.config.show_loading=!0)});scheduler.ical={parse:function(n){var i=n.match(RegExp(this.c_start+"[^\f]*"+this.c_end,"")),r,u,f,t,e,o;if(i.length){for(i[0]=i[0].replace(/[\r\n]+(?=[a-z \t])/g," "),i[0]=i[0].replace(/\;[^:\r\n]*:/g,":"),r=[],f=RegExp("(?:"+this.e_start+")([^\f]*?)(?:"+this.e_end+")","g");(u=f.exec(i))!==null;){for(t={},o=/[^\r\n]+[\r\n]+/g;(e=o.exec(u[1]))!==null;)this.parse_param(e.toString(),t);t.uid&&!t.id&&(t.id=t.uid);r.push(t)}return r}},parse_param:function(n,t){var u=n.indexOf(":"),i,r;u!=-1&&(i=n.substr(0,u).toLowerCase(),r=n.substr(u+1).replace(/\\\,/g,",").replace(/[\r\n]+$/,""),i=="summary"?i="text":i=="dtstart"?(i="start_date",r=this.parse_date(r,0,0)):i=="dtend"&&(i="end_date",r=this.parse_date(r,0,0)),t[i]=r)},parse_date:function(n,t,i){var r=n.split("T");r[1]&&(t=r[1].substr(0,2),i=r[1].substr(2,2));var u=r[0].substr(0,4),f=parseInt(r[0].substr(4,2),10)-1,e=r[0].substr(6,2);return scheduler.config.server_utc&&!r[1]?new Date(Date.UTC(u,f,e,t,i)):new Date(u,f,e,t,i)},c_start:"BEGIN:VCALENDAR",e_start:"BEGIN:VEVENT",e_end:"END:VEVENT",c_end:"END:VCALENDAR"};scheduler._lightbox_controls={};scheduler.formSection=function(n){var r=this.config.lightbox.sections,i=0,t;for(i;i<r.length;i++)if(r[i].name==n)break;t=r[i];scheduler._lightbox||scheduler.getLightbox();var f=document.getElementById(t.id),u=f.nextSibling,e={section:t,header:f,node:u,getValue:function(n){return scheduler.form_blocks[t.type].get_value(u,n||{},t)},setValue:function(n,i){return scheduler.form_blocks[t.type].set_value(u,n,i||{},t)}},o=scheduler._lightbox_controls["get_"+t.type+"_control"];return o?o(e):e};scheduler._lightbox_controls.get_template_control=function(n){return n.control=n.node,n};scheduler._lightbox_controls.get_select_control=function(n){return n.control=n.node.getElementsByTagName("select")[0],n};scheduler._lightbox_controls.get_textarea_control=function(n){return n.control=n.node.getElementsByTagName("textarea")[0],n};scheduler._lightbox_controls.get_time_control=function(n){return n.control=n.node.getElementsByTagName("select"),n};scheduler.form_blocks={template:{render:function(n){var t=(n.height||"30")+"px";return"<div class='dhx_cal_ltext dhx_cal_template' style='height:"+t+";'><\/div>"},set_value:function(n,t){n.innerHTML=t||""},get_value:function(n){return n.innerHTML||""},focus:function(){}},textarea:{render:function(n){var t=(n.height||"130")+"px";return"<div class='dhx_cal_ltext' style='height:"+t+";'><textarea><\/textarea><\/div>"},set_value:function(n,t){n.firstChild.value=t||""},get_value:function(n){return n.firstChild.value},focus:function(n){var t=n.firstChild;scheduler._focus(t,!0)}},select:{render:function(n){for(var r=(n.height||"23")+"px",i="<div class='dhx_cal_ltext' style='height:"+r+";'><select style='width:100%;'>",t=0;t<n.options.length;t++)i+="<option value='"+n.options[t].key+"'>"+n.options[t].label+"<\/option>";return i+"<\/select><\/div>"},set_value:function(n,t,i,r){var u=n.firstChild;!u._dhx_onchange&&r.onchange&&(u.onchange=r.onchange,u._dhx_onchange=!0);typeof t=="undefined"&&(t=(u.options[0]||{}).value);u.value=t||""},get_value:function(n){return n.firstChild.value},focus:function(n){var t=n.firstChild;scheduler._focus(t,!0)}},time:{render:function(n){var i,u,c,e,t,l,a,v;n.time_format||(n.time_format=["%H:%i","%d","%m","%Y"]);n._time_format_order={};var o=n.time_format,f=scheduler.config,r=this.date.date_part(scheduler._currentDate()),s=1440,h=0;for(scheduler.config.limit_time_select&&(s=60*f.last_hour+1,h=60*f.first_hour,r.setHours(f.first_hour)),i="",u=0;u<o.length;u++){c=o[u];u>0&&(i+=" ");switch(c){case"%Y":for(n._time_format_order[3]=u,i+="<select>",e=r.getFullYear()-5,t=0;t<10;t++)i+="<option value='"+(e+t)+"'>"+(e+t)+"<\/option>";i+="<\/select> ";break;case"%m":for(n._time_format_order[2]=u,i+="<select>",t=0;t<12;t++)i+="<option value='"+t+"'>"+this.locale.date.month_full[t]+"<\/option>";i+="<\/select>";break;case"%d":for(n._time_format_order[1]=u,i+="<select>",t=1;t<32;t++)i+="<option value='"+t+"'>"+t+"<\/option>";i+="<\/select>";break;case"%H:%i":for(n._time_format_order[0]=u,i+="<select>",t=h,l=r.getDate(),n._time_values=[];t<s;)a=this.templates.time_picker(r),i+="<option value='"+t+"'>"+a+"<\/option>",n._time_values.push(t),r.setTime(r.valueOf()+this.config.time_step*6e4),v=r.getDate()!=l?1:0,t=v*1440+r.getHours()*60+r.getMinutes();i+="<\/select>"}}return"<div style='height:30px;padding-top:0px;font-size:inherit;' class='dhx_section_time'>"+i+"<span style='font-weight:normal; font-size:10pt;'> &nbsp;&ndash;&nbsp; <\/span>"+i+"<\/div>"},set_value:function(n,t,i,r){function h(n,t,i){for(var e,c=r._time_values,u=i.getHours()*60+i.getMinutes(),o=u,s=!1,h=0;h<c.length;h++){if(e=c[h],e===u){s=!0;break}e<u&&(o=e)}n[t+f[0]].value=s?u:o;s||o||(n[t+f[0]].selectedIndex=-1);n[t+f[1]].value=i.getDate();n[t+f[2]].value=i.getMonth();n[t+f[3]].value=i.getFullYear()}var a=scheduler.config,u=n.getElementsByTagName("select"),f=r._time_format_order,s,e,c,o,v,l;if(a.full_day&&(n._full_day||(c="<label class='dhx_fullday'><input type='checkbox' name='full_day' value='true'> "+scheduler.locale.labels.full_day+"&nbsp;<\/label><\/input>",scheduler.config.wide_form||(c=n.previousSibling.innerHTML+c),n.previousSibling.innerHTML=c,n._full_day=!0),o=n.previousSibling.getElementsByTagName("input")[0],o.checked=scheduler.date.time_part(i.start_date)===0&&scheduler.date.time_part(i.end_date)===0,u[f[0]].disabled=o.checked,u[f[0]+u.length/2].disabled=o.checked,o.onclick=function(){if(o.checked){var t={};scheduler.form_blocks.time.get_value(n,t,r);s=scheduler.date.date_part(t.start_date);e=scheduler.date.date_part(t.end_date);(+e==+s||+e>=+s&&(i.end_date.getHours()!==0||i.end_date.getMinutes()!==0))&&(e=scheduler.date.add(e,1,"day"))}u[f[0]].disabled=o.checked;u[f[0]+u.length/2].disabled=o.checked;h(u,0,s||i.start_date);h(u,4,e||i.end_date)}),a.auto_end_date&&a.event_duration)for(v=function(){s=new Date(u[f[3]].value,u[f[2]].value,u[f[1]].value,0,u[f[0]].value);e=new Date(s.getTime()+scheduler.config.event_duration*6e4);h(u,4,e)},l=0;l<4;l++)u[l].onchange=v;h(u,0,i.start_date);h(u,4,i.end_date)},get_value:function(n,t,i){var r=n.getElementsByTagName("select"),u=i._time_format_order;return t.start_date=new Date(r[u[3]].value,r[u[2]].value,r[u[1]].value,0,r[u[0]].value),t.end_date=new Date(r[u[3]+4].value,r[u[2]+4].value,r[u[1]+4].value,0,r[u[0]+4].value),t.end_date<=t.start_date&&(t.end_date=scheduler.date.add(t.start_date,scheduler.config.time_step,"minute")),{start_date:new Date(t.start_date),end_date:new Date(t.end_date)}},focus:function(n){scheduler._focus(n.getElementsByTagName("select")[0])}}};scheduler.showCover=function(n){if(n){n.style.display="block";var t=window.pageYOffset||document.body.scrollTop||document.documentElement.scrollTop,r=window.pageXOffset||document.body.scrollLeft||document.documentElement.scrollLeft,i=window.innerHeight||document.documentElement.clientHeight;n.style.top=t?Math.round(t+Math.max((i-n.offsetHeight)/2,0))+"px":Math.round(Math.max((i-n.offsetHeight)/2,0)+9)+"px";n.style.left=document.documentElement.scrollWidth>document.body.offsetWidth?Math.round(r+(document.body.offsetWidth-n.offsetWidth)/2)+"px":Math.round((document.body.offsetWidth-n.offsetWidth)/2)+"px"}this.show_cover()};scheduler.showLightbox=function(n){if(n){if(!this.callEvent("onBeforeLightbox",[n])){this._new_event&&(this._new_event=null);return}var t=this.getLightbox();this.showCover(t);this._fill_lightbox(n,t);this.callEvent("onLightbox",[n])}};scheduler._fill_lightbox=function(n,t){var i=this.getEvent(n),f=t.getElementsByTagName("span"),e,u;for(scheduler.templates.lightbox_header?(f[1].innerHTML="",f[2].innerHTML=scheduler.templates.lightbox_header(i.start_date,i.end_date,i)):(f[1].innerHTML=this.templates.event_header(i.start_date,i.end_date,i),f[2].innerHTML=(this.templates.event_bar_text(i.start_date,i.end_date,i)||"").substr(0,70)),e=this.config.lightbox.sections,u=0;u<e.length;u++){var r=e[u],o=document.getElementById(r.id).nextSibling,s=this.form_blocks[r.type],h=i[r.map_to]!==undefined?i[r.map_to]:r.default_value;s.set_value.call(this,o,h,i,r);e[u].focus&&s.focus.call(this,o)}scheduler._lightbox_id=n};scheduler._lightbox_out=function(n){for(var r,u,f,i=this.config.lightbox.sections,t=0;t<i.length;t++)r=document.getElementById(i[t].id),r=r?r.nextSibling:r,u=this.form_blocks[i[t].type],f=u.get_value.call(this,r,n,i[t]),i[t].map_to!="auto"&&(n[i[t].map_to]=f);return n};scheduler._empty_lightbox=function(n){var i=scheduler._lightbox_id,t=this.getEvent(i),r=this.getLightbox();this._lame_copy(t,n);this.setEvent(t.id,t);this._edit_stop_event(t,!0);this.render_view_data()};scheduler.hide_lightbox=function(){this.hideCover(this.getLightbox());this._lightbox_id=null;this.callEvent("onAfterLightbox",[])};scheduler.hideCover=function(n){n&&(n.style.display="none");this.hide_cover()};scheduler.hide_cover=function(){this._cover&&this._cover.parentNode.removeChild(this._cover);this._cover=null};scheduler.show_cover=function(){if(!this._cover){this._cover=document.createElement("DIV");this._cover.className="dhx_cal_cover";var n=document.height!==undefined?document.height:document.body.offsetHeight,t=document.documentElement?document.documentElement.scrollHeight:0;this._cover.style.height=Math.max(n,t)+"px";document.body.appendChild(this._cover)}};scheduler.save_lightbox=function(){var n=this._lightbox_out({},this._lame_copy(this.getEvent(this._lightbox_id)));(!this.checkEvent("onEventSave")||this.callEvent("onEventSave",[this._lightbox_id,n,this._new_event]))&&(this._empty_lightbox(n),this.hide_lightbox())};scheduler.startLightbox=function(n,t){this._lightbox_id=n;this._custom_lightbox=!0;this._temp_lightbox=this._lightbox;this._lightbox=t;this.showCover(t)};scheduler.endLightbox=function(n,t){this._edit_stop_event(scheduler.getEvent(this._lightbox_id),n);n&&scheduler.render_view_data();this.hideCover(t);this._custom_lightbox&&(this._lightbox=this._temp_lightbox,this._custom_lightbox=!1);this._temp_lightbox=this._lightbox_id=null};scheduler.resetLightbox=function(){scheduler._lightbox&&!scheduler._custom_lightbox&&scheduler._lightbox.parentNode.removeChild(scheduler._lightbox);scheduler._lightbox=null};scheduler.cancel_lightbox=function(){this.callEvent("onEventCancel",[this._lightbox_id,this._new_event]);this.endLightbox(!1);this.hide_lightbox()};scheduler._init_lightbox_events=function(){this.getLightbox().onclick=function(n){var t=n?n.target:event.srcElement,u,i,f,r;if(t.className||(t=t.previousSibling),t&&t.className)switch(t.className){case"dhx_save_btn":scheduler.save_lightbox();break;case"dhx_delete_btn":u=scheduler.locale.labels.confirm_deleting;scheduler._dhtmlx_confirm(u,scheduler.locale.labels.title_confirm_deleting,function(){scheduler.deleteEvent(scheduler._lightbox_id);scheduler._new_event=null;scheduler.hide_lightbox()});break;case"dhx_cancel_btn":scheduler.cancel_lightbox();break;default:t.getAttribute("dhx_button")?scheduler.callEvent("onLightboxButton",[t.className,t,n]):(t.className.indexOf("dhx_custom_button")!=-1&&(t.className.indexOf("dhx_custom_button_")!=-1?(i=t.parentNode.getAttribute("index"),r=t.parentNode.parentNode):(i=t.getAttribute("index"),r=t.parentNode,t=t.firstChild)),i&&(f=scheduler.form_blocks[scheduler.config.lightbox.sections[i].type],f.button_click(i,t,r,r.nextSibling)))}};this.getLightbox().onkeydown=function(n){switch((n||event).keyCode){case scheduler.keys.edit_save:if((n||event).shiftKey)return;scheduler.save_lightbox();break;case scheduler.keys.edit_cancel:scheduler.cancel_lightbox()}}};scheduler.setLightboxSize=function(){var t=this._lightbox,n;t&&(n=t.childNodes[1],n.style.height="0px",n.style.height=n.scrollHeight+"px",t.style.height=n.scrollHeight+scheduler.xy.lightbox_additional_height+"px",n.style.height=n.scrollHeight+"px")};scheduler._init_dnd_events=function(){dhtmlxEvent(document.body,"mousemove",scheduler._move_while_dnd);dhtmlxEvent(document.body,"mouseup",scheduler._finish_dnd);scheduler._init_dnd_events=function(){}};scheduler._move_while_dnd=function(n){if(scheduler._dnd_start_lb){document.dhx_unselectable||(document.body.className+=" dhx_unselectable",document.dhx_unselectable=!0);var t=scheduler.getLightbox(),i=n&&n.target?[n.pageX,n.pageY]:[event.clientX,event.clientY];t.style.top=scheduler._lb_start[1]+i[1]-scheduler._dnd_start_lb[1]+"px";t.style.left=scheduler._lb_start[0]+i[0]-scheduler._dnd_start_lb[0]+"px"}};scheduler._ready_to_dnd=function(n){var t=scheduler.getLightbox();scheduler._lb_start=[parseInt(t.style.left,10),parseInt(t.style.top,10)];scheduler._dnd_start_lb=n&&n.target?[n.pageX,n.pageY]:[event.clientX,event.clientY]};scheduler._finish_dnd=function(){scheduler._lb_start&&(scheduler._lb_start=scheduler._dnd_start_lb=!1,document.body.className=document.body.className.replace(" dhx_unselectable",""),document.dhx_unselectable=!1)};scheduler.getLightbox=function(){var t,r,u,i,e,o,f,s,n,h;if(!this._lightbox){for(t=document.createElement("DIV"),t.className="dhx_cal_light",scheduler.config.wide_form&&(t.className+=" dhx_cal_light_wide"),scheduler.form_blocks.recurring&&(t.className+=" dhx_cal_light_rec"),/msie|MSIE 6/.test(navigator.userAgent)&&(t.className+=" dhx_ie6"),t.style.visibility="hidden",r=this._lightbox_template,u=this.config.buttons_left,n=0;n<u.length;n++)r+="<div class='dhx_btn_set dhx_left_btn_set "+u[n]+"_set'><div dhx_button='1' class='"+u[n]+"'><\/div><div>"+scheduler.locale.labels[u[n]]+"<\/div><\/div>";for(u=this.config.buttons_right,n=0;n<u.length;n++)r+="<div class='dhx_btn_set dhx_right_btn_set "+u[n]+"_set' style='float:right;'><div dhx_button='1' class='"+u[n]+"'><\/div><div>"+scheduler.locale.labels[u[n]]+"<\/div><\/div>";for(r+="<\/div>",t.innerHTML=r,scheduler.config.drag_lightbox&&(t.firstChild.onmousedown=scheduler._ready_to_dnd,t.firstChild.onselectstart=function(){return!1},t.firstChild.style.cursor="pointer",scheduler._init_dnd_events()),document.body.insertBefore(t,document.body.firstChild),this._lightbox=t,i=this.config.lightbox.sections,r="",n=0;n<i.length;n++)(e=this.form_blocks[i[n].type],e)&&(i[n].id="area_"+this.uid(),o="",i[n].button&&(o="<div class='dhx_custom_button' index='"+n+"'><div class='dhx_custom_button_"+i[n].button+"'><\/div><div>"+this.locale.labels["button_"+i[n].button]+"<\/div><\/div>"),this.config.wide_form&&(r+="<div class='dhx_wrap_section'>"),f=this.locale.labels["section_"+i[n].name],typeof f!="string"&&(f=i[n].name),r+="<div id='"+i[n].id+"' class='dhx_cal_lsection'>"+o+f+"<\/div>"+e.render.call(this,i[n]),r+="<\/div>");for(s=t.getElementsByTagName("div"),n=0;n<s.length;n++)if(h=s[n],h.className=="dhx_cal_larea"){h.innerHTML=r;break}this.setLightboxSize();this._init_lightbox_events(this);t.style.display="none";t.style.visibility="visible"}return this._lightbox};scheduler._lightbox_template="<div class='dhx_cal_ltitle'><span class='dhx_mark'>&nbsp;<\/span><span class='dhx_time'><\/span><span class='dhx_title'><\/span><\/div><div class='dhx_cal_larea'><\/div>";scheduler._init_touch_events=function(){this.config.touch!="force"&&(this.config.touch=this.config.touch&&(navigator.userAgent.indexOf("Mobile")!=-1||navigator.userAgent.indexOf("iPad")!=-1||navigator.userAgent.indexOf("Android")!=-1||navigator.userAgent.indexOf("Touch")!=-1));this.config.touch&&(this.xy.scroll_width=0,window.navigator.msPointerEnabled?(this._touch_events(["MSPointerMove","MSPointerDown","MSPointerUp"],function(n){return n.pointerType==n.MSPOINTER_TYPE_MOUSE?null:n},function(n){return!n||n.pointerType==n.MSPOINTER_TYPE_MOUSE}),this._obj.ondblclick=function(){}):this._touch_events(["touchmove","touchstart","touchend"],function(n){return n.touches&&n.touches.length>1?null:n.touches[0]?{target:n.target,pageX:n.touches[0].pageX,pageY:n.touches[0].pageY}:n},function(){return!1}))};scheduler._touch_events=function(n,t,i){function o(n,t,i){dhtmlxEvent(n,t,function(n){return scheduler._is_lightbox_open()?!0:i(n)})}function a(n,t,i){if(n&&t){var r=Math.abs(n.pageY-t.pageY),u=Math.abs(n.pageX-t.pageX);u>i&&(!r||u/r>3)&&(n.pageX>t.pageX?scheduler._click.dhx_cal_next_button():scheduler._click.dhx_cal_prev_button())}}function h(n){scheduler._hide_global_tip();u&&(scheduler._on_mouse_up(t(n||event)),scheduler._temp_touch_block=!1);scheduler._drag_id=null;scheduler._drag_mode=null;scheduler._drag_pos=null;clearTimeout(c);u=s=!1;e=!0}var v=navigator.userAgent.indexOf("Android")!=-1&&navigator.userAgent.indexOf("WebKit")!=-1,f,r,c,u,e,s,l=0;o(document.body,n[0],function(n){if(!i(n)){if(u)return scheduler._on_mouse_move(t(n)),scheduler._update_global_tip(),n.preventDefault&&n.preventDefault(),n.cancelBubble=!0,!1;if(r&&v&&a(r,t(n),0),r=t(n),s){if(!r){e=!0;return}(f.target!=r.target||Math.abs(f.pageX-r.pageX)>5||Math.abs(f.pageY-r.pageY)>5)&&(e=!0,clearTimeout(c))}}});o(this._els.dhx_cal_data[0],"scroll",h);o(this._els.dhx_cal_data[0],"touchcancel",h);o(this._els.dhx_cal_data[0],"contextmenu",function(n){if(s)return n&&n.preventDefault&&n.preventDefault(),(n||event).cancelBubble=!0,!1});o(this._els.dhx_cal_data[0],n[1],function(n){var o,h;if(!i(n)){if(u=e=!1,s=!0,scheduler._temp_touch_block=!0,o=r=t(n),!o){e=!0;return}if(h=new Date,!e&&!u&&h-l<250)return scheduler._click.dhx_cal_data(o),window.setTimeout(function(){scheduler._on_dbl_click(o)},50),n.preventDefault&&n.preventDefault(),n.cancelBubble=!0,scheduler._block_next_stop=!0,!1;(l=h,e||u||!scheduler.config.touch_drag)||(c=setTimeout(function(){var n,t,i;u=!0;n=f.target;n&&n.className&&n.className.indexOf("dhx_body")!=-1&&(n=n.previousSibling);scheduler._on_mouse_down(f,n);scheduler._drag_mode&&scheduler._drag_mode!="create"&&(t=-1,scheduler.for_rendered(scheduler._drag_id,function(n,i){t=n.getBoundingClientRect().top;n.style.display="none";scheduler._rendered.splice(i,1)}),t>=0&&(i=scheduler.config.time_step,scheduler._move_pos_shift=i*Math.round((o.pageY-t)*60/(scheduler.config.hour_size_px*i))));scheduler.config.touch_tip&&scheduler._show_global_tip();scheduler._on_mouse_move(f)},scheduler.config.touch_drag),f=o)}});o(this._els.dhx_cal_data[0],n[2],function(n){if(!i(n))return u||a(f,r,200),u&&(scheduler._ignore_next_click=!0),h(n),scheduler._block_next_stop?(scheduler._block_next_stop=!1,n.preventDefault&&n.preventDefault(),n.cancelBubble=!0,!1):void 0});dhtmlxEvent(document.body,n[2],h)};scheduler._show_global_tip=function(){scheduler._hide_global_tip();var n=scheduler._global_tip=document.createElement("DIV");n.className="dhx_global_tip";scheduler._update_global_tip(1);document.body.appendChild(n)};scheduler._update_global_tip=function(n){var r=scheduler._global_tip,i,t;r&&(i="",scheduler._drag_id&&!n&&(t=scheduler.getEvent(scheduler._drag_id),t&&(i="<div>"+(t._timed?scheduler.templates.event_header(t.start_date,t.end_date,t):scheduler.templates.day_date(t.start_date,t.end_date,t))+"<\/div>")),r.innerHTML=scheduler._drag_mode=="create"||scheduler._drag_mode=="new-size"?(scheduler.locale.drag_to_create||"Drag to create")+i:(scheduler.locale.drag_to_move||"Drag to move")+i)};scheduler._hide_global_tip=function(){var n=scheduler._global_tip;n&&n.parentNode&&(n.parentNode.removeChild(n),scheduler._global_tip=0)};scheduler._dp_init=function(n){n._methods=["_set_event_text_style","","changeEventId","_dp_hook_delete"];this._dp_hook_delete=function(n){return this.deleteEvent(n,!0)};this.attachEvent("onEventAdded",function(t){!this._loading&&this._validId(t)&&n.setUpdated(t,!0,"inserted")});this.attachEvent("onConfirmedBeforeEventDelete",function(t){if(this._validId(t)){var i=n.getState(t);return i=="inserted"||this._new_event?(n.setUpdated(t,!1),!0):i=="deleted"?!1:i=="true_deleted"?!0:(n.setUpdated(t,!0,"deleted"),!1)}});this.attachEvent("onEventChanged",function(t){!this._loading&&this._validId(t)&&n.setUpdated(t,!0,"updated")});n._getRowData=function(n){var i=this.obj.getEvent(n),r={};for(var t in i)t.indexOf("_")!==0&&(r[t]=i[t]&&i[t].getUTCFullYear?this.obj.templates.xml_format(i[t]):i[t]);return r};n._clearUpdateFlag=function(){};n.attachEvent("insertCallback",scheduler._update_callback);n.attachEvent("updateCallback",scheduler._update_callback);n.attachEvent("deleteCallback",function(n,t){this.obj.setUserData(t,this.action_param,"true_deleted");this.obj.deleteEvent(t)})};scheduler._validId=function(){return!0};scheduler.setUserData=function(n,t,i){n?this.getEvent(n)[t]=i:this._userdata[t]=i};scheduler.getUserData=function(n,t){return n?this.getEvent(n)[t]:this._userdata[t]};scheduler._set_event_text_style=function(n,t){this.for_rendered(n,function(n){n.style.cssText+=";"+t});var i=this.getEvent(n);i._text_style=t;this.event_updated(i)};scheduler._update_callback=function(n){var t=scheduler._xmlNodeToJSON(n.firstChild);t.text=t.text||t._tagvalue;t.start_date=scheduler.templates.xml_date(t.start_date);t.end_date=scheduler.templates.xml_date(t.end_date);scheduler.addEvent(t)};scheduler._skin_settings={fix_tab_position:[1,0],use_select_menu_space:[1,0],wide_form:[1,0],hour_size_px:[44,42],displayed_event_color:["#ff4a4a","ffc5ab"],displayed_event_text_color:["#ffef80","7e2727"]};scheduler._skin_xy={lightbox_additional_height:[90,50],nav_height:[59,22],bar_height:[24,20]};scheduler._configure=function(n,t,i){for(var r in t)typeof n[r]=="undefined"&&(n[r]=t[r][i])};scheduler._skin_init=function(){var i,t,r,n,u;if(!scheduler.skin)for(i=document.getElementsByTagName("link"),t=0;t<i.length;t++)if(r=i[t].href.match("dhtmlxscheduler_([a-z]+).css"),r){scheduler.skin=r[1];break}(n=0,scheduler.skin&&(scheduler.skin==="classic"||scheduler.skin==="glossy")&&(n=1),this._configure(scheduler.config,scheduler._skin_settings,n),this._configure(scheduler.xy,scheduler._skin_xy,n),n)||(u=scheduler.config.minicalendar,u&&(u.padding=14),scheduler.templates.event_bar_date=function(n){return" <b>"+scheduler.templates.event_date(n)+"<\/b> "},scheduler.attachEvent("onTemplatesReady",function(){var o=scheduler.date.date_to_str("%d"),f,i,n,u;if(scheduler.templates._old_month_day||(scheduler.templates._old_month_day=scheduler.templates.month_day),f=scheduler.templates._old_month_day,scheduler.templates.month_day=function(n){if(this._mode=="month"){var t=o(n);return n.getDate()==1&&(t=scheduler.locale.date.month_full[n.getMonth()]+" "+t),+n==+scheduler.date.date_part(new Date)&&(t=scheduler.locale.labels.dhx_cal_today_button+" "+t),t}return f.call(this,n)},scheduler.config.fix_tab_position){var e=scheduler._els.dhx_cal_navline[0].getElementsByTagName("div"),r=null,t=200;for(i=0;i<e.length;i++)if(n=e[i],u=n.getAttribute("name"),u){n.style.right="auto";switch(u){case"day_tab":n.style.left="14px";n.className+=" dhx_cal_tab_first";break;case"week_tab":n.style.left="75px";break;case"month_tab":n.style.left="136px";n.className+=" dhx_cal_tab_last";break;default:n.style.left=t+"px";n.className+=" dhx_cal_tab_standalone";t=t+2+n.offsetWidth}}else(n.className||"").indexOf("dhx_minical_icon")===0&&n.parentNode==scheduler._els.dhx_cal_navline[0]&&(r=n);r&&(r.style.left=t+"px")}scheduler.skin&&scheduler.skin==="flat"&&(scheduler.xy.scale_height=35,scheduler.templates.hour_scale=function(n){var t=n.getMinutes();return t=t<10?"0"+t:t,"<span class='dhx_scale_h'>"+n.getHours()+"<\/span><span class='dhx_scale_m'>&nbsp;"+t+"<\/span>"})}),scheduler._skin_init=function(){})};window.jQuery&&function(n){var t=[];n.fn.dhx_scheduler=function(i){if(typeof i=="string"){if(t[i])return t[i].apply(this,[]);n.error("Method "+i+" does not exist on jQuery.dhx_scheduler")}else{var r=[];return(this.each(function(){if(this&&this.getAttribute&&!this.getAttribute("dhxscheduler")){for(var n in i)n!="data"&&(scheduler.config[n]=i[n]);this.getElementsByTagName("div").length||(this.innerHTML='<div class="dhx_cal_navline"><div class="dhx_cal_prev_button">&nbsp;<\/div><div class="dhx_cal_next_button">&nbsp;<\/div><div class="dhx_cal_today_button"><\/div><div class="dhx_cal_date"><\/div><div class="dhx_cal_tab" name="day_tab" style="right:204px;"><\/div><div class="dhx_cal_tab" name="week_tab" style="right:140px;"><\/div><div class="dhx_cal_tab" name="month_tab" style="right:76px;"><\/div><\/div><div class="dhx_cal_header"><\/div><div class="dhx_cal_data"><\/div>',this.className+=" dhx_cal_container");scheduler.init(this,scheduler.config.date,scheduler.config.mode);i.data&&scheduler.parse(i.data);r.push(scheduler)}}),r.length===1)?r[0]:r}}}(jQuery)
if (typeof (Sys) !== 'undefined') { Sys.Application.notifyScriptLoaded() };